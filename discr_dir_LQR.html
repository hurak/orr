<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Finite-horizon LQR as a QP – B(E)3M35ORR – Optimal and Robust Control</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./discr_dir_mpc.html" rel="next">
<link href="./discr_dir_general.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-50b4abff8b0f30bb501ab99a3cda6e79.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./discr_dir_goals.html">3. Discrete-time optimal control – direct approach</a></li><li class="breadcrumb-item"><a href="./discr_dir_LQR.html">Finite-horizon LQR as a QP</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">B(E)3M35ORR – Optimal and Robust Control</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">0. Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What is optimal and robust control?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_outline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course outline</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_rules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rules of the course</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software for the course</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature for the course</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_similar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Similar courses</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">1. Optimization – theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_goals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning goals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimization problems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_reformulations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem reformulations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_unconstrained.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unconstrained optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_constrained.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Constrained optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_modellers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimization modelling languages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">2. Optimization – algorithms</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_algo_goals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning goals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_algo_derivatives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computing the derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_algo_unconstrained.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unconstrained optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_algo_constrained.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Constrained optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_algo_solvers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical solvers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_algo_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_algo_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">3. Discrete-time optimal control – direct approach</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_goals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning goals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General finite-horizon nonlinear optimal control as an NLP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_LQR.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Finite-horizon LQR as a QP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model predictive control (MPC)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical solvers for MPC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">4. Discrete-time optimal control – indirect approach</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_indir_goals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning goals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_indir_general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General finite-horizon nonlinear optimal control as a TP-BVP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_indir_LQR_fin_horizon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discrete-time LQR on a finite horizon</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_indir_LQR_inf_horizon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discrete-time LQR on an infinite horizon</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_indir_DARE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discrete-time algebraic Riccati equation (DARE)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_indir_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_indir_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">5. Discrete-time optimal control – dynamic programming (DP)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_programming_goals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning goals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DP and discrete-time optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_programming_tabular.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tabular outcomes of DP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_programming_LQR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving LQR via DP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_programming_DDP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Differential dynamic programming (DDP)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_programming_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_programming_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">6. More on MPC</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc_stability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stability of MPC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc_recursive_feasibility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Recursive feasibility</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc_economic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Economic MPC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc_explicit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explicit MPC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">7. Continuous-time optimal control - indirect approach via calculus of variations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview of continuous-time optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_calculus_of_variations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calculus of variations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_via_calculus_of_variations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Indirect approach to optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_LQR_fin_horizon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Indirect approach to LQR on a finite horizon</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_LQR_inf_horizon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Indirect approach to LQR on an infinite horizon</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_CARE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continuous-time Riccati equation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_trajectory_stabilization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Trajectory stabilization and neigboring extremals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">8. Continuous-time optimal control - indirect approach via Pontryagin’s maximum principle</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_Pontryagin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pontryagin’s maximum principle</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_constrained.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Constrained optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_time_optimal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time-optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_references_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_hw_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">9. Numerical methods for continuous-time optimal control - both indirect and direct approaches</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_numerical_indirect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical methods for indirect approach</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_numerical_direct.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical methods for direct approach</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_numerical_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_numerical_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_numerical_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true">
 <span class="menu-text">9.X. Continuous-time optimal control – dynamic programming</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_dp_HJB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dynamic programming for continuous-time optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_dp_LQR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using HJB equation to solve the continuous-time LQR problem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_dp_DDP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Differential dynamic programming (DDP)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_dp_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_dp_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true">
 <span class="menu-text">10. Some extensions: LQG, LTR, H2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ext_stochastic_LQR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LQR for stochastic systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ext_LQG.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LQG control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ext_LTR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loop transfer recovery (LTR)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ext_H2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">H2-optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ext_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ext_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ext_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="true">
 <span class="menu-text">11. Uncertainty modelling and robustness analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roban_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Uncertainty (in) modelling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roban_unstructured.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Robustness analysis for unstructured uncertainty</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roban_structured.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Robustness analysis for structured uncertainty</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roban_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roban_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roban_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="true">
 <span class="menu-text">12. Robust control</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rocond_mixed_sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed sensitivity design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rocond_H_infinity_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hinfinity-optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rocond_mu_synthesis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mu synthesis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rocond_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rocond_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rocond_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="true">
 <span class="menu-text">13. Limitations of achievable performance</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./limitations_SISO.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Limitations for SISO systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./limitations_MIMO.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Limitations for MIMO systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./limitations_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./limitations_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="true">
 <span class="menu-text">14. Model and controller order reduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reduction_order_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model order reduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reduction_order_controller.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Controller order reduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reduction_order_benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Benchmarks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reduction_order_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reduction_order_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#simultaneous-sparse-formulation" id="toc-simultaneous-sparse-formulation" class="nav-link active" data-scroll-target="#simultaneous-sparse-formulation">Simultaneous (sparse) formulation</a>
  <ul class="collapse">
  <li><a href="#adding-constraints-on-controls-and-states" id="toc-adding-constraints-on-controls-and-states" class="nav-link" data-scroll-target="#adding-constraints-on-controls-and-states">Adding constraints on controls and states</a></li>
  </ul></li>
  <li><a href="#sequential-dense-formulation" id="toc-sequential-dense-formulation" class="nav-link" data-scroll-target="#sequential-dense-formulation">Sequential (dense) formulation</a>
  <ul class="collapse">
  <li><a href="#adding-the-constraints-on-controls" id="toc-adding-the-constraints-on-controls" class="nav-link" data-scroll-target="#adding-the-constraints-on-controls">Adding the constraints on controls</a></li>
  <li><a href="#adding-the-constraints-on-states" id="toc-adding-the-constraints-on-states" class="nav-link" data-scroll-target="#adding-the-constraints-on-states">Adding the constraints on states</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/hurak/orr/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./discr_dir_goals.html">3. Discrete-time optimal control – direct approach</a></li><li class="breadcrumb-item"><a href="./discr_dir_LQR.html">Finite-horizon LQR as a QP</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Finite-horizon LQR as a QP</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/1MHV-L4--lI?si=6Orm_cGxmTAX_myT" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Here we specialize the general procedure from the previous section to the case of a <strong>L</strong>inear system and a <strong>Q</strong>uadratic cost. We start by considering a simple problem of <strong>R</strong>egulation, wherein the goal is to bring the system either exactly or approximately to zero final state, that is, <span class="math inline">\mathbf x^\text{ref}=\mathbf 0</span> and we want <span class="math inline">\bm x_N=\mathbf x^\text{ref}</span> or <span class="math inline">\bm x_N\approx\mathbf x^\text{ref}</span>, respectively. The problem is known as the <strong>LQR</strong> problem. <span class="math display">
\begin{aligned}
\operatorname*{minimize}_{\bm u_0,\ldots, \bm u_{N-1}, \bm x_{0},\ldots, \bm x_N} &amp;\quad  \frac{1}{2} \bm x_N^\top \mathbf S \bm x_N + \frac{1}{2} \sum_{k=0}^{N-1} \left(\bm x_k^\top \mathbf Q \bm x_k + \bm u_k^\top \mathbf R \bm u_k \right)\\
\text{subject to}   &amp;\quad \bm x_{k+1} = \mathbf A\bm x_k + \mathbf B\bm u_k,\quad k = 0, \ldots, N-1, \\
                    &amp;\quad \bm x_0 = \mathbf x_0,\\
                    &amp;\quad \bm x_N = \mathbf 0\;  (\text{or}\, \bm x_N \approx \mathbf 0).
\end{aligned}
</span></p>
<p>Referring to the two options for the last constraint,</p>
<ul>
<li>if the condition <span class="math inline">\bm x_N=\mathbf 0</span> on the final state is strictly enforced, the terminal state cost (the term <span class="math inline">\frac{1}{2} \bm x_N^\top \mathbf S \bm x_N</span> in the cost function) is redundant and can be removed;</li>
<li>if the final state condition can be relaxed to <span class="math inline">\bm x_N\approx\mathbf 0</span>, it is by increasing the weight <span class="math inline">\mathbf S</span> in the terminal cost function <span class="math inline">\frac{1}{2} \bm x_N^\top \mathbf S \bm x_N</span> that <span class="math inline">\bm x_N</span> can be made arbitrarily close to <span class="math inline">\mathbf 0</span>.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is a standard dilemma in optimization, not only in optimal control, that if we want to satisfy some requirement, we can either strictly enforce it through constraints or we can seemingly relax it and set a cost to be paid for not satysfying it.</p>
</div>
</div>
<section id="simultaneous-sparse-formulation" class="level2">
<h2 class="anchored" data-anchor-id="simultaneous-sparse-formulation">Simultaneous (sparse) formulation</h2>
<p>Below we rewrite the latter problem, that is, <span class="math inline">\bm x_N\approx\mathbf 0</span>, in the “unrolled” form, where we stack the state and control variables into “long” vectors <span class="math inline">\bar{\bm x}</span> and <span class="math inline">\bar{\bm u}</span>. Doing the same for the former is straightforward. <span class="math display">
\begin{aligned}
\operatorname*{minimize}_{\bar{\bm u},\bar{\bm x}} &amp; \frac{1}{2}\left(\begin{bmatrix} \bm x_1^\top &amp; \bm x_2^\top &amp; \ldots &amp; \bm x_N^\top \end{bmatrix}
\underbrace{\begin{bmatrix}\mathbf Q &amp; &amp; &amp; \\ &amp; \mathbf Q &amp; &amp;\\ &amp; &amp;\ddots &amp; \\ &amp; &amp; &amp; \mathbf S \end{bmatrix}}_{\overline{\mathbf Q}}
\underbrace{\begin{bmatrix} \bm x_1 \\ \bm x_2 \\ \vdots \\ \bm x_N \end{bmatrix}}_{\bar{\bm x}}\right.\\
&amp;\qquad +\left.
\begin{bmatrix} \bm u_0^\top &amp; \bm u_1^\top &amp; \ldots &amp; \bm u_{N-1}^\top \end{bmatrix}
\underbrace{\begin{bmatrix}\mathbf R &amp; &amp; &amp; \\ &amp; \mathbf R &amp; &amp;\\ &amp; &amp;\ddots &amp; \\ &amp; &amp; &amp; \mathbf R \end{bmatrix}}_{\overline{\mathbf R}}
\underbrace{\begin{bmatrix} \bm u_0 \\ \bm u_1 \\ \vdots \\ \bm u_{N-1} \end{bmatrix}}_{\bar{\bm u}}\right)
+ \underbrace{\frac{1}{2}\mathbf x_0^\top \mathbf Q \mathbf x_0}_{\mathrm{constant}}
\end{aligned}
</span> subject to <span class="math display">
\begin{bmatrix} \bm x_1 \\ \bm x_2 \\ \bm x_3\\ \vdots \\ \bm x_N \end{bmatrix} = \underbrace{\begin{bmatrix}\mathbf 0 &amp; &amp; &amp; &amp;\\\mathbf A &amp; \mathbf 0 &amp; &amp; &amp;\\ &amp;\mathbf A &amp;\mathbf 0 &amp; &amp; \\ &amp; &amp; &amp;\ddots &amp; \\&amp; &amp; &amp;\mathbf A &amp; \mathbf 0 \end{bmatrix}}_{\overline{\mathbf A}}
\begin{bmatrix} \bm x_1 \\ \bm x_2 \\ \bm x_3\\ \vdots \\ \bm x_N \end{bmatrix} + \underbrace{\begin{bmatrix}\mathbf B &amp; &amp; &amp; &amp; \\ &amp; \mathbf B &amp; &amp; &amp; \\&amp; &amp;\mathbf B &amp; \\ &amp; &amp; &amp;\ddots \\ &amp; &amp; &amp; &amp; \mathbf B \end{bmatrix}}_{\overline{\mathbf B}}\begin{bmatrix} \bm u_0 \\ \bm u_1 \\ \bm u_2\\\vdots \\ \bm u_{N-1} \end{bmatrix} + \underbrace{\begin{bmatrix}\mathbf A\\\mathbf 0\\\mathbf 0\\\vdots\\\mathbf 0\end{bmatrix}}_{\overline{\mathbf A}_0}\mathbf x_0,    
</span></p>
<p>in which we have already substituted the particular <span class="math inline">\mathbf x_0</span> for the variable <span class="math inline">\bm x_0</span>. Consequently, the last term in the cost function can be discarded because it is constant.</p>
<p>The terms with the <span class="math inline">\bar{\bm x}</span> vector can be combined and we get <span id="eq-linear_system_linear_constraints_matrix_format"><span class="math display">
\begin{bmatrix} \mathbf 0 \\ \mathbf 0 \\ \mathbf 0\\ \vdots \\ \mathbf 0 \end{bmatrix} = \underbrace{\begin{bmatrix}-\mathbf I &amp; &amp; &amp; &amp;\\\mathbf A &amp; -\mathbf I &amp; &amp; &amp;\\ &amp;\mathbf A &amp;-\mathbf I &amp; &amp; \\ &amp; &amp; &amp;\ddots &amp; \\&amp; &amp; &amp;\mathbf A &amp; -\mathbf I \end{bmatrix}}_{\overline{\mathbf A} - \mathbf I}
\begin{bmatrix} \mathbf x_1 \\ \mathbf x_2 \\ \mathbf x_3\\ \vdots \\ \mathbf x_N \end{bmatrix} + \underbrace{\begin{bmatrix}\mathbf B &amp; &amp; &amp; &amp; \\ &amp; \mathbf B &amp; &amp; &amp; \\&amp; &amp;\mathbf B &amp; \\ &amp; &amp; &amp;\ddots \\ &amp; &amp; &amp; &amp; \mathbf B \end{bmatrix}}_{\overline{\mathbf B}}\begin{bmatrix} \mathbf u_0 \\ \mathbf u_1 \\ \mathbf u_2\\\vdots \\ \mathbf u_{N-1} \end{bmatrix} + \underbrace{\begin{bmatrix}\mathbf A\\\mathbf 0\\\mathbf 0\\\vdots\\\mathbf 0\end{bmatrix}}_{\overline{\mathbf A}_0}\mathbf x_0.
\tag{1}</span></span></p>
<p>Upon stacking the two “long” vectors into <span class="math inline">\bar{\bm z}</span> we reformulate the optimization problem as <span class="math display">
\operatorname*{minimize}_{\widetilde{\mathbf z}\in\mathbb{R}^{2N}}\quad \frac{1}{2}\underbrace{\begin{bmatrix}\bar{\bm x}^\top &amp;\bar{\bm u}^\top\end{bmatrix}}_{\bar{\bm z}^\top} \underbrace{\begin{bmatrix}\overline{\mathbf Q} &amp; \\ &amp; \overline{\mathbf R} \end{bmatrix}}_{\widetilde{\mathbf Q}}\underbrace{\begin{bmatrix}\bar{\bm x}\\\bar{\bm u}\end{bmatrix}}_{\bar{\bm z}}
</span> subject to <span class="math display">
\mathbf 0 = \underbrace{\begin{bmatrix}(\overline{\mathbf A}-\mathbf I) &amp; \overline{\mathbf B}\end{bmatrix}}_{\widetilde{\mathbf A}}\underbrace{\begin{bmatrix}\bar{\bm x}\\\bar{\bm u}\end{bmatrix}}_{\bar{\bm z}} + \underbrace{\overline{\mathbf A}_0 \mathbf x_0}_{\tilde{\mathbf b}}.
</span></p>
<p>To summarize, we have reformulated the optimal control problem as a linearly constrained quadratic program <span class="math display">
\boxed{
\begin{aligned}
\underset{\bar{\bm z}\in\mathbb{R}^{2N}}{\text{minimize}} &amp;\quad \frac{1}{2}\bar{\bm z}^\top \widetilde{\mathbf Q} \bar{\bm z}\\
\text{subject to} &amp;\quad \widetilde{\mathbf A} \bar{\bm z} + \tilde{\bm b} = \mathbf 0.
\end{aligned}}
</span></p>
<p>This constrained optimization problem can still be solved without invoking a numerical solver for solving quadratic programs (QP). We do it by introducing a vector <span class="math inline">\boldsymbol\lambda</span> of Lagrange multipliers to form the Lagrangian function <span class="math display">
\mathcal{L}(\bar{\bm z}, \boldsymbol \lambda) = \frac{1}{2}\bar{\bm z}^\top \widetilde{\mathbf Q} \bar{\bm z} + \boldsymbol\lambda^\top(\widetilde{\mathbf A} \bar{\bm z} + \tilde{\mathbf b}),
</span> for which the gradients with respect to <span class="math inline">\bar{\bm z}</span> and <span class="math inline">\boldsymbol\lambda</span> are <span class="math display">
\begin{aligned}
\nabla_{\tilde{\bm{z}}} \mathcal{L}(\bar{\bm z}, \boldsymbol\lambda) &amp;= \widetilde{\mathbf Q}\bar{\bm z} + \tilde{\mathbf A}^\top\boldsymbol\lambda,\\
\nabla_{\boldsymbol{\lambda}} \mathcal{L}(\tilde{\bm x}, \boldsymbol\lambda) &amp;=\widetilde{\mathbf A} \bar{\bm z} + \tilde{\mathbf b}.
\end{aligned}
</span></p>
<p>Requiring that the overall gradient vanishes leads to the following KKT set of linear equations <span class="math display">
\begin{bmatrix}
  \widetilde{\mathbf Q} &amp; \widetilde{\mathbf A}^\top\\ \widetilde{\mathbf A} &amp; \mathbf 0
\end{bmatrix}
\begin{bmatrix}
\bar{\bm z}\\\boldsymbol\lambda
\end{bmatrix}
=
\begin{bmatrix}
\mathbf 0\\ -\tilde{\mathbf b}
\end{bmatrix}.
</span></p>
<p>Solving this could be accomplished by using some general solver for linear systems or by using some more tailored solver for symmetric indefinite systems (based on <a href="https://en.wikipedia.org/wiki/Cholesky_decomposition#LDL_decomposition">LDL factorization</a>).</p>
<div id="exm-direct-simultaneous" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 (Reformulating the unconstrained LQR problem as a system of linear equations – simultaneous approach)</strong></span> &nbsp;</p>
<div id="2" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">BlockArrays</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearSolve</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">QDLDL</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">SparseArrays</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">direct_dlqr_simultaneous</span>(A,B,x₀,Q,R,S,N)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">size</span>(A)[<span class="fl">1</span>]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="fu">size</span>(B)[<span class="fl">2</span>]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    Q̄ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,N<span class="op">*</span>n),<span class="fu">repeat</span>([n],N),<span class="fu">repeat</span>([n],N))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        Q̄[<span class="fu">Block</span>(i,i)] <span class="op">=</span> Q</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    Q̄[<span class="fu">Block</span>(N,N)] <span class="op">=</span> S</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    R̄ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>m,N<span class="op">*</span>m),<span class="fu">repeat</span>([m],N),<span class="fu">repeat</span>([m],N))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        R̄[<span class="fu">Block</span>(i,i)] <span class="op">=</span> R</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    Q̃ <span class="op">=</span> <span class="fu">blockdiag</span>(<span class="fu">sparse</span>(Q̄),<span class="fu">sparse</span>(R̄))              <span class="co"># The matrix defining the quadratic cost.</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    B̄ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,N<span class="op">*</span>m),<span class="fu">repeat</span>([n],N),<span class="fu">repeat</span>([m],N))</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        B̄[<span class="fu">Block</span>(i,i)] <span class="op">=</span> B</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    Ā <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">sparse</span>(<span class="op">-</span><span class="fl">1.0</span><span class="op">*</span>I,n<span class="op">*</span>N,n<span class="op">*</span>N),<span class="fu">repeat</span>([n],N),<span class="fu">repeat</span>([n],N))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">2</span><span class="op">:</span>N</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        Ā[<span class="fu">Block</span>(i,(i<span class="op">-</span><span class="fl">1</span>))] <span class="op">=</span> A</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    Ã <span class="op">=</span> <span class="fu">sparse</span>([Ā B̄])                               <span class="co"># The matrix defining the linear (affine) equation.</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    Ā₀ <span class="op">=</span> <span class="fu">spzeros</span>(n<span class="op">*</span>N,n)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    Ā₀[<span class="fl">1</span><span class="op">:</span>n,<span class="fl">1</span><span class="op">:</span>n] <span class="op">=</span> A</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    b̃ <span class="op">=</span> <span class="fu">Ā₀*sparse</span>(x₀)                               <span class="co"># The constant offset for the linear (affine) equation.</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    K <span class="op">=</span> [Q̃ Ã<span class="ch">'; Ã spzeros(size(Ã,1),size(Ã,1))]      # Sparse KKT matrix.</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> [<span class="fu">spzeros</span>(<span class="fu">size</span>(Q̃,<span class="fl">1</span>)); <span class="op">-</span>b̃]                    <span class="co"># Right hand side of the KKT system</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    prob <span class="op">=</span> <span class="fu">LinearProblem</span>(K,k)                       <span class="co"># The KKT system as a linear problem.</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    z̃λ <span class="op">=</span> LinearSolve.<span class="fu">solve</span>(prob)                    <span class="co"># Solving the KKT system. Ready for trying various solvers.</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    xopt <span class="op">=</span> <span class="fu">reshape</span>(z̃λ[<span class="fl">1</span><span class="op">:</span>(n<span class="op">*</span>N)],(n,<span class="op">:</span>))</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    uopt <span class="op">=</span> <span class="fu">reshape</span>(z̃λ[(n<span class="op">*</span>N<span class="op">+</span><span class="fl">1</span>)<span class="op">:</span>(n<span class="op">+</span>m)<span class="op">*</span>N],(m,<span class="op">:</span>))</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    return xopt,uopt</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="fl">2</span>               <span class="co"># Number of state variables.</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1</span>               <span class="co"># Number of (control) input variables. </span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> <span class="fu">rand</span>(n,n)       <span class="co"># State matrix.</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> <span class="fu">rand</span>(n,m)       <span class="co"># Input coupling matrix.</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>x₀ <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">3.0</span>]     <span class="co"># Initial state.</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">10</span>              <span class="co"># Time horizon.</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">2.0</span>]      </span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">2.0</span>]</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> [<span class="fl">1.0</span>]</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>s)     <span class="co"># Matrix defining the terminal state cost.</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>q)     <span class="co"># Matrix defining the running state dost.</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>r)     <span class="co"># Matrix defining the cost of control.</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>xopt,uopt <span class="op">=</span> <span class="fu">direct_dlqr_simultaneous</span>(A,B,x₀,Q,R,S,N)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> <span class="fu">plot</span>(<span class="fl">0</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>),uopt<span class="op">'</span>,marker<span class="op">=:</span>diamond,label<span class="op">=</span><span class="st">"u"</span>,linetype<span class="op">=:</span>steppost)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel!</span>(<span class="st">"k"</span>)</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel!</span>(<span class="st">"u"</span>)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> <span class="fu">plot</span>(<span class="fl">0</span><span class="op">:</span>N,<span class="fu">hcat</span>(x₀,xopt)<span class="ch">',marker=:diamond,label=["x₁" "x₂"],linetype=:steppost)</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel!</span>(<span class="st">"k"</span>)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel!</span>(<span class="st">"x"</span>)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p1,p2,layout<span class="op">=</span>(<span class="fl">2</span>,<span class="fl">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip690">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip690)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip691">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip690)" d="M218.733 774.117 L2640.76 774.117 L2640.76 47.2441 L218.733 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip692">
    <rect x="218" y="47" width="2423" height="728"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="287.281,774.117 287.281,47.2441 "></polyline>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="795.043,774.117 795.043,47.2441 "></polyline>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1302.8,774.117 1302.8,47.2441 "></polyline>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1810.57,774.117 1810.57,47.2441 "></polyline>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2318.33,774.117 2318.33,47.2441 "></polyline>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.733,642.881 2640.76,642.881 "></polyline>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.733,449.894 2640.76,449.894 "></polyline>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.733,256.908 2640.76,256.908 "></polyline>
<polyline clip-path="url(#clip692)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.733,63.9216 2640.76,63.9216 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.733,774.117 2640.76,774.117 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="287.281,774.117 287.281,755.219 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="795.043,774.117 795.043,755.219 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1302.8,774.117 1302.8,755.219 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1810.57,774.117 1810.57,755.219 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2318.33,774.117 2318.33,755.219 "></polyline>
<path clip-path="url(#clip690)" d="M287.281 807.34 Q283.67 807.34 281.841 810.904 Q280.036 814.446 280.036 821.576 Q280.036 828.682 281.841 832.247 Q283.67 835.789 287.281 835.789 Q290.915 835.789 292.721 832.247 Q294.549 828.682 294.549 821.576 Q294.549 814.446 292.721 810.904 Q290.915 807.34 287.281 807.34 M287.281 803.636 Q293.091 803.636 296.147 808.242 Q299.225 812.826 299.225 821.576 Q299.225 830.303 296.147 834.909 Q293.091 839.492 287.281 839.492 Q281.471 839.492 278.392 834.909 Q275.337 830.303 275.337 821.576 Q275.337 812.826 278.392 808.242 Q281.471 803.636 287.281 803.636 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M789.695 834.886 L806.015 834.886 L806.015 838.821 L784.07 838.821 L784.07 834.886 Q786.732 832.131 791.316 827.502 Q795.922 822.849 797.103 821.506 Q799.348 818.983 800.228 817.247 Q801.131 815.488 801.131 813.798 Q801.131 811.043 799.186 809.307 Q797.265 807.571 794.163 807.571 Q791.964 807.571 789.51 808.335 Q787.08 809.099 784.302 810.65 L784.302 805.928 Q787.126 804.793 789.58 804.215 Q792.033 803.636 794.07 803.636 Q799.441 803.636 802.635 806.321 Q805.83 809.006 805.83 813.497 Q805.83 815.627 805.019 817.548 Q804.232 819.446 802.126 822.039 Q801.547 822.71 798.445 825.928 Q795.343 829.122 789.695 834.886 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M1305.81 808.335 L1294.01 826.784 L1305.81 826.784 L1305.81 808.335 M1304.59 804.261 L1310.47 804.261 L1310.47 826.784 L1315.4 826.784 L1315.4 830.673 L1310.47 830.673 L1310.47 838.821 L1305.81 838.821 L1305.81 830.673 L1290.21 830.673 L1290.21 826.159 L1304.59 804.261 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M1810.97 819.678 Q1807.82 819.678 1805.97 821.83 Q1804.14 823.983 1804.14 827.733 Q1804.14 831.46 1805.97 833.636 Q1807.82 835.789 1810.97 835.789 Q1814.12 835.789 1815.95 833.636 Q1817.8 831.46 1817.8 827.733 Q1817.8 823.983 1815.95 821.83 Q1814.12 819.678 1810.97 819.678 M1820.25 805.025 L1820.25 809.284 Q1818.49 808.451 1816.69 808.011 Q1814.91 807.571 1813.15 807.571 Q1808.52 807.571 1806.06 810.696 Q1803.63 813.821 1803.29 820.141 Q1804.65 818.127 1806.71 817.062 Q1808.77 815.974 1811.25 815.974 Q1816.46 815.974 1819.47 819.145 Q1822.5 822.293 1822.5 827.733 Q1822.5 833.057 1819.35 836.275 Q1816.2 839.492 1810.97 839.492 Q1804.98 839.492 1801.8 834.909 Q1798.63 830.303 1798.63 821.576 Q1798.63 813.381 1802.52 808.52 Q1806.41 803.636 1812.96 803.636 Q1814.72 803.636 1816.5 803.983 Q1818.31 804.33 1820.25 805.025 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M2318.33 822.409 Q2314.99 822.409 2313.07 824.191 Q2311.17 825.974 2311.17 829.099 Q2311.17 832.224 2313.07 834.006 Q2314.99 835.789 2318.33 835.789 Q2321.66 835.789 2323.58 834.006 Q2325.5 832.201 2325.5 829.099 Q2325.5 825.974 2323.58 824.191 Q2321.68 822.409 2318.33 822.409 M2313.65 820.418 Q2310.64 819.678 2308.95 817.617 Q2307.29 815.557 2307.29 812.594 Q2307.29 808.451 2310.23 806.043 Q2313.19 803.636 2318.33 803.636 Q2323.49 803.636 2326.43 806.043 Q2329.37 808.451 2329.37 812.594 Q2329.37 815.557 2327.68 817.617 Q2326.01 819.678 2323.03 820.418 Q2326.41 821.205 2328.28 823.497 Q2330.18 825.789 2330.18 829.099 Q2330.18 834.122 2327.1 836.807 Q2324.04 839.492 2318.33 839.492 Q2312.61 839.492 2309.53 836.807 Q2306.48 834.122 2306.48 829.099 Q2306.48 825.789 2308.37 823.497 Q2310.27 821.205 2313.65 820.418 M2311.94 813.034 Q2311.94 815.719 2313.61 817.224 Q2315.29 818.729 2318.33 818.729 Q2321.34 818.729 2323.03 817.224 Q2324.74 815.719 2324.74 813.034 Q2324.74 810.349 2323.03 808.844 Q2321.34 807.34 2318.33 807.34 Q2315.29 807.34 2313.61 808.844 Q2311.94 810.349 2311.94 813.034 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M1413.93 873.776 L1419.81 873.776 L1419.81 903.026 L1437.29 887.653 L1444.77 887.653 L1425.86 904.331 L1445.56 923.301 L1437.92 923.301 L1419.81 905.891 L1419.81 923.301 L1413.93 923.301 L1413.93 873.776 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.733,774.117 218.733,47.2441 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.733,642.881 237.631,642.881 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.733,449.894 237.631,449.894 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.733,256.908 237.631,256.908 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.733,63.9216 237.631,63.9216 "></polyline>
<path clip-path="url(#clip690)" d="M116.539 643.332 L146.214 643.332 L146.214 647.267 L116.539 647.267 L116.539 643.332 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M166.885 641.017 Q163.737 641.017 161.885 643.17 Q160.057 645.323 160.057 649.073 Q160.057 652.8 161.885 654.975 Q163.737 657.128 166.885 657.128 Q170.034 657.128 171.862 654.975 Q173.714 652.8 173.714 649.073 Q173.714 645.323 171.862 643.17 Q170.034 641.017 166.885 641.017 M176.168 626.364 L176.168 630.624 Q174.409 629.79 172.603 629.351 Q170.821 628.911 169.061 628.911 Q164.432 628.911 161.978 632.036 Q159.548 635.161 159.2 641.48 Q160.566 639.466 162.626 638.401 Q164.686 637.313 167.163 637.313 Q172.372 637.313 175.381 640.485 Q178.413 643.633 178.413 649.073 Q178.413 654.397 175.265 657.614 Q172.117 660.832 166.885 660.832 Q160.89 660.832 157.719 656.249 Q154.548 651.642 154.548 642.915 Q154.548 634.721 158.436 629.86 Q162.325 624.976 168.876 624.976 Q170.635 624.976 172.418 625.323 Q174.223 625.67 176.168 626.364 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M116.214 450.346 L145.89 450.346 L145.89 454.281 L116.214 454.281 L116.214 450.346 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M168.83 436.688 L157.024 455.137 L168.83 455.137 L168.83 436.688 M167.603 432.614 L173.483 432.614 L173.483 455.137 L178.413 455.137 L178.413 459.026 L173.483 459.026 L173.483 467.174 L168.83 467.174 L168.83 459.026 L153.228 459.026 L153.228 454.512 L167.603 432.614 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M118.298 257.359 L147.974 257.359 L147.974 261.294 L118.298 261.294 L118.298 257.359 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M162.094 270.253 L178.413 270.253 L178.413 274.188 L156.469 274.188 L156.469 270.253 Q159.131 267.498 163.714 262.869 Q168.321 258.216 169.501 256.873 Q171.747 254.35 172.626 252.614 Q173.529 250.855 173.529 249.165 Q173.529 246.41 171.585 244.674 Q169.663 242.938 166.561 242.938 Q164.362 242.938 161.909 243.702 Q159.478 244.466 156.7 246.017 L156.7 241.295 Q159.524 240.16 161.978 239.582 Q164.432 239.003 166.469 239.003 Q171.839 239.003 175.034 241.688 Q178.228 244.373 178.228 248.864 Q178.228 250.994 177.418 252.915 Q176.631 254.813 174.524 257.406 Q173.946 258.077 170.844 261.294 Q167.742 264.489 162.094 270.253 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M166.469 49.7203 Q162.858 49.7203 161.029 53.2851 Q159.223 56.8267 159.223 63.9563 Q159.223 71.0627 161.029 74.6275 Q162.858 78.1692 166.469 78.1692 Q170.103 78.1692 171.909 74.6275 Q173.737 71.0627 173.737 63.9563 Q173.737 56.8267 171.909 53.2851 Q170.103 49.7203 166.469 49.7203 M166.469 46.0166 Q172.279 46.0166 175.334 50.623 Q178.413 55.2063 178.413 63.9563 Q178.413 72.6831 175.334 77.2896 Q172.279 81.8729 166.469 81.8729 Q160.659 81.8729 157.58 77.2896 Q154.524 72.6831 154.524 63.9563 Q154.524 55.2063 157.58 50.623 Q160.659 46.0166 166.469 46.0166 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M47.5702 425.608 L25.9905 425.608 L25.9905 419.752 L47.3474 419.752 Q52.4082 419.752 54.9545 417.778 Q57.4689 415.805 57.4689 411.858 Q57.4689 407.116 54.4452 404.378 Q51.4215 401.609 46.2016 401.609 L25.9905 401.609 L25.9905 395.753 L61.6384 395.753 L61.6384 401.609 L56.1639 401.609 Q59.4104 403.742 61.0019 406.575 Q62.5615 409.376 62.5615 413.1 Q62.5615 419.242 58.742 422.425 Q54.9226 425.608 47.5702 425.608 M25.1311 410.872 L25.1311 410.872 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip692)" d="M287.281 737.545 L271.281 753.545 L287.281 769.545 L303.281 753.545 L287.281 737.545 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip692)" d="M541.162 443.857 L525.162 459.857 L541.162 475.857 L557.162 459.857 L541.162 443.857 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip692)" d="M795.043 302.902 L779.043 318.902 L795.043 334.902 L811.043 318.902 L795.043 302.902 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip692)" d="M1048.92 195.312 L1032.92 211.312 L1048.92 227.312 L1064.92 211.312 L1048.92 195.312 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip692)" d="M1302.8 142.052 L1286.8 158.052 L1302.8 174.052 L1318.8 158.052 L1302.8 142.052 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip692)" d="M1556.68 102.389 L1540.68 118.389 L1556.68 134.389 L1572.68 118.389 L1556.68 102.389 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip692)" d="M1810.57 82.1793 L1794.57 98.1793 L1810.57 114.179 L1826.57 98.1793 L1810.57 82.1793 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip692)" d="M2064.45 67.0234 L2048.45 83.0234 L2064.45 99.0234 L2080.45 83.0234 L2064.45 67.0234 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip692)" d="M2318.33 59.0492 L2302.33 75.0492 L2318.33 91.0492 L2334.33 75.0492 L2318.33 59.0492 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip692)" d="M2572.21 51.816 L2556.21 67.816 L2572.21 83.816 L2588.21 67.816 L2572.21 51.816 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip692)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="287.281,753.545 541.162,753.545 541.162,459.857 795.043,459.857 795.043,318.902 1048.92,318.902 1048.92,211.312 1302.8,211.312 1302.8,158.052 1556.68,158.052 1556.68,118.389 1810.57,118.389 1810.57,98.1793 2064.45,98.1793 2064.45,83.0234 2318.33,83.0234 2318.33,75.0492 2572.21,75.0492 2572.21,67.816 "></polyline>
<path clip-path="url(#clip690)" d="M299.467 175.153 L563.382 175.153 L563.382 71.4732 L299.467 71.4732  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="299.467,175.153 563.382,175.153 563.382,71.4732 299.467,71.4732 299.467,175.153 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="326.379,123.313 487.847,123.313 "></polyline>
<path clip-path="url(#clip690)" d="M514.758 130.362 L514.758 114.667 L519.017 114.667 L519.017 130.2 Q519.017 133.88 520.453 135.732 Q521.888 137.561 524.758 137.561 Q528.207 137.561 530.198 135.362 Q532.212 133.163 532.212 129.366 L532.212 114.667 L536.471 114.667 L536.471 140.593 L532.212 140.593 L532.212 136.612 Q530.661 138.973 528.601 140.13 Q526.564 141.264 523.855 141.264 Q519.388 141.264 517.073 138.487 Q514.758 135.709 514.758 130.362 M525.476 114.042 L525.476 114.042 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M218.733 1734.12 L2640.76 1734.12 L2640.76 1007.24 L218.733 1007.24  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip693">
    <rect x="218" y="1007" width="2423" height="728"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip693)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="287.281,1734.12 287.281,1007.24 "></polyline>
<polyline clip-path="url(#clip693)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="858.513,1734.12 858.513,1007.24 "></polyline>
<polyline clip-path="url(#clip693)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1429.74,1734.12 1429.74,1007.24 "></polyline>
<polyline clip-path="url(#clip693)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2000.98,1734.12 2000.98,1007.24 "></polyline>
<polyline clip-path="url(#clip693)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2572.21,1734.12 2572.21,1007.24 "></polyline>
<polyline clip-path="url(#clip693)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.733,1726.52 2640.76,1726.52 "></polyline>
<polyline clip-path="url(#clip693)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.733,1493.62 2640.76,1493.62 "></polyline>
<polyline clip-path="url(#clip693)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.733,1260.72 2640.76,1260.72 "></polyline>
<polyline clip-path="url(#clip693)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="218.733,1027.82 2640.76,1027.82 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.733,1734.12 2640.76,1734.12 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="287.281,1734.12 287.281,1715.22 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="858.513,1734.12 858.513,1715.22 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1429.74,1734.12 1429.74,1715.22 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2000.98,1734.12 2000.98,1715.22 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2572.21,1734.12 2572.21,1715.22 "></polyline>
<path clip-path="url(#clip690)" d="M264.665 1767.34 Q261.054 1767.34 259.226 1770.9 Q257.42 1774.45 257.42 1781.58 Q257.42 1788.68 259.226 1792.25 Q261.054 1795.79 264.665 1795.79 Q268.3 1795.79 270.105 1792.25 Q271.934 1788.68 271.934 1781.58 Q271.934 1774.45 270.105 1770.9 Q268.3 1767.34 264.665 1767.34 M264.665 1763.64 Q270.476 1763.64 273.531 1768.24 Q276.61 1772.83 276.61 1781.58 Q276.61 1790.3 273.531 1794.91 Q270.476 1799.49 264.665 1799.49 Q258.855 1799.49 255.777 1794.91 Q252.721 1790.3 252.721 1781.58 Q252.721 1772.83 255.777 1768.24 Q258.855 1763.64 264.665 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M284.827 1792.94 L289.712 1792.94 L289.712 1798.82 L284.827 1798.82 L284.827 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M309.897 1767.34 Q306.286 1767.34 304.457 1770.9 Q302.651 1774.45 302.651 1781.58 Q302.651 1788.68 304.457 1792.25 Q306.286 1795.79 309.897 1795.79 Q313.531 1795.79 315.336 1792.25 Q317.165 1788.68 317.165 1781.58 Q317.165 1774.45 315.336 1770.9 Q313.531 1767.34 309.897 1767.34 M309.897 1763.64 Q315.707 1763.64 318.762 1768.24 Q321.841 1772.83 321.841 1781.58 Q321.841 1790.3 318.762 1794.91 Q315.707 1799.49 309.897 1799.49 Q304.086 1799.49 301.008 1794.91 Q297.952 1790.3 297.952 1781.58 Q297.952 1772.83 301.008 1768.24 Q304.086 1763.64 309.897 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M830.249 1794.89 L846.568 1794.89 L846.568 1798.82 L824.624 1798.82 L824.624 1794.89 Q827.286 1792.13 831.869 1787.5 Q836.476 1782.85 837.656 1781.51 Q839.902 1778.98 840.781 1777.25 Q841.684 1775.49 841.684 1773.8 Q841.684 1771.04 839.74 1769.31 Q837.818 1767.57 834.717 1767.57 Q832.518 1767.57 830.064 1768.34 Q827.633 1769.1 824.856 1770.65 L824.856 1765.93 Q827.68 1764.79 830.133 1764.21 Q832.587 1763.64 834.624 1763.64 Q839.994 1763.64 843.189 1766.32 Q846.383 1769.01 846.383 1773.5 Q846.383 1775.63 845.573 1777.55 Q844.786 1779.45 842.68 1782.04 Q842.101 1782.71 838.999 1785.93 Q835.897 1789.12 830.249 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M856.383 1792.94 L861.267 1792.94 L861.267 1798.82 L856.383 1798.82 L856.383 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M871.499 1764.26 L889.855 1764.26 L889.855 1768.2 L875.781 1768.2 L875.781 1776.67 Q876.8 1776.32 877.818 1776.16 Q878.837 1775.97 879.855 1775.97 Q885.642 1775.97 889.022 1779.15 Q892.401 1782.32 892.401 1787.73 Q892.401 1793.31 888.929 1796.41 Q885.457 1799.49 879.138 1799.49 Q876.962 1799.49 874.693 1799.12 Q872.448 1798.75 870.04 1798.01 L870.04 1793.31 Q872.124 1794.45 874.346 1795 Q876.568 1795.56 879.045 1795.56 Q883.05 1795.56 885.388 1793.45 Q887.726 1791.34 887.726 1787.73 Q887.726 1784.12 885.388 1782.02 Q883.05 1779.91 879.045 1779.91 Q877.17 1779.91 875.295 1780.33 Q873.443 1780.74 871.499 1781.62 L871.499 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M1396.91 1764.26 L1415.27 1764.26 L1415.27 1768.2 L1401.19 1768.2 L1401.19 1776.67 Q1402.21 1776.32 1403.23 1776.16 Q1404.25 1775.97 1405.27 1775.97 Q1411.05 1775.97 1414.43 1779.15 Q1417.81 1782.32 1417.81 1787.73 Q1417.81 1793.31 1414.34 1796.41 Q1410.87 1799.49 1404.55 1799.49 Q1402.37 1799.49 1400.1 1799.12 Q1397.86 1798.75 1395.45 1798.01 L1395.45 1793.31 Q1397.53 1794.45 1399.76 1795 Q1401.98 1795.56 1404.46 1795.56 Q1408.46 1795.56 1410.8 1793.45 Q1413.14 1791.34 1413.14 1787.73 Q1413.14 1784.12 1410.8 1782.02 Q1408.46 1779.91 1404.46 1779.91 Q1402.58 1779.91 1400.71 1780.33 Q1398.85 1780.74 1396.91 1781.62 L1396.91 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M1427.02 1792.94 L1431.91 1792.94 L1431.91 1798.82 L1427.02 1798.82 L1427.02 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M1452.09 1767.34 Q1448.48 1767.34 1446.65 1770.9 Q1444.85 1774.45 1444.85 1781.58 Q1444.85 1788.68 1446.65 1792.25 Q1448.48 1795.79 1452.09 1795.79 Q1455.73 1795.79 1457.53 1792.25 Q1459.36 1788.68 1459.36 1781.58 Q1459.36 1774.45 1457.53 1770.9 Q1455.73 1767.34 1452.09 1767.34 M1452.09 1763.64 Q1457.9 1763.64 1460.96 1768.24 Q1464.04 1772.83 1464.04 1781.58 Q1464.04 1790.3 1460.96 1794.91 Q1457.9 1799.49 1452.09 1799.49 Q1446.28 1799.49 1443.21 1794.91 Q1440.15 1790.3 1440.15 1781.58 Q1440.15 1772.83 1443.21 1768.24 Q1446.28 1763.64 1452.09 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M1967.3 1764.26 L1989.52 1764.26 L1989.52 1766.25 L1976.97 1798.82 L1972.09 1798.82 L1983.89 1768.2 L1967.3 1768.2 L1967.3 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M1998.64 1792.94 L2003.52 1792.94 L2003.52 1798.82 L1998.64 1798.82 L1998.64 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M2013.75 1764.26 L2032.11 1764.26 L2032.11 1768.2 L2018.04 1768.2 L2018.04 1776.67 Q2019.05 1776.32 2020.07 1776.16 Q2021.09 1775.97 2022.11 1775.97 Q2027.9 1775.97 2031.28 1779.15 Q2034.66 1782.32 2034.66 1787.73 Q2034.66 1793.31 2031.18 1796.41 Q2027.71 1799.49 2021.39 1799.49 Q2019.22 1799.49 2016.95 1799.12 Q2014.7 1798.75 2012.3 1798.01 L2012.3 1793.31 Q2014.38 1794.45 2016.6 1795 Q2018.82 1795.56 2021.3 1795.56 Q2025.3 1795.56 2027.64 1793.45 Q2029.98 1791.34 2029.98 1787.73 Q2029.98 1784.12 2027.64 1782.02 Q2025.3 1779.91 2021.3 1779.91 Q2019.43 1779.91 2017.55 1780.33 Q2015.7 1780.74 2013.75 1781.62 L2013.75 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M2524.28 1794.89 L2531.92 1794.89 L2531.92 1768.52 L2523.61 1770.19 L2523.61 1765.93 L2531.87 1764.26 L2536.55 1764.26 L2536.55 1794.89 L2544.19 1794.89 L2544.19 1798.82 L2524.28 1798.82 L2524.28 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M2563.63 1767.34 Q2560.02 1767.34 2558.19 1770.9 Q2556.39 1774.45 2556.39 1781.58 Q2556.39 1788.68 2558.19 1792.25 Q2560.02 1795.79 2563.63 1795.79 Q2567.27 1795.79 2569.07 1792.25 Q2570.9 1788.68 2570.9 1781.58 Q2570.9 1774.45 2569.07 1770.9 Q2567.27 1767.34 2563.63 1767.34 M2563.63 1763.64 Q2569.44 1763.64 2572.5 1768.24 Q2575.58 1772.83 2575.58 1781.58 Q2575.58 1790.3 2572.5 1794.91 Q2569.44 1799.49 2563.63 1799.49 Q2557.82 1799.49 2554.74 1794.91 Q2551.69 1790.3 2551.69 1781.58 Q2551.69 1772.83 2554.74 1768.24 Q2557.82 1763.64 2563.63 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M2583.79 1792.94 L2588.68 1792.94 L2588.68 1798.82 L2583.79 1798.82 L2583.79 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M2608.86 1767.34 Q2605.25 1767.34 2603.42 1770.9 Q2601.62 1774.45 2601.62 1781.58 Q2601.62 1788.68 2603.42 1792.25 Q2605.25 1795.79 2608.86 1795.79 Q2612.5 1795.79 2614.3 1792.25 Q2616.13 1788.68 2616.13 1781.58 Q2616.13 1774.45 2614.3 1770.9 Q2612.5 1767.34 2608.86 1767.34 M2608.86 1763.64 Q2614.67 1763.64 2617.73 1768.24 Q2620.81 1772.83 2620.81 1781.58 Q2620.81 1790.3 2617.73 1794.91 Q2614.67 1799.49 2608.86 1799.49 Q2603.05 1799.49 2599.97 1794.91 Q2596.92 1790.3 2596.92 1781.58 Q2596.92 1772.83 2599.97 1768.24 Q2603.05 1763.64 2608.86 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M1413.93 1833.78 L1419.81 1833.78 L1419.81 1863.03 L1437.29 1847.65 L1444.77 1847.65 L1425.86 1864.33 L1445.56 1883.3 L1437.92 1883.3 L1419.81 1865.89 L1419.81 1883.3 L1413.93 1883.3 L1413.93 1833.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.733,1734.12 218.733,1007.24 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.733,1726.52 237.631,1726.52 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.733,1493.62 237.631,1493.62 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.733,1260.72 237.631,1260.72 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="218.733,1027.82 237.631,1027.82 "></polyline>
<path clip-path="url(#clip690)" d="M166.469 1712.32 Q162.858 1712.32 161.029 1715.89 Q159.223 1719.43 159.223 1726.56 Q159.223 1733.66 161.029 1737.23 Q162.858 1740.77 166.469 1740.77 Q170.103 1740.77 171.909 1737.23 Q173.737 1733.66 173.737 1726.56 Q173.737 1719.43 171.909 1715.89 Q170.103 1712.32 166.469 1712.32 M166.469 1708.62 Q172.279 1708.62 175.334 1713.22 Q178.413 1717.81 178.413 1726.56 Q178.413 1735.28 175.334 1739.89 Q172.279 1744.47 166.469 1744.47 Q160.659 1744.47 157.58 1739.89 Q154.524 1735.28 154.524 1726.56 Q154.524 1717.81 157.58 1713.22 Q160.659 1708.62 166.469 1708.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M158.506 1506.97 L166.145 1506.97 L166.145 1480.6 L157.835 1482.27 L157.835 1478.01 L166.098 1476.34 L170.774 1476.34 L170.774 1506.97 L178.413 1506.97 L178.413 1510.9 L158.506 1510.9 L158.506 1506.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M162.094 1274.06 L178.413 1274.06 L178.413 1278 L156.469 1278 L156.469 1274.06 Q159.131 1271.31 163.714 1266.68 Q168.321 1262.03 169.501 1260.68 Q171.747 1258.16 172.626 1256.42 Q173.529 1254.66 173.529 1252.98 Q173.529 1250.22 171.585 1248.48 Q169.663 1246.75 166.561 1246.75 Q164.362 1246.75 161.909 1247.51 Q159.478 1248.28 156.7 1249.83 L156.7 1245.1 Q159.524 1243.97 161.978 1243.39 Q164.432 1242.81 166.469 1242.81 Q171.839 1242.81 175.034 1245.5 Q178.228 1248.18 178.228 1252.67 Q178.228 1254.8 177.418 1256.73 Q176.631 1258.62 174.524 1261.22 Q173.946 1261.89 170.844 1265.1 Q167.742 1268.3 162.094 1274.06 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M171.284 1026.46 Q174.64 1027.18 176.515 1029.45 Q178.413 1031.72 178.413 1035.05 Q178.413 1040.17 174.895 1042.97 Q171.376 1045.77 164.895 1045.77 Q162.719 1045.77 160.404 1045.33 Q158.112 1044.91 155.659 1044.05 L155.659 1039.54 Q157.603 1040.67 159.918 1041.25 Q162.233 1041.83 164.756 1041.83 Q169.154 1041.83 171.446 1040.1 Q173.76 1038.36 173.76 1035.05 Q173.76 1031.99 171.608 1030.28 Q169.478 1028.55 165.659 1028.55 L161.631 1028.55 L161.631 1024.7 L165.844 1024.7 Q169.293 1024.7 171.122 1023.34 Q172.95 1021.95 172.95 1019.36 Q172.95 1016.69 171.052 1015.28 Q169.177 1013.85 165.659 1013.85 Q163.737 1013.85 161.538 1014.26 Q159.339 1014.68 156.7 1015.56 L156.7 1011.39 Q159.362 1010.65 161.677 1010.28 Q164.015 1009.91 166.075 1009.91 Q171.399 1009.91 174.501 1012.34 Q177.603 1014.75 177.603 1018.87 Q177.603 1021.74 175.959 1023.73 Q174.316 1025.7 171.284 1026.46 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M64.3005 1354.07 L81.647 1366.96 L99.9484 1353.4 L99.9484 1360.3 L85.9439 1370.68 L99.9484 1381.06 L99.9484 1387.96 L81.2969 1374.12 L64.3005 1386.79 L64.3005 1379.88 L77.0001 1370.43 L64.3005 1360.97 L64.3005 1354.07 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip693)" d="M287.281 1477.62 L271.281 1493.62 L287.281 1509.62 L303.281 1493.62 L287.281 1477.62 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M515.774 1438.03 L499.774 1454.03 L515.774 1470.03 L531.774 1454.03 L515.774 1438.03 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M744.266 1618.46 L728.266 1634.46 L744.266 1650.46 L760.266 1634.46 L744.266 1618.46 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M972.759 1611.73 L956.759 1627.73 L972.759 1643.73 L988.759 1627.73 L972.759 1611.73 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M1201.25 1673.66 L1185.25 1689.66 L1201.25 1705.66 L1217.25 1689.66 L1201.25 1673.66 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M1429.74 1673.21 L1413.74 1689.21 L1429.74 1705.21 L1445.74 1689.21 L1429.74 1673.21 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M1658.24 1693.6 L1642.24 1709.6 L1658.24 1725.6 L1674.24 1709.6 L1658.24 1693.6 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M1886.73 1692.67 L1870.73 1708.67 L1886.73 1724.67 L1902.73 1708.67 L1886.73 1692.67 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M2115.22 1696.83 L2099.22 1712.83 L2115.22 1728.83 L2131.22 1712.83 L2115.22 1696.83 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M2343.72 1692.39 L2327.72 1708.39 L2343.72 1724.39 L2359.72 1708.39 L2343.72 1692.39 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M2572.21 1685.86 L2556.21 1701.86 L2572.21 1717.86 L2588.21 1701.86 L2572.21 1685.86 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip693)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="287.281,1493.62 515.774,1493.62 515.774,1454.03 744.266,1454.03 744.266,1634.46 972.759,1634.46 972.759,1627.73 1201.25,1627.73 1201.25,1689.66 1429.74,1689.66 1429.74,1689.21 1658.24,1689.21 1658.24,1709.6 1886.73,1709.6 1886.73,1708.67 2115.22,1708.67 2115.22,1712.83 2343.72,1712.83 2343.72,1708.39 2572.21,1708.39 2572.21,1701.86 "></polyline>
<path clip-path="url(#clip693)" d="M287.281 1011.82 L271.281 1027.82 L287.281 1043.82 L303.281 1027.82 L287.281 1011.82 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M515.774 1496.82 L499.774 1512.82 L515.774 1528.82 L531.774 1512.82 L515.774 1496.82 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M744.266 1459.4 L728.266 1475.4 L744.266 1491.4 L760.266 1475.4 L744.266 1459.4 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M972.759 1625.99 L956.759 1641.99 L972.759 1657.99 L988.759 1641.99 L972.759 1625.99 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M1201.25 1619.46 L1185.25 1635.46 L1201.25 1651.46 L1217.25 1635.46 L1201.25 1619.46 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M1429.74 1676.61 L1413.74 1692.61 L1429.74 1708.61 L1445.74 1692.61 L1429.74 1676.61 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M1658.24 1676.06 L1642.24 1692.06 L1658.24 1708.06 L1674.24 1692.06 L1658.24 1676.06 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M1886.73 1694.83 L1870.73 1710.83 L1886.73 1726.83 L1902.73 1710.83 L1886.73 1694.83 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M2115.22 1693.84 L2099.22 1709.84 L2115.22 1725.84 L2131.22 1709.84 L2115.22 1693.84 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M2343.72 1697.55 L2327.72 1713.55 L2343.72 1729.55 L2359.72 1713.55 L2343.72 1697.55 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip693)" d="M2572.21 1693.19 L2556.21 1709.19 L2572.21 1725.19 L2588.21 1709.19 L2572.21 1693.19 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip693)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="287.281,1027.82 515.774,1027.82 515.774,1512.82 744.266,1512.82 744.266,1475.4 972.759,1475.4 972.759,1641.99 1201.25,1641.99 1201.25,1635.46 1429.74,1635.46 1429.74,1692.61 1658.24,1692.61 1658.24,1692.06 1886.73,1692.06 1886.73,1710.83 2115.22,1710.83 2115.22,1709.84 2343.72,1709.84 2343.72,1713.55 2572.21,1713.55 2572.21,1709.19 "></polyline>
<path clip-path="url(#clip690)" d="M2274.72 1186.99 L2560.02 1186.99 L2560.02 1031.47 L2274.72 1031.47  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip690)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2274.72,1186.99 2560.02,1186.99 2560.02,1031.47 2274.72,1031.47 2274.72,1186.99 "></polyline>
<polyline clip-path="url(#clip690)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2301.63,1083.31 2463.1,1083.31 "></polyline>
<path clip-path="url(#clip690)" d="M2514.66 1074.67 L2505.29 1087.28 L2515.15 1100.59 L2510.12 1100.59 L2502.58 1090.41 L2495.03 1100.59 L2490.01 1100.59 L2500.08 1087.03 L2490.87 1074.67 L2495.89 1074.67 L2502.76 1083.9 L2509.64 1074.67 L2514.66 1074.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M2520.31 1098.05 L2525.03 1098.05 L2525.03 1083.9 L2519.87 1084.85 L2519.87 1082.17 L2525.19 1081.26 L2528.37 1081.26 L2528.37 1098.05 L2533.11 1098.05 L2533.11 1100.59 L2520.31 1100.59 L2520.31 1098.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip690)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2301.63,1135.15 2463.1,1135.15 "></polyline>
<path clip-path="url(#clip690)" d="M2514.66 1126.51 L2505.29 1139.12 L2515.15 1152.43 L2510.12 1152.43 L2502.58 1142.25 L2495.03 1152.43 L2490.01 1152.43 L2500.08 1138.87 L2490.87 1126.51 L2495.89 1126.51 L2502.76 1135.74 L2509.64 1126.51 L2514.66 1126.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip690)" d="M2522.9 1149.79 L2532.72 1149.79 L2532.72 1152.43 L2518.87 1152.43 L2518.87 1149.89 Q2519.66 1149.17 2521.12 1147.87 Q2529.08 1140.81 2529.08 1138.64 Q2529.08 1137.11 2527.88 1136.18 Q2526.68 1135.23 2524.71 1135.23 Q2523.5 1135.23 2522.09 1135.65 Q2520.68 1136.04 2519.01 1136.85 L2519.01 1134.01 Q2520.8 1133.36 2522.32 1133.04 Q2523.87 1132.71 2525.19 1132.71 Q2528.55 1132.71 2530.56 1134.24 Q2532.58 1135.77 2532.58 1138.27 Q2532.58 1141.48 2524.92 1148.06 Q2523.62 1149.17 2522.9 1149.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
</div>
<section id="adding-constraints-on-controls-and-states" class="level3">
<h3 class="anchored" data-anchor-id="adding-constraints-on-controls-and-states">Adding constraints on controls and states</h3>
<p>When solving a realistic optimal control problem, we may want to impose inequality constraints on <span class="math inline">\bm u_k</span> due to saturation of actuators. We may also want to add constraints on <span class="math inline">\bm x_k</span> as well, which may reflect some performance specifications. In both cases, we would arrive at the full KKT conditions, and rather than trying to solve these, we resort to some finetuned numerical solver for quadratic programming (QP) instead.</p>
</section>
</section>
<section id="sequential-dense-formulation" class="level2">
<h2 class="anchored" data-anchor-id="sequential-dense-formulation">Sequential (dense) formulation</h2>
<p>We can express <span class="math inline">\bar{\bm x}</span> as a function of <span class="math inline">\bar{\bm u}</span> and <span class="math inline">\mathbf x_0</span>. This can be done in a straightforward way using (<a href="#eq-linear_system_linear_constraints_matrix_format" class="quarto-xref">Eq.&nbsp;1</a>), namely, <span class="math display">
\bar{\bm x} = (\mathbf I-\overline{\mathbf A})^{-1}\overline{\mathbf B} \bm u + (\mathbf I-\overline{\mathbf A})^{-1} \overline{\mathbf A}_0 \mathbf x_0.
</span></p>
<p>However, instead of solving the sets of equations, we can do this substitution in a more insightful way. Write down the state equation for several discrete times <span class="math display">
\begin{aligned}
\bm x_1 &amp;= \mathbf A\mathbf x_0 + \mathbf B\bm u_0\\
\bm x_2 &amp;= \mathbf A\mathbf x_0 + \mathbf B\bm u_0\\
     &amp;= \mathbf A(\mathbf A\mathbf x_0 + \mathbf B\bm u_0)+ \mathbf B\bm u_0\\
     &amp;= \mathbf A^2\mathbf x_0 + \mathbf A\mathbf B\bm u_0 + \mathbf B\bm u_0\\
     &amp;\vdots\\
\bm x_k &amp;= \mathbf A^k\mathbf x_0 + \mathbf A^{k-1}\mathbf B\bm u_0 +\mathbf A^{k-2}\mathbf B\bm u_1 +\ldots \mathbf B\bm u_{k-1}.
\end{aligned}
</span></p>
<p>Rewriting into matrix-vector form (and extending the time <span class="math inline">k</span> up to the final time <span class="math inline">N</span>) <span class="math display">
\begin{bmatrix}
\bm x_1\\\bm x_2\\\vdots\\\bm x_N
\end{bmatrix}
=
\underbrace{
\begin{bmatrix}
  \mathbf B &amp; &amp; &amp; \\
  \mathbf A\mathbf B &amp; \mathbf B &amp; &amp; \\
  \vdots &amp; &amp; \ddots &amp;\\
  \mathbf A^{N-1}\mathbf B &amp; \mathbf A^{N-2}\mathbf B &amp; &amp; \mathbf B
\end{bmatrix}}_{\widehat{\mathbf C}}
  \begin{bmatrix}
\bm u_0\\\bm u_1\\\vdots\\\bm u_{N-1}
\end{bmatrix}
+
\underbrace{
  \begin{bmatrix}
\mathbf A\\\mathbf A^2\\\vdots\\\mathbf A^N
\end{bmatrix}}_{\widehat{\mathbf A}}\mathbf x_0.
</span></p>
<p>For convenience, let’s rewrite the compact relation between <span class="math inline">\bar{\bm x}</span> and <span class="math inline">\bar{\bm u}</span> and <span class="math inline">\mathbf x_0</span> <span id="eq-x_as_function_of_u_and_x0"><span class="math display">
\bar{\bm x} = \widehat{\mathbf C} \bar{\bm u} + \widehat{\mathbf A} \mathbf x_0.
\tag{2}</span></span></p>
<p>We can now substitute this into the original cost, which then becomes independent of <span class="math inline">\bar{\bm x}</span>, which we reflect formally by using a new name <span class="math inline">\tilde J</span> <span class="math display">
\begin{aligned}
\tilde J(\bar{\bm u};\mathbf x_0) &amp;= \frac{1}{2}(\widehat{\mathbf C} \bar{\bm u} + \widehat{\mathbf A} \mathbf x_0)^\top\overline{\mathbf Q} (\widehat{\mathbf C} \bar{\bm u} + \widehat{\mathbf A} \mathbf x_0) + \frac{1}{2}\bar{\bm u}^\top\overline{\mathbf R} \bar{\bm u} + \frac{1}{2}\mathbf x_0^\top\mathbf Q\mathbf x_0\\
&amp;= \frac{1}{2}\bar{\bm u}^\top\widehat{\mathbf C}^\top \overline{\mathbf Q} \widehat{\mathbf C} \bar{\bm u} + \mathbf x_0^\top\widehat{\mathbf A}^\top \overline{\mathbf Q} \widehat{\mathbf C} \bar{\bm u} + \frac{1}{2} \mathbf x_0^\top\widehat{\mathbf A}^\top \overline{\mathbf Q} \widehat{\mathbf A} \mathbf x_0 + \frac{1}{2}\bar{\bm u}^\top\overline{\mathbf R} \bar{\bm u} + \frac{1}{2}\mathbf x_0^\top\mathbf Q\mathbf x_0\\
&amp;= \frac{1}{2}\bar{\bm u}^\top(\widehat{\mathbf C}^\top \overline{\mathbf Q} \widehat{\mathbf C} + \overline{\mathbf R})\bar{\bm u} + \mathbf x_0^\top\widehat{\mathbf A}^\top \overline{\mathbf Q} \widehat{\mathbf C} \bar{\bm u} + \frac{1}{2} \mathbf x_0^\top(\widehat{\mathbf A}^\top \overline{\mathbf Q} \widehat{\mathbf A} + \mathbf Q)\mathbf x_0.
\end{aligned}
</span></p>
<p>The last term (the one independent of <span class="math inline">\bar{\bm u}</span>) does not have an impact on the optimal <span class="math inline">\bar{\bm u}</span> and therefore it can be discarded, but such minor modification perhaps does not justify a new name for the cost function. We write it as <span class="math display">
\tilde J(\bar{\bm u};\mathbf x_0) = \frac{1}{2}\bar{\bm u}^\top\underbrace{(\widehat{\mathbf C}^\top \overline{\mathbf Q} \widehat{\mathbf C} + \overline{\mathbf R})}_{\mathbf H}\bar{\bm u} +  \mathbf x_0^\top\underbrace{\widehat{\mathbf A}^\top \overline{\mathbf Q} \widehat{\mathbf C}}_{\mathbf F^\top} \bar{\bm u}.
</span></p>
<p>This cost is a function of <span class="math inline">\bar{\bm u}</span>, the initial state <span class="math inline">\mathbf x_0</span> is regarded as a fixed parameter. Its gradient is <span class="math display">
\nabla \tilde J = \mathbf H\bar{\bm u}+\mathbf F\mathbf x_0.
</span></p>
<p>Setting it to zero leads to the following linear system of equations <span class="math display">
\mathbf H\bar{\bm u}=-\mathbf F\mathbf x_0
</span> that needs to be solved for <span class="math inline">\bar{\bm u}</span>. Formally, we write the solution as <span class="math display">
\bar{\bm u} = -\mathbf H^{-1} \mathbf F \mathbf x_0.
</span></p>
<div id="exm-direct-sequential" class="theorem example">
<p><span class="theorem-title"><strong>Example 2 (Reformulating the unconstrained LQR problem as a system of linear equations – sequential approach)</strong></span> &nbsp;</p>
<div id="4" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">direct_dlqr_sequential</span>(A,B,x₀,Q,R,S,N)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">size</span>(A)[<span class="fl">1</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="fu">size</span>(B)[<span class="fl">2</span>]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    Q̄ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,N<span class="op">*</span>n),<span class="fu">repeat</span>([n],N),<span class="fu">repeat</span>([n],N))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        Q̄[<span class="fu">Block</span>(i,i)] <span class="op">=</span> Q</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    Q̄[<span class="fu">Block</span>(N,N)] <span class="op">=</span> S</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    R̄ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>m,N<span class="op">*</span>m),<span class="fu">repeat</span>([m],N),<span class="fu">repeat</span>([m],N))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        R̄[<span class="fu">Block</span>(i,i)] <span class="op">=</span> R</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    Ĉ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,N<span class="op">*</span>m),<span class="fu">repeat</span>([n],N),<span class="fu">repeat</span>([m],N))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    Â <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,n),<span class="fu">repeat</span>([n],N),[n])</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>i</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>            Ĉ[<span class="fu">Block</span>(i,j)] <span class="op">=</span> A<span class="op">^</span>(i<span class="op">-</span>j)<span class="op">*</span>B</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>            Â[<span class="fu">Block</span>(i,<span class="fl">1</span>)] <span class="op">=</span> A<span class="op">^</span>i</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> Ĉ<span class="ch">'*Q̄*Ĉ + R̄</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> <span class="fu">Array</span>(H)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> Ĉ<span class="ch">'*Q̄*Â</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> <span class="fu">Array</span>(F)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    uopt <span class="op">=</span> <span class="fu">-H\</span>(F<span class="op">*</span>x₀)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    xopt <span class="op">=</span> Ĉ<span class="op">*</span>uopt <span class="op">+</span> Â<span class="op">*</span>x₀</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    xopt <span class="op">=</span> <span class="fu">reshape</span>(xopt,(<span class="fl">2</span>,<span class="op">:</span>))</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> xopt,uopt</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="fl">2</span>               <span class="co"># Number of state variables.</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1</span>               <span class="co"># Number of (control) input variables. </span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> <span class="fu">rand</span>(n,n)       <span class="co"># State matrix.</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> <span class="fu">rand</span>(n,m)       <span class="co"># Input coupling matrix.</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>x₀ <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">3.0</span>]     <span class="co"># Initial state.</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">10</span>              <span class="co"># Time horizon.</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">2.0</span>]      </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">2.0</span>]</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> [<span class="fl">1.0</span>]</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>s)     <span class="co"># Matrix defining the terminal state cost.</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>q)     <span class="co"># Matrix defining the running state dost.</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>r)     <span class="co"># Matrix defining the cost of control.</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>xopt,uopt <span class="op">=</span> <span class="fu">direct_dlqr_sequential</span>(A,B,x₀,Q,R,S,N)</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> <span class="fu">plot</span>(<span class="fl">0</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>),uopt,marker<span class="op">=:</span>diamond,label<span class="op">=</span><span class="st">"u"</span>,linetype<span class="op">=:</span>steppost)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel!</span>(<span class="st">"k"</span>)</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel!</span>(<span class="st">"u"</span>)</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> <span class="fu">plot</span>(<span class="fl">0</span><span class="op">:</span>N,<span class="fu">hcat</span>(x₀,xopt)<span class="ch">',marker=:diamond,label=["x₁" "x₂"],linetype=:steppost)</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel!</span>(<span class="st">"k"</span>)</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel!</span>(<span class="st">"x"</span>)</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p1,p2,layout<span class="op">=</span>(<span class="fl">2</span>,<span class="fl">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip750">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip750)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip751">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip750)" d="M263.478 774.117 L2640.76 774.117 L2640.76 47.2441 L263.478 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip752">
    <rect x="263" y="47" width="2378" height="728"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="330.76,774.117 330.76,47.2441 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="829.141,774.117 829.141,47.2441 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1327.52,774.117 1327.52,47.2441 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1825.9,774.117 1825.9,47.2441 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2324.28,774.117 2324.28,47.2441 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,750.062 2640.76,750.062 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,521.763 2640.76,521.763 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,293.464 2640.76,293.464 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,65.1654 2640.76,65.1654 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,774.117 2640.76,774.117 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="330.76,774.117 330.76,755.219 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="829.141,774.117 829.141,755.219 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1327.52,774.117 1327.52,755.219 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1825.9,774.117 1825.9,755.219 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2324.28,774.117 2324.28,755.219 "></polyline>
<path clip-path="url(#clip750)" d="M330.76 807.34 Q327.149 807.34 325.32 810.904 Q323.514 814.446 323.514 821.576 Q323.514 828.682 325.32 832.247 Q327.149 835.789 330.76 835.789 Q334.394 835.789 336.2 832.247 Q338.028 828.682 338.028 821.576 Q338.028 814.446 336.2 810.904 Q334.394 807.34 330.76 807.34 M330.76 803.636 Q336.57 803.636 339.625 808.242 Q342.704 812.826 342.704 821.576 Q342.704 830.303 339.625 834.909 Q336.57 839.492 330.76 839.492 Q324.95 839.492 321.871 834.909 Q318.815 830.303 318.815 821.576 Q318.815 812.826 321.871 808.242 Q324.95 803.636 330.76 803.636 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M823.794 834.886 L840.113 834.886 L840.113 838.821 L818.169 838.821 L818.169 834.886 Q820.831 832.131 825.414 827.502 Q830.02 822.849 831.201 821.506 Q833.446 818.983 834.326 817.247 Q835.229 815.488 835.229 813.798 Q835.229 811.043 833.284 809.307 Q831.363 807.571 828.261 807.571 Q826.062 807.571 823.608 808.335 Q821.178 809.099 818.4 810.65 L818.4 805.928 Q821.224 804.793 823.678 804.215 Q826.132 803.636 828.169 803.636 Q833.539 803.636 836.733 806.321 Q839.928 809.006 839.928 813.497 Q839.928 815.627 839.118 817.548 Q838.331 819.446 836.224 822.039 Q835.645 822.71 832.544 825.928 Q829.442 829.122 823.794 834.886 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1330.53 808.335 L1318.73 826.784 L1330.53 826.784 L1330.53 808.335 M1329.3 804.261 L1335.18 804.261 L1335.18 826.784 L1340.11 826.784 L1340.11 830.673 L1335.18 830.673 L1335.18 838.821 L1330.53 838.821 L1330.53 830.673 L1314.93 830.673 L1314.93 826.159 L1329.3 804.261 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1826.31 819.678 Q1823.16 819.678 1821.31 821.83 Q1819.48 823.983 1819.48 827.733 Q1819.48 831.46 1821.31 833.636 Q1823.16 835.789 1826.31 835.789 Q1829.46 835.789 1831.28 833.636 Q1833.14 831.46 1833.14 827.733 Q1833.14 823.983 1831.28 821.83 Q1829.46 819.678 1826.31 819.678 M1835.59 805.025 L1835.59 809.284 Q1833.83 808.451 1832.03 808.011 Q1830.24 807.571 1828.48 807.571 Q1823.85 807.571 1821.4 810.696 Q1818.97 813.821 1818.62 820.141 Q1819.99 818.127 1822.05 817.062 Q1824.11 815.974 1826.59 815.974 Q1831.79 815.974 1834.8 819.145 Q1837.84 822.293 1837.84 827.733 Q1837.84 833.057 1834.69 836.275 Q1831.54 839.492 1826.31 839.492 Q1820.31 839.492 1817.14 834.909 Q1813.97 830.303 1813.97 821.576 Q1813.97 813.381 1817.86 808.52 Q1821.75 803.636 1828.3 803.636 Q1830.06 803.636 1831.84 803.983 Q1833.65 804.33 1835.59 805.025 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2324.28 822.409 Q2320.95 822.409 2319.03 824.191 Q2317.13 825.974 2317.13 829.099 Q2317.13 832.224 2319.03 834.006 Q2320.95 835.789 2324.28 835.789 Q2327.62 835.789 2329.54 834.006 Q2331.46 832.201 2331.46 829.099 Q2331.46 825.974 2329.54 824.191 Q2327.64 822.409 2324.28 822.409 M2319.61 820.418 Q2316.6 819.678 2314.91 817.617 Q2313.24 815.557 2313.24 812.594 Q2313.24 808.451 2316.18 806.043 Q2319.15 803.636 2324.28 803.636 Q2329.45 803.636 2332.39 806.043 Q2335.33 808.451 2335.33 812.594 Q2335.33 815.557 2333.64 817.617 Q2331.97 819.678 2328.98 820.418 Q2332.36 821.205 2334.24 823.497 Q2336.14 825.789 2336.14 829.099 Q2336.14 834.122 2333.06 836.807 Q2330 839.492 2324.28 839.492 Q2318.57 839.492 2315.49 836.807 Q2312.43 834.122 2312.43 829.099 Q2312.43 825.789 2314.33 823.497 Q2316.23 821.205 2319.61 820.418 M2317.9 813.034 Q2317.9 815.719 2319.56 817.224 Q2321.25 818.729 2324.28 818.729 Q2327.29 818.729 2328.98 817.224 Q2330.7 815.719 2330.7 813.034 Q2330.7 810.349 2328.98 808.844 Q2327.29 807.34 2324.28 807.34 Q2321.25 807.34 2319.56 808.844 Q2317.9 810.349 2317.9 813.034 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1436.3 873.776 L1442.19 873.776 L1442.19 903.026 L1459.66 887.653 L1467.14 887.653 L1448.23 904.331 L1467.94 923.301 L1460.3 923.301 L1442.19 905.891 L1442.19 923.301 L1436.3 923.301 L1436.3 873.776 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,774.117 263.478,47.2441 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,750.062 282.376,750.062 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,521.763 282.376,521.763 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,293.464 282.376,293.464 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,65.1654 282.376,65.1654 "></polyline>
<path clip-path="url(#clip750)" d="M117.21 750.514 L146.886 750.514 L146.886 754.449 L117.21 754.449 L117.21 750.514 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M157.788 763.407 L165.427 763.407 L165.427 737.041 L157.117 738.708 L157.117 734.449 L165.381 732.782 L170.057 732.782 L170.057 763.407 L177.696 763.407 L177.696 767.342 L157.788 767.342 L157.788 763.407 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M187.14 761.463 L192.024 761.463 L192.024 767.342 L187.14 767.342 L187.14 761.463 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M202.256 732.782 L220.612 732.782 L220.612 736.717 L206.538 736.717 L206.538 745.19 Q207.557 744.842 208.575 744.68 Q209.594 744.495 210.612 744.495 Q216.399 744.495 219.779 747.666 Q223.158 750.838 223.158 756.254 Q223.158 761.833 219.686 764.935 Q216.214 768.013 209.894 768.013 Q207.719 768.013 205.45 767.643 Q203.205 767.273 200.797 766.532 L200.797 761.833 Q202.881 762.967 205.103 763.523 Q207.325 764.078 209.802 764.078 Q213.807 764.078 216.144 761.972 Q218.482 759.865 218.482 756.254 Q218.482 752.643 216.144 750.537 Q213.807 748.43 209.802 748.43 Q207.927 748.43 206.052 748.847 Q204.2 749.264 202.256 750.143 L202.256 732.782 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M116.214 522.215 L145.89 522.215 L145.89 526.15 L116.214 526.15 L116.214 522.215 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M156.793 535.108 L164.432 535.108 L164.432 508.742 L156.122 510.409 L156.122 506.15 L164.385 504.483 L169.061 504.483 L169.061 535.108 L176.7 535.108 L176.7 539.043 L156.793 539.043 L156.793 535.108 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M186.145 533.164 L191.029 533.164 L191.029 539.043 L186.145 539.043 L186.145 533.164 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M211.214 507.562 Q207.603 507.562 205.774 511.127 Q203.969 514.668 203.969 521.798 Q203.969 528.904 205.774 532.469 Q207.603 536.011 211.214 536.011 Q214.848 536.011 216.654 532.469 Q218.482 528.904 218.482 521.798 Q218.482 514.668 216.654 511.127 Q214.848 507.562 211.214 507.562 M211.214 503.858 Q217.024 503.858 220.08 508.465 Q223.158 513.048 223.158 521.798 Q223.158 530.525 220.08 535.131 Q217.024 539.715 211.214 539.715 Q205.404 539.715 202.325 535.131 Q199.27 530.525 199.27 521.798 Q199.27 513.048 202.325 508.465 Q205.404 503.858 211.214 503.858 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M117.21 293.916 L146.886 293.916 L146.886 297.851 L117.21 297.851 L117.21 293.916 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M166.978 279.263 Q163.367 279.263 161.538 282.828 Q159.733 286.369 159.733 293.499 Q159.733 300.606 161.538 304.17 Q163.367 307.712 166.978 307.712 Q170.612 307.712 172.418 304.17 Q174.247 300.606 174.247 293.499 Q174.247 286.369 172.418 282.828 Q170.612 279.263 166.978 279.263 M166.978 275.559 Q172.788 275.559 175.844 280.166 Q178.922 284.749 178.922 293.499 Q178.922 302.226 175.844 306.832 Q172.788 311.416 166.978 311.416 Q161.168 311.416 158.089 306.832 Q155.034 302.226 155.034 293.499 Q155.034 284.749 158.089 280.166 Q161.168 275.559 166.978 275.559 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M187.14 304.865 L192.024 304.865 L192.024 310.744 L187.14 310.744 L187.14 304.865 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M202.256 276.184 L220.612 276.184 L220.612 280.12 L206.538 280.12 L206.538 288.592 Q207.557 288.244 208.575 288.082 Q209.594 287.897 210.612 287.897 Q216.399 287.897 219.779 291.069 Q223.158 294.24 223.158 299.656 Q223.158 305.235 219.686 308.337 Q216.214 311.416 209.894 311.416 Q207.719 311.416 205.45 311.045 Q203.205 310.675 200.797 309.934 L200.797 305.235 Q202.881 306.369 205.103 306.925 Q207.325 307.48 209.802 307.48 Q213.807 307.48 216.144 305.374 Q218.482 303.268 218.482 299.656 Q218.482 296.045 216.144 293.939 Q213.807 291.832 209.802 291.832 Q207.927 291.832 206.052 292.249 Q204.2 292.666 202.256 293.545 L202.256 276.184 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M165.983 50.9641 Q162.372 50.9641 160.543 54.5289 Q158.737 58.0706 158.737 65.2002 Q158.737 72.3066 160.543 75.8714 Q162.372 79.4131 165.983 79.4131 Q169.617 79.4131 171.422 75.8714 Q173.251 72.3066 173.251 65.2002 Q173.251 58.0706 171.422 54.5289 Q169.617 50.9641 165.983 50.9641 M165.983 47.2604 Q171.793 47.2604 174.848 51.8669 Q177.927 56.4502 177.927 65.2002 Q177.927 73.927 174.848 78.5334 Q171.793 83.1167 165.983 83.1167 Q160.173 83.1167 157.094 78.5334 Q154.038 73.927 154.038 65.2002 Q154.038 56.4502 157.094 51.8669 Q160.173 47.2604 165.983 47.2604 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M186.145 76.5658 L191.029 76.5658 L191.029 82.4454 L186.145 82.4454 L186.145 76.5658 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M211.214 50.9641 Q207.603 50.9641 205.774 54.5289 Q203.969 58.0706 203.969 65.2002 Q203.969 72.3066 205.774 75.8714 Q207.603 79.4131 211.214 79.4131 Q214.848 79.4131 216.654 75.8714 Q218.482 72.3066 218.482 65.2002 Q218.482 58.0706 216.654 54.5289 Q214.848 50.9641 211.214 50.9641 M211.214 47.2604 Q217.024 47.2604 220.08 51.8669 Q223.158 56.4502 223.158 65.2002 Q223.158 73.927 220.08 78.5334 Q217.024 83.1167 211.214 83.1167 Q205.404 83.1167 202.325 78.5334 Q199.27 73.927 199.27 65.2002 Q199.27 56.4502 202.325 51.8669 Q205.404 47.2604 211.214 47.2604 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M47.5702 425.608 L25.9905 425.608 L25.9905 419.752 L47.3474 419.752 Q52.4082 419.752 54.9545 417.778 Q57.4689 415.805 57.4689 411.858 Q57.4689 407.116 54.4452 404.378 Q51.4215 401.609 46.2016 401.609 L25.9905 401.609 L25.9905 395.753 L61.6384 395.753 L61.6384 401.609 L56.1639 401.609 Q59.4104 403.742 61.0019 406.575 Q62.5615 409.376 62.5615 413.1 Q62.5615 419.242 58.742 422.425 Q54.9226 425.608 47.5702 425.608 M25.1311 410.872 L25.1311 410.872 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip752)" d="M330.76 737.545 L314.76 753.545 L330.76 769.545 L346.76 753.545 L330.76 737.545 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M579.95 418.5 L563.95 434.5 L579.95 450.5 L595.95 434.5 L579.95 418.5 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M829.141 259.71 L813.141 275.71 L829.141 291.71 L845.141 275.71 L829.141 259.71 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M1078.33 169.662 L1062.33 185.662 L1078.33 201.662 L1094.33 185.662 L1078.33 169.662 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M1327.52 118.101 L1311.52 134.101 L1327.52 150.101 L1343.52 134.101 L1327.52 118.101 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M1576.71 88.525 L1560.71 104.525 L1576.71 120.525 L1592.71 104.525 L1576.71 88.525 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M1825.9 71.5011 L1809.9 87.5011 L1825.9 103.501 L1841.9 87.5011 L1825.9 71.5011 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M2075.09 61.6001 L2059.09 77.6001 L2075.09 93.6001 L2091.09 77.6001 L2075.09 61.6001 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M2324.28 55.665 L2308.28 71.665 L2324.28 87.665 L2340.28 71.665 L2324.28 55.665 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M2573.47 51.816 L2557.47 67.816 L2573.47 83.816 L2589.47 67.816 L2573.47 51.816 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip752)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="330.76,753.545 579.95,753.545 579.95,434.5 829.141,434.5 829.141,275.71 1078.33,275.71 1078.33,185.662 1327.52,185.662 1327.52,134.101 1576.71,134.101 1576.71,104.525 1825.9,104.525 1825.9,87.5011 2075.09,87.5011 2075.09,77.6001 2324.28,77.6001 2324.28,71.665 2573.47,71.665 2573.47,67.816 "></polyline>
<path clip-path="url(#clip750)" d="M342.721 175.153 L602.162 175.153 L602.162 71.4732 L342.721 71.4732  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="342.721,175.153 602.162,175.153 602.162,71.4732 342.721,71.4732 342.721,175.153 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="369.135,123.313 527.62,123.313 "></polyline>
<path clip-path="url(#clip750)" d="M554.034 130.362 L554.034 114.667 L558.294 114.667 L558.294 130.2 Q558.294 133.88 559.729 135.732 Q561.164 137.561 564.034 137.561 Q567.483 137.561 569.474 135.362 Q571.488 133.163 571.488 129.366 L571.488 114.667 L575.747 114.667 L575.747 140.593 L571.488 140.593 L571.488 136.612 Q569.937 138.973 567.877 140.13 Q565.84 141.264 563.132 141.264 Q558.664 141.264 556.349 138.487 Q554.034 135.709 554.034 130.362 M564.752 114.042 L564.752 114.042 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M263.478 1734.12 L2640.76 1734.12 L2640.76 1007.24 L263.478 1007.24  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip753">
    <rect x="263" y="1007" width="2378" height="728"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="330.76,1734.12 330.76,1007.24 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="891.438,1734.12 891.438,1007.24 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1452.12,1734.12 1452.12,1007.24 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2012.8,1734.12 2012.8,1007.24 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2573.47,1734.12 2573.47,1007.24 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,1714.64 2640.76,1714.64 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,1485.7 2640.76,1485.7 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,1256.76 2640.76,1256.76 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,1027.82 2640.76,1027.82 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1734.12 2640.76,1734.12 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="330.76,1734.12 330.76,1715.22 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="891.438,1734.12 891.438,1715.22 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1452.12,1734.12 1452.12,1715.22 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2012.8,1734.12 2012.8,1715.22 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2573.47,1734.12 2573.47,1715.22 "></polyline>
<path clip-path="url(#clip750)" d="M308.144 1767.34 Q304.533 1767.34 302.704 1770.9 Q300.899 1774.45 300.899 1781.58 Q300.899 1788.68 302.704 1792.25 Q304.533 1795.79 308.144 1795.79 Q311.778 1795.79 313.584 1792.25 Q315.413 1788.68 315.413 1781.58 Q315.413 1774.45 313.584 1770.9 Q311.778 1767.34 308.144 1767.34 M308.144 1763.64 Q313.954 1763.64 317.01 1768.24 Q320.089 1772.83 320.089 1781.58 Q320.089 1790.3 317.01 1794.91 Q313.954 1799.49 308.144 1799.49 Q302.334 1799.49 299.255 1794.91 Q296.2 1790.3 296.2 1781.58 Q296.2 1772.83 299.255 1768.24 Q302.334 1763.64 308.144 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M328.306 1792.94 L333.19 1792.94 L333.19 1798.82 L328.306 1798.82 L328.306 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M353.375 1767.34 Q349.764 1767.34 347.936 1770.9 Q346.13 1774.45 346.13 1781.58 Q346.13 1788.68 347.936 1792.25 Q349.764 1795.79 353.375 1795.79 Q357.01 1795.79 358.815 1792.25 Q360.644 1788.68 360.644 1781.58 Q360.644 1774.45 358.815 1770.9 Q357.01 1767.34 353.375 1767.34 M353.375 1763.64 Q359.186 1763.64 362.241 1768.24 Q365.32 1772.83 365.32 1781.58 Q365.32 1790.3 362.241 1794.91 Q359.186 1799.49 353.375 1799.49 Q347.565 1799.49 344.487 1794.91 Q341.431 1790.3 341.431 1781.58 Q341.431 1772.83 344.487 1768.24 Q347.565 1763.64 353.375 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M863.175 1794.89 L879.494 1794.89 L879.494 1798.82 L857.55 1798.82 L857.55 1794.89 Q860.212 1792.13 864.795 1787.5 Q869.402 1782.85 870.582 1781.51 Q872.827 1778.98 873.707 1777.25 Q874.61 1775.49 874.61 1773.8 Q874.61 1771.04 872.665 1769.31 Q870.744 1767.57 867.642 1767.57 Q865.443 1767.57 862.99 1768.34 Q860.559 1769.1 857.781 1770.65 L857.781 1765.93 Q860.605 1764.79 863.059 1764.21 Q865.513 1763.64 867.55 1763.64 Q872.92 1763.64 876.114 1766.32 Q879.309 1769.01 879.309 1773.5 Q879.309 1775.63 878.499 1777.55 Q877.712 1779.45 875.605 1782.04 Q875.026 1782.71 871.925 1785.93 Q868.823 1789.12 863.175 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M889.309 1792.94 L894.193 1792.94 L894.193 1798.82 L889.309 1798.82 L889.309 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M904.424 1764.26 L922.781 1764.26 L922.781 1768.2 L908.707 1768.2 L908.707 1776.67 Q909.725 1776.32 910.744 1776.16 Q911.762 1775.97 912.781 1775.97 Q918.568 1775.97 921.948 1779.15 Q925.327 1782.32 925.327 1787.73 Q925.327 1793.31 921.855 1796.41 Q918.383 1799.49 912.063 1799.49 Q909.887 1799.49 907.619 1799.12 Q905.374 1798.75 902.966 1798.01 L902.966 1793.31 Q905.049 1794.45 907.272 1795 Q909.494 1795.56 911.971 1795.56 Q915.975 1795.56 918.313 1793.45 Q920.651 1791.34 920.651 1787.73 Q920.651 1784.12 918.313 1782.02 Q915.975 1779.91 911.971 1779.91 Q910.096 1779.91 908.221 1780.33 Q906.369 1780.74 904.424 1781.62 L904.424 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1419.28 1764.26 L1437.64 1764.26 L1437.64 1768.2 L1423.56 1768.2 L1423.56 1776.67 Q1424.58 1776.32 1425.6 1776.16 Q1426.62 1775.97 1427.64 1775.97 Q1433.43 1775.97 1436.8 1779.15 Q1440.18 1782.32 1440.18 1787.73 Q1440.18 1793.31 1436.71 1796.41 Q1433.24 1799.49 1426.92 1799.49 Q1424.74 1799.49 1422.48 1799.12 Q1420.23 1798.75 1417.82 1798.01 L1417.82 1793.31 Q1419.91 1794.45 1422.13 1795 Q1424.35 1795.56 1426.83 1795.56 Q1430.83 1795.56 1433.17 1793.45 Q1435.51 1791.34 1435.51 1787.73 Q1435.51 1784.12 1433.17 1782.02 Q1430.83 1779.91 1426.83 1779.91 Q1424.95 1779.91 1423.08 1780.33 Q1421.23 1780.74 1419.28 1781.62 L1419.28 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1449.4 1792.94 L1454.28 1792.94 L1454.28 1798.82 L1449.4 1798.82 L1449.4 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1474.47 1767.34 Q1470.86 1767.34 1469.03 1770.9 Q1467.22 1774.45 1467.22 1781.58 Q1467.22 1788.68 1469.03 1792.25 Q1470.86 1795.79 1474.47 1795.79 Q1478.1 1795.79 1479.91 1792.25 Q1481.74 1788.68 1481.74 1781.58 Q1481.74 1774.45 1479.91 1770.9 Q1478.1 1767.34 1474.47 1767.34 M1474.47 1763.64 Q1480.28 1763.64 1483.33 1768.24 Q1486.41 1772.83 1486.41 1781.58 Q1486.41 1790.3 1483.33 1794.91 Q1480.28 1799.49 1474.47 1799.49 Q1468.66 1799.49 1465.58 1794.91 Q1462.52 1790.3 1462.52 1781.58 Q1462.52 1772.83 1465.58 1768.24 Q1468.66 1763.64 1474.47 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1979.12 1764.26 L2001.34 1764.26 L2001.34 1766.25 L1988.79 1798.82 L1983.91 1798.82 L1995.71 1768.2 L1979.12 1768.2 L1979.12 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2010.46 1792.94 L2015.34 1792.94 L2015.34 1798.82 L2010.46 1798.82 L2010.46 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2025.57 1764.26 L2043.93 1764.26 L2043.93 1768.2 L2029.86 1768.2 L2029.86 1776.67 Q2030.87 1776.32 2031.89 1776.16 Q2032.91 1775.97 2033.93 1775.97 Q2039.72 1775.97 2043.1 1779.15 Q2046.48 1782.32 2046.48 1787.73 Q2046.48 1793.31 2043 1796.41 Q2039.53 1799.49 2033.21 1799.49 Q2031.04 1799.49 2028.77 1799.12 Q2026.52 1798.75 2024.12 1798.01 L2024.12 1793.31 Q2026.2 1794.45 2028.42 1795 Q2030.64 1795.56 2033.12 1795.56 Q2037.12 1795.56 2039.46 1793.45 Q2041.8 1791.34 2041.8 1787.73 Q2041.8 1784.12 2039.46 1782.02 Q2037.12 1779.91 2033.12 1779.91 Q2031.24 1779.91 2029.37 1780.33 Q2027.52 1780.74 2025.57 1781.62 L2025.57 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2525.55 1794.89 L2533.19 1794.89 L2533.19 1768.52 L2524.88 1770.19 L2524.88 1765.93 L2533.14 1764.26 L2537.81 1764.26 L2537.81 1794.89 L2545.45 1794.89 L2545.45 1798.82 L2525.55 1798.82 L2525.55 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2564.9 1767.34 Q2561.29 1767.34 2559.46 1770.9 Q2557.65 1774.45 2557.65 1781.58 Q2557.65 1788.68 2559.46 1792.25 Q2561.29 1795.79 2564.9 1795.79 Q2568.53 1795.79 2570.34 1792.25 Q2572.17 1788.68 2572.17 1781.58 Q2572.17 1774.45 2570.34 1770.9 Q2568.53 1767.34 2564.9 1767.34 M2564.9 1763.64 Q2570.71 1763.64 2573.76 1768.24 Q2576.84 1772.83 2576.84 1781.58 Q2576.84 1790.3 2573.76 1794.91 Q2570.71 1799.49 2564.9 1799.49 Q2559.09 1799.49 2556.01 1794.91 Q2552.95 1790.3 2552.95 1781.58 Q2552.95 1772.83 2556.01 1768.24 Q2559.09 1763.64 2564.9 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2585.06 1792.94 L2589.94 1792.94 L2589.94 1798.82 L2585.06 1798.82 L2585.06 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2610.13 1767.34 Q2606.52 1767.34 2604.69 1770.9 Q2602.88 1774.45 2602.88 1781.58 Q2602.88 1788.68 2604.69 1792.25 Q2606.52 1795.79 2610.13 1795.79 Q2613.76 1795.79 2615.57 1792.25 Q2617.4 1788.68 2617.4 1781.58 Q2617.4 1774.45 2615.57 1770.9 Q2613.76 1767.34 2610.13 1767.34 M2610.13 1763.64 Q2615.94 1763.64 2619 1768.24 Q2622.07 1772.83 2622.07 1781.58 Q2622.07 1790.3 2619 1794.91 Q2615.94 1799.49 2610.13 1799.49 Q2604.32 1799.49 2601.24 1794.91 Q2598.18 1790.3 2598.18 1781.58 Q2598.18 1772.83 2601.24 1768.24 Q2604.32 1763.64 2610.13 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1436.3 1833.78 L1442.19 1833.78 L1442.19 1863.03 L1459.66 1847.65 L1467.14 1847.65 L1448.23 1864.33 L1467.94 1883.3 L1460.3 1883.3 L1442.19 1865.89 L1442.19 1883.3 L1436.3 1883.3 L1436.3 1833.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1734.12 263.478,1007.24 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1714.64 282.376,1714.64 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1485.7 282.376,1485.7 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1256.76 282.376,1256.76 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1027.82 282.376,1027.82 "></polyline>
<path clip-path="url(#clip750)" d="M211.214 1700.44 Q207.603 1700.44 205.774 1704 Q203.969 1707.55 203.969 1714.68 Q203.969 1721.78 205.774 1725.35 Q207.603 1728.89 211.214 1728.89 Q214.848 1728.89 216.654 1725.35 Q218.482 1721.78 218.482 1714.68 Q218.482 1707.55 216.654 1704 Q214.848 1700.44 211.214 1700.44 M211.214 1696.74 Q217.024 1696.74 220.08 1701.34 Q223.158 1705.93 223.158 1714.68 Q223.158 1723.4 220.08 1728.01 Q217.024 1732.59 211.214 1732.59 Q205.404 1732.59 202.325 1728.01 Q199.27 1723.4 199.27 1714.68 Q199.27 1705.93 202.325 1701.34 Q205.404 1696.74 211.214 1696.74 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M203.251 1499.04 L210.89 1499.04 L210.89 1472.68 L202.58 1474.35 L202.58 1470.09 L210.844 1468.42 L215.519 1468.42 L215.519 1499.04 L223.158 1499.04 L223.158 1502.98 L203.251 1502.98 L203.251 1499.04 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M206.839 1270.1 L223.158 1270.1 L223.158 1274.04 L201.214 1274.04 L201.214 1270.1 Q203.876 1267.35 208.459 1262.72 Q213.066 1258.07 214.246 1256.72 Q216.492 1254.2 217.371 1252.46 Q218.274 1250.7 218.274 1249.01 Q218.274 1246.26 216.33 1244.52 Q214.408 1242.79 211.307 1242.79 Q209.107 1242.79 206.654 1243.55 Q204.223 1244.32 201.445 1245.87 L201.445 1241.14 Q204.27 1240.01 206.723 1239.43 Q209.177 1238.85 211.214 1238.85 Q216.584 1238.85 219.779 1241.54 Q222.973 1244.22 222.973 1248.71 Q222.973 1250.84 222.163 1252.76 Q221.376 1254.66 219.269 1257.26 Q218.691 1257.93 215.589 1261.14 Q212.487 1264.34 206.839 1270.1 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M216.029 1026.46 Q219.385 1027.18 221.26 1029.45 Q223.158 1031.72 223.158 1035.05 Q223.158 1040.17 219.64 1042.97 Q216.121 1045.77 209.64 1045.77 Q207.464 1045.77 205.149 1045.33 Q202.857 1044.91 200.404 1044.05 L200.404 1039.54 Q202.348 1040.67 204.663 1041.25 Q206.978 1041.83 209.501 1041.83 Q213.899 1041.83 216.191 1040.1 Q218.506 1038.36 218.506 1035.05 Q218.506 1031.99 216.353 1030.28 Q214.223 1028.55 210.404 1028.55 L206.376 1028.55 L206.376 1024.7 L210.589 1024.7 Q214.038 1024.7 215.867 1023.34 Q217.695 1021.95 217.695 1019.36 Q217.695 1016.69 215.797 1015.28 Q213.922 1013.85 210.404 1013.85 Q208.482 1013.85 206.283 1014.26 Q204.084 1014.68 201.445 1015.56 L201.445 1011.39 Q204.107 1010.65 206.422 1010.28 Q208.76 1009.91 210.82 1009.91 Q216.144 1009.91 219.246 1012.34 Q222.348 1014.75 222.348 1018.87 Q222.348 1021.74 220.705 1023.73 Q219.061 1025.7 216.029 1026.46 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M109.046 1354.07 L126.392 1366.96 L144.694 1353.4 L144.694 1360.3 L130.689 1370.68 L144.694 1381.06 L144.694 1387.96 L126.042 1374.12 L109.046 1386.79 L109.046 1379.88 L121.745 1370.43 L109.046 1360.97 L109.046 1354.07 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip753)" d="M330.76 1469.7 L314.76 1485.7 L330.76 1501.7 L346.76 1485.7 L330.76 1469.7 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M555.031 1189.39 L539.031 1205.39 L555.031 1221.39 L571.031 1205.39 L555.031 1189.39 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M779.303 1392.76 L763.303 1408.76 L779.303 1424.76 L795.303 1408.76 L779.303 1392.76 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1003.57 1522.93 L987.574 1538.93 L1003.57 1554.93 L1019.57 1538.93 L1003.57 1522.93 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1227.85 1597.99 L1211.85 1613.99 L1227.85 1629.99 L1243.85 1613.99 L1227.85 1597.99 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1452.12 1640.99 L1436.12 1656.99 L1452.12 1672.99 L1468.12 1656.99 L1452.12 1640.99 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1676.39 1665.6 L1660.39 1681.6 L1676.39 1697.6 L1692.39 1681.6 L1676.39 1665.6 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1900.66 1679.68 L1884.66 1695.68 L1900.66 1711.68 L1916.66 1695.68 L1900.66 1679.68 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M2124.93 1687.71 L2108.93 1703.71 L2124.93 1719.71 L2140.93 1703.71 L2124.93 1687.71 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M2349.2 1692.26 L2333.2 1708.26 L2349.2 1724.26 L2365.2 1708.26 L2349.2 1692.26 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M2573.47 1694.77 L2557.47 1710.77 L2573.47 1726.77 L2589.47 1710.77 L2573.47 1694.77 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip753)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="330.76,1485.7 555.031,1485.7 555.031,1205.39 779.303,1205.39 779.303,1408.76 1003.57,1408.76 1003.57,1538.93 1227.85,1538.93 1227.85,1613.99 1452.12,1613.99 1452.12,1656.99 1676.39,1656.99 1676.39,1681.6 1900.66,1681.6 1900.66,1695.68 2124.93,1695.68 2124.93,1703.71 2349.2,1703.71 2349.2,1708.26 2573.47,1708.26 2573.47,1710.77 "></polyline>
<path clip-path="url(#clip753)" d="M330.76 1011.82 L314.76 1027.82 L330.76 1043.82 L346.76 1027.82 L330.76 1011.82 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M555.031 1605.39 L539.031 1621.39 L555.031 1637.39 L571.031 1621.39 L555.031 1605.39 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M779.303 1656.54 L763.303 1672.54 L779.303 1688.54 L795.303 1672.54 L779.303 1656.54 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1003.57 1674.95 L987.574 1690.95 L1003.57 1706.95 L1019.57 1690.95 L1003.57 1674.95 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1227.85 1685.08 L1211.85 1701.08 L1227.85 1717.08 L1243.85 1701.08 L1227.85 1685.08 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1452.12 1690.85 L1436.12 1706.85 L1452.12 1722.85 L1468.12 1706.85 L1452.12 1690.85 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1676.39 1694.13 L1660.39 1710.13 L1676.39 1726.13 L1692.39 1710.13 L1676.39 1694.13 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1900.66 1695.98 L1884.66 1711.98 L1900.66 1727.98 L1916.66 1711.98 L1900.66 1695.98 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M2124.93 1696.98 L2108.93 1712.98 L2124.93 1728.98 L2140.93 1712.98 L2124.93 1696.98 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M2349.2 1697.45 L2333.2 1713.45 L2349.2 1729.45 L2365.2 1713.45 L2349.2 1697.45 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M2573.47 1697.55 L2557.47 1713.55 L2573.47 1729.55 L2589.47 1713.55 L2573.47 1697.55 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip753)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="330.76,1027.82 555.031,1027.82 555.031,1621.39 779.303,1621.39 779.303,1672.54 1003.57,1672.54 1003.57,1690.95 1227.85,1690.95 1227.85,1701.08 1452.12,1701.08 1452.12,1706.85 1676.39,1706.85 1676.39,1710.13 1900.66,1710.13 1900.66,1711.98 2124.93,1711.98 2124.93,1712.98 2349.2,1712.98 2349.2,1713.45 2573.47,1713.45 2573.47,1713.55 "></polyline>
<path clip-path="url(#clip750)" d="M2280.68 1186.99 L2561.51 1186.99 L2561.51 1031.47 L2280.68 1031.47  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2280.68,1186.99 2561.51,1186.99 2561.51,1031.47 2280.68,1031.47 2280.68,1186.99 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2307.1,1083.31 2465.58,1083.31 "></polyline>
<path clip-path="url(#clip750)" d="M2516.65 1074.67 L2507.28 1087.28 L2517.14 1100.59 L2512.11 1100.59 L2504.57 1090.41 L2497.02 1100.59 L2492 1100.59 L2502.07 1087.03 L2492.85 1074.67 L2497.88 1074.67 L2504.75 1083.9 L2511.63 1074.67 L2516.65 1074.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2522.3 1098.05 L2527.02 1098.05 L2527.02 1083.9 L2521.86 1084.85 L2521.86 1082.17 L2527.18 1081.26 L2530.35 1081.26 L2530.35 1098.05 L2535.1 1098.05 L2535.1 1100.59 L2522.3 1100.59 L2522.3 1098.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip750)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2307.1,1135.15 2465.58,1135.15 "></polyline>
<path clip-path="url(#clip750)" d="M2516.65 1126.51 L2507.28 1139.12 L2517.14 1152.43 L2512.11 1152.43 L2504.57 1142.25 L2497.02 1152.43 L2492 1152.43 L2502.07 1138.87 L2492.85 1126.51 L2497.88 1126.51 L2504.75 1135.74 L2511.63 1126.51 L2516.65 1126.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2524.89 1149.79 L2534.71 1149.79 L2534.71 1152.43 L2520.86 1152.43 L2520.86 1149.89 Q2521.65 1149.17 2523.11 1147.87 Q2531.07 1140.81 2531.07 1138.64 Q2531.07 1137.11 2529.87 1136.18 Q2528.66 1135.23 2526.7 1135.23 Q2525.49 1135.23 2524.08 1135.65 Q2522.67 1136.04 2521 1136.85 L2521 1134.01 Q2522.78 1133.36 2524.31 1133.04 Q2525.86 1132.71 2527.18 1132.71 Q2530.54 1132.71 2532.55 1134.24 Q2534.57 1135.77 2534.57 1138.27 Q2534.57 1141.48 2526.9 1148.06 Q2525.61 1149.17 2524.89 1149.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
</div>
<section id="adding-the-constraints-on-controls" class="level3">
<h3 class="anchored" data-anchor-id="adding-the-constraints-on-controls">Adding the constraints on controls</h3>
<p>Adding constraints on <span class="math inline">\bar{\bm u}</span> is straightforward. It is just that instead of a linear system we will have a linear system with additional inequality constraints. Let’s get one <span class="math display">
\begin{aligned}
\operatorname*{minimize}_{\bar{\bm u}} &amp; \quad \frac{1}{2}\bar{\bm u}^T \mathbf H \bar{\bm u} + \mathbf x_0^T\mathbf F^T \bar{\bm u}\\
\text{subject to} &amp;\quad \bar{\bm u} \leq \bar{\mathbf u}^\mathrm{max}\\
               &amp;\quad \bar{\bm u} \geq \bar{\mathbf u}^\mathrm{min},
\end{aligned}
</span> which we can rewrite more explicitly (in the matrix-vector format) as <span class="math display">
\begin{aligned}
\operatorname*{minimize}_{\bar{\bm u}} &amp; \quad \frac{1}{2}\bar{\bm u}^T \mathbf H \bar{\bm u} + \mathbf x_0^T\mathbf F^T \bar{\bm u}\\
\text{subject to} &amp; \begin{bmatrix}
                  \mathbf{I}  &amp;    &amp;         &amp;    \\
                    &amp; \mathbf{I}  &amp;         &amp;    \\
                    &amp;    &amp; \ddots  &amp;    \\
                    &amp;    &amp;         &amp;  \mathbf{I} \\
                    -\mathbf{I}   &amp;   &amp;     &amp;    \\
                    &amp; -\mathbf{I} &amp;         &amp;    \\
                    &amp;    &amp; \ddots  &amp;    \\
                    &amp;    &amp;         &amp;  -\mathbf{I}
                 \end{bmatrix}
                 \begin{bmatrix}
                  \bm u_0 \\ \bm u_1 \\ \vdots \\ \bm u_{N-1}
                 \end{bmatrix}
                 \leq
                 \begin{bmatrix}
                  \mathbf u^\mathbf{max} \\ \mathbf u^\mathrm{max} \\ \vdots \\ \mathbf u^\mathrm{max}\\ -\mathbf u^\mathrm{min} \\ -\mathbf u^\mathrm{min} \\ \vdots \\ -\mathbf u^\mathrm{min}
                 \end{bmatrix}.
\end{aligned}
</span></p>
<div id="exm-direct-sequential-constrained-u" class="theorem example">
<p><span class="theorem-title"><strong>Example 3 (Reformulating the LQR problem with constraints on control as a quadratic program – sequential approach)</strong></span> &nbsp;</p>
<div id="6" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Convex</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">SCS</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">direct_dlqr_sequential</span>(A,B,x₀,Q,R,S,N,(umin,umax))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">size</span>(A)[<span class="fl">1</span>]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="fu">size</span>(B)[<span class="fl">2</span>]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    Q̄ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,N<span class="op">*</span>n),<span class="fu">repeat</span>([n],N),<span class="fu">repeat</span>([n],N))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        Q̄[<span class="fu">Block</span>(i,i)] <span class="op">=</span> Q</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    Q̄[<span class="fu">Block</span>(N,N)] <span class="op">=</span> S</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    R̄ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>m,N<span class="op">*</span>m),<span class="fu">repeat</span>([m],N),<span class="fu">repeat</span>([m],N))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        R̄[<span class="fu">Block</span>(i,i)] <span class="op">=</span> R</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    Ĉ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,N<span class="op">*</span>m),<span class="fu">repeat</span>([n],N),<span class="fu">repeat</span>([m],N))</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    Â <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,n),<span class="fu">repeat</span>([n],N),[n])</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>i</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>            Ĉ[<span class="fu">Block</span>(i,j)] <span class="op">=</span> A<span class="op">^</span>(i<span class="op">-</span>j)<span class="op">*</span>B</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>            Â[<span class="fu">Block</span>(i,<span class="fl">1</span>)] <span class="op">=</span> A<span class="op">^</span>i</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> Ĉ<span class="ch">'*Q̄*Ĉ + R̄</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> <span class="fu">Array</span>(H)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> Ĉ<span class="ch">'*Q̄*Â</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> <span class="fu">Array</span>(F)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    u <span class="op">=</span> <span class="fu">Variable</span>(N<span class="op">*</span>m)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    problem <span class="op">=</span> <span class="fu">minimize</span>(<span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="fu">*quadform</span>(u,H) <span class="op">+</span> <span class="fu">dot</span>(F<span class="op">*</span>x₀,u))</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    problem.constraints <span class="op">=</span> [u <span class="op">&gt;=</span> umin, u <span class="op">&lt;=</span> umax]</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    Convex.<span class="fu">solve!</span>(problem, SCS.Optimizer; silent <span class="op">=</span> <span class="cn">true</span>)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    xopt <span class="op">=</span> Ĉ<span class="op">*</span>u.value <span class="op">+</span> Â<span class="op">*</span>x₀</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    xopt <span class="op">=</span> <span class="fu">reshape</span>(xopt,(<span class="fl">2</span>,<span class="op">:</span>))</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    uopt <span class="op">=</span> u.value</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> xopt,uopt</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="fl">2</span>               <span class="co"># Number of state variables.</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1</span>               <span class="co"># Number of (control) input variables. </span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> <span class="fu">rand</span>(n,n)       <span class="co"># State matrix.</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> <span class="fu">rand</span>(n,m)       <span class="co"># Input coupling matrix.</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>x₀ <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">3.0</span>]     <span class="co"># Initial state.</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">10</span>              <span class="co"># Time horizon.</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">2.0</span>]      </span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">2.0</span>]</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> [<span class="fl">1.0</span>]</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>s)     <span class="co"># Matrix defining the terminal state cost.</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>q)     <span class="co"># Matrix defining the running state dost.</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>r)     <span class="co"># Matrix defining the cost of control.</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>umin <span class="op">=</span> <span class="op">-</span><span class="fl">1.0</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>umax <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>xopt,uopt <span class="op">=</span> <span class="fu">direct_dlqr_sequential</span>(A,B,x₀,Q,R,S,N,(umin,umax))</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> <span class="fu">plot</span>(<span class="fl">0</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>),uopt,marker<span class="op">=:</span>diamond,label<span class="op">=</span><span class="st">"u"</span>,linetype<span class="op">=:</span>steppost)</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel!</span>(<span class="st">"k"</span>)</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel!</span>(<span class="st">"u"</span>)</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> <span class="fu">plot</span>(<span class="fl">0</span><span class="op">:</span>N,<span class="fu">hcat</span>(x₀,xopt)<span class="ch">',marker=:diamond,label=["x₁" "x₂"],linetype=:steppost)</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel!</span>(<span class="st">"k"</span>)</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel!</span>(<span class="st">"x"</span>)</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p1,p2,layout<span class="op">=</span>(<span class="fl">2</span>,<span class="fl">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip810">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip810)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip811">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip810)" d="M293.64 774.117 L2640.76 774.117 L2640.76 47.2441 L293.64 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip812">
    <rect x="293" y="47" width="2348" height="728"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="360.068,774.117 360.068,47.2441 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="852.126,774.117 852.126,47.2441 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1344.18,774.117 1344.18,47.2441 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1836.24,774.117 1836.24,47.2441 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2328.3,774.117 2328.3,47.2441 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,753.595 2640.76,753.595 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,582.056 2640.76,582.056 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,410.518 2640.76,410.518 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,238.979 2640.76,238.979 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,67.4407 2640.76,67.4407 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,774.117 2640.76,774.117 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="360.068,774.117 360.068,755.219 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="852.126,774.117 852.126,755.219 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1344.18,774.117 1344.18,755.219 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1836.24,774.117 1836.24,755.219 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2328.3,774.117 2328.3,755.219 "></polyline>
<path clip-path="url(#clip810)" d="M360.068 807.34 Q356.457 807.34 354.628 810.904 Q352.823 814.446 352.823 821.576 Q352.823 828.682 354.628 832.247 Q356.457 835.789 360.068 835.789 Q363.702 835.789 365.508 832.247 Q367.336 828.682 367.336 821.576 Q367.336 814.446 365.508 810.904 Q363.702 807.34 360.068 807.34 M360.068 803.636 Q365.878 803.636 368.934 808.242 Q372.012 812.826 372.012 821.576 Q372.012 830.303 368.934 834.909 Q365.878 839.492 360.068 839.492 Q354.258 839.492 351.179 834.909 Q348.124 830.303 348.124 821.576 Q348.124 812.826 351.179 808.242 Q354.258 803.636 360.068 803.636 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M846.779 834.886 L863.098 834.886 L863.098 838.821 L841.154 838.821 L841.154 834.886 Q843.816 832.131 848.399 827.502 Q853.005 822.849 854.186 821.506 Q856.431 818.983 857.311 817.247 Q858.214 815.488 858.214 813.798 Q858.214 811.043 856.269 809.307 Q854.348 807.571 851.246 807.571 Q849.047 807.571 846.593 808.335 Q844.163 809.099 841.385 810.65 L841.385 805.928 Q844.209 804.793 846.663 804.215 Q849.117 803.636 851.154 803.636 Q856.524 803.636 859.718 806.321 Q862.913 809.006 862.913 813.497 Q862.913 815.627 862.103 817.548 Q861.316 819.446 859.209 822.039 Q858.63 822.71 855.529 825.928 Q852.427 829.122 846.779 834.886 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1347.19 808.335 L1335.39 826.784 L1347.19 826.784 L1347.19 808.335 M1345.97 804.261 L1351.85 804.261 L1351.85 826.784 L1356.78 826.784 L1356.78 830.673 L1351.85 830.673 L1351.85 838.821 L1347.19 838.821 L1347.19 830.673 L1331.59 830.673 L1331.59 826.159 L1345.97 804.261 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1836.65 819.678 Q1833.5 819.678 1831.65 821.83 Q1829.82 823.983 1829.82 827.733 Q1829.82 831.46 1831.65 833.636 Q1833.5 835.789 1836.65 835.789 Q1839.79 835.789 1841.62 833.636 Q1843.48 831.46 1843.48 827.733 Q1843.48 823.983 1841.62 821.83 Q1839.79 819.678 1836.65 819.678 M1845.93 805.025 L1845.93 809.284 Q1844.17 808.451 1842.36 808.011 Q1840.58 807.571 1838.82 807.571 Q1834.19 807.571 1831.74 810.696 Q1829.31 813.821 1828.96 820.141 Q1830.33 818.127 1832.39 817.062 Q1834.45 815.974 1836.92 815.974 Q1842.13 815.974 1845.14 819.145 Q1848.17 822.293 1848.17 827.733 Q1848.17 833.057 1845.03 836.275 Q1841.88 839.492 1836.65 839.492 Q1830.65 839.492 1827.48 834.909 Q1824.31 830.303 1824.31 821.576 Q1824.31 813.381 1828.2 808.52 Q1832.09 803.636 1838.64 803.636 Q1840.4 803.636 1842.18 803.983 Q1843.98 804.33 1845.93 805.025 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2328.3 822.409 Q2324.97 822.409 2323.04 824.191 Q2321.15 825.974 2321.15 829.099 Q2321.15 832.224 2323.04 834.006 Q2324.97 835.789 2328.3 835.789 Q2331.63 835.789 2333.55 834.006 Q2335.48 832.201 2335.48 829.099 Q2335.48 825.974 2333.55 824.191 Q2331.66 822.409 2328.3 822.409 M2323.62 820.418 Q2320.61 819.678 2318.92 817.617 Q2317.26 815.557 2317.26 812.594 Q2317.26 808.451 2320.2 806.043 Q2323.16 803.636 2328.3 803.636 Q2333.46 803.636 2336.4 806.043 Q2339.34 808.451 2339.34 812.594 Q2339.34 815.557 2337.65 817.617 Q2335.98 819.678 2333 820.418 Q2336.38 821.205 2338.25 823.497 Q2340.15 825.789 2340.15 829.099 Q2340.15 834.122 2337.07 836.807 Q2334.02 839.492 2328.3 839.492 Q2322.58 839.492 2319.5 836.807 Q2316.45 834.122 2316.45 829.099 Q2316.45 825.789 2318.35 823.497 Q2320.24 821.205 2323.62 820.418 M2321.91 813.034 Q2321.91 815.719 2323.58 817.224 Q2325.27 818.729 2328.3 818.729 Q2331.31 818.729 2333 817.224 Q2334.71 815.719 2334.71 813.034 Q2334.71 810.349 2333 808.844 Q2331.31 807.34 2328.3 807.34 Q2325.27 807.34 2323.58 808.844 Q2321.91 810.349 2321.91 813.034 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1451.38 873.776 L1457.27 873.776 L1457.27 903.026 L1474.74 887.653 L1482.22 887.653 L1463.31 904.331 L1483.02 923.301 L1475.38 923.301 L1457.27 905.891 L1457.27 923.301 L1451.38 923.301 L1451.38 873.776 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,774.117 293.64,47.2441 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,753.595 312.538,753.595 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,582.056 312.538,582.056 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,410.518 312.538,410.518 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,238.979 312.538,238.979 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,67.4407 312.538,67.4407 "></polyline>
<path clip-path="url(#clip810)" d="M116.214 754.046 L145.89 754.046 L145.89 757.981 L116.214 757.981 L116.214 754.046 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M156.793 766.939 L164.432 766.939 L164.432 740.574 L156.122 742.24 L156.122 737.981 L164.385 736.315 L169.061 736.315 L169.061 766.939 L176.7 766.939 L176.7 770.875 L156.793 770.875 L156.793 766.939 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M186.145 764.995 L191.029 764.995 L191.029 770.875 L186.145 770.875 L186.145 764.995 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M211.214 739.393 Q207.603 739.393 205.774 742.958 Q203.969 746.5 203.969 753.629 Q203.969 760.736 205.774 764.301 Q207.603 767.842 211.214 767.842 Q214.848 767.842 216.654 764.301 Q218.482 760.736 218.482 753.629 Q218.482 746.5 216.654 742.958 Q214.848 739.393 211.214 739.393 M211.214 735.69 Q217.024 735.69 220.08 740.296 Q223.158 744.879 223.158 753.629 Q223.158 762.356 220.08 766.963 Q217.024 771.546 211.214 771.546 Q205.404 771.546 202.325 766.963 Q199.27 762.356 199.27 753.629 Q199.27 744.879 202.325 740.296 Q205.404 735.69 211.214 735.69 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M241.376 739.393 Q237.765 739.393 235.936 742.958 Q234.13 746.5 234.13 753.629 Q234.13 760.736 235.936 764.301 Q237.765 767.842 241.376 767.842 Q245.01 767.842 246.816 764.301 Q248.644 760.736 248.644 753.629 Q248.644 746.5 246.816 742.958 Q245.01 739.393 241.376 739.393 M241.376 735.69 Q247.186 735.69 250.242 740.296 Q253.32 744.879 253.32 753.629 Q253.32 762.356 250.242 766.963 Q247.186 771.546 241.376 771.546 Q235.566 771.546 232.487 766.963 Q229.431 762.356 229.431 753.629 Q229.431 744.879 232.487 740.296 Q235.566 735.69 241.376 735.69 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M117.21 582.507 L146.886 582.507 L146.886 586.443 L117.21 586.443 L117.21 582.507 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M166.978 567.855 Q163.367 567.855 161.538 571.42 Q159.733 574.961 159.733 582.091 Q159.733 589.197 161.538 592.762 Q163.367 596.304 166.978 596.304 Q170.612 596.304 172.418 592.762 Q174.247 589.197 174.247 582.091 Q174.247 574.961 172.418 571.42 Q170.612 567.855 166.978 567.855 M166.978 564.151 Q172.788 564.151 175.844 568.758 Q178.922 573.341 178.922 582.091 Q178.922 590.818 175.844 595.424 Q172.788 600.007 166.978 600.007 Q161.168 600.007 158.089 595.424 Q155.034 590.818 155.034 582.091 Q155.034 573.341 158.089 568.758 Q161.168 564.151 166.978 564.151 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M187.14 593.456 L192.024 593.456 L192.024 599.336 L187.14 599.336 L187.14 593.456 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M201.029 564.776 L223.251 564.776 L223.251 566.767 L210.705 599.336 L205.82 599.336 L217.626 568.711 L201.029 568.711 L201.029 564.776 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M232.418 564.776 L250.774 564.776 L250.774 568.711 L236.7 568.711 L236.7 577.183 Q237.718 576.836 238.737 576.674 Q239.755 576.489 240.774 576.489 Q246.561 576.489 249.941 579.66 Q253.32 582.832 253.32 588.248 Q253.32 593.827 249.848 596.929 Q246.376 600.007 240.056 600.007 Q237.88 600.007 235.612 599.637 Q233.367 599.267 230.959 598.526 L230.959 593.827 Q233.043 594.961 235.265 595.517 Q237.487 596.072 239.964 596.072 Q243.968 596.072 246.306 593.966 Q248.644 591.859 248.644 588.248 Q248.644 584.637 246.306 582.531 Q243.968 580.424 239.964 580.424 Q238.089 580.424 236.214 580.841 Q234.362 581.257 232.418 582.137 L232.418 564.776 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M116.214 410.969 L145.89 410.969 L145.89 414.904 L116.214 414.904 L116.214 410.969 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M165.983 396.316 Q162.372 396.316 160.543 399.881 Q158.737 403.423 158.737 410.552 Q158.737 417.659 160.543 421.224 Q162.372 424.765 165.983 424.765 Q169.617 424.765 171.422 421.224 Q173.251 417.659 173.251 410.552 Q173.251 403.423 171.422 399.881 Q169.617 396.316 165.983 396.316 M165.983 392.613 Q171.793 392.613 174.848 397.219 Q177.927 401.802 177.927 410.552 Q177.927 419.279 174.848 423.886 Q171.793 428.469 165.983 428.469 Q160.173 428.469 157.094 423.886 Q154.038 419.279 154.038 410.552 Q154.038 401.802 157.094 397.219 Q160.173 392.613 165.983 392.613 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M186.145 421.918 L191.029 421.918 L191.029 427.798 L186.145 427.798 L186.145 421.918 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M201.26 393.238 L219.617 393.238 L219.617 397.173 L205.543 397.173 L205.543 405.645 Q206.561 405.298 207.58 405.136 Q208.598 404.951 209.617 404.951 Q215.404 404.951 218.783 408.122 Q222.163 411.293 222.163 416.71 Q222.163 422.288 218.691 425.39 Q215.219 428.469 208.899 428.469 Q206.723 428.469 204.455 428.099 Q202.209 427.728 199.802 426.987 L199.802 422.288 Q201.885 423.423 204.107 423.978 Q206.33 424.534 208.807 424.534 Q212.811 424.534 215.149 422.427 Q217.487 420.321 217.487 416.71 Q217.487 413.099 215.149 410.992 Q212.811 408.886 208.807 408.886 Q206.932 408.886 205.057 409.302 Q203.205 409.719 201.26 410.599 L201.26 393.238 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M241.376 396.316 Q237.765 396.316 235.936 399.881 Q234.13 403.423 234.13 410.552 Q234.13 417.659 235.936 421.224 Q237.765 424.765 241.376 424.765 Q245.01 424.765 246.816 421.224 Q248.644 417.659 248.644 410.552 Q248.644 403.423 246.816 399.881 Q245.01 396.316 241.376 396.316 M241.376 392.613 Q247.186 392.613 250.242 397.219 Q253.32 401.802 253.32 410.552 Q253.32 419.279 250.242 423.886 Q247.186 428.469 241.376 428.469 Q235.566 428.469 232.487 423.886 Q229.431 419.279 229.431 410.552 Q229.431 401.802 232.487 397.219 Q235.566 392.613 241.376 392.613 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M117.21 239.431 L146.886 239.431 L146.886 243.366 L117.21 243.366 L117.21 239.431 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M166.978 224.778 Q163.367 224.778 161.538 228.343 Q159.733 231.884 159.733 239.014 Q159.733 246.12 161.538 249.685 Q163.367 253.227 166.978 253.227 Q170.612 253.227 172.418 249.685 Q174.247 246.12 174.247 239.014 Q174.247 231.884 172.418 228.343 Q170.612 224.778 166.978 224.778 M166.978 221.074 Q172.788 221.074 175.844 225.681 Q178.922 230.264 178.922 239.014 Q178.922 247.741 175.844 252.347 Q172.788 256.93 166.978 256.93 Q161.168 256.93 158.089 252.347 Q155.034 247.741 155.034 239.014 Q155.034 230.264 158.089 225.681 Q161.168 221.074 166.978 221.074 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M187.14 250.38 L192.024 250.38 L192.024 256.259 L187.14 256.259 L187.14 250.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M206.237 252.324 L222.556 252.324 L222.556 256.259 L200.612 256.259 L200.612 252.324 Q203.274 249.569 207.857 244.94 Q212.464 240.287 213.644 238.944 Q215.89 236.421 216.769 234.685 Q217.672 232.926 217.672 231.236 Q217.672 228.482 215.728 226.745 Q213.807 225.009 210.705 225.009 Q208.506 225.009 206.052 225.773 Q203.621 226.537 200.844 228.088 L200.844 223.366 Q203.668 222.232 206.121 221.653 Q208.575 221.074 210.612 221.074 Q215.982 221.074 219.177 223.759 Q222.371 226.444 222.371 230.935 Q222.371 233.065 221.561 234.986 Q220.774 236.884 218.668 239.477 Q218.089 240.148 214.987 243.366 Q211.885 246.56 206.237 252.324 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M232.418 221.699 L250.774 221.699 L250.774 225.634 L236.7 225.634 L236.7 234.106 Q237.718 233.759 238.737 233.597 Q239.755 233.412 240.774 233.412 Q246.561 233.412 249.941 236.583 Q253.32 239.755 253.32 245.171 Q253.32 250.75 249.848 253.852 Q246.376 256.93 240.056 256.93 Q237.88 256.93 235.612 256.56 Q233.367 256.19 230.959 255.449 L230.959 250.75 Q233.043 251.884 235.265 252.44 Q237.487 252.995 239.964 252.995 Q243.968 252.995 246.306 250.889 Q248.644 248.782 248.644 245.171 Q248.644 241.56 246.306 239.454 Q243.968 237.347 239.964 237.347 Q238.089 237.347 236.214 237.764 Q234.362 238.181 232.418 239.06 L232.418 221.699 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M165.983 53.2394 Q162.372 53.2394 160.543 56.8042 Q158.737 60.3458 158.737 67.4754 Q158.737 74.5819 160.543 78.1467 Q162.372 81.6883 165.983 81.6883 Q169.617 81.6883 171.422 78.1467 Q173.251 74.5819 173.251 67.4754 Q173.251 60.3458 171.422 56.8042 Q169.617 53.2394 165.983 53.2394 M165.983 49.5357 Q171.793 49.5357 174.848 54.1422 Q177.927 58.7255 177.927 67.4754 Q177.927 76.2022 174.848 80.8087 Q171.793 85.392 165.983 85.392 Q160.173 85.392 157.094 80.8087 Q154.038 76.2022 154.038 67.4754 Q154.038 58.7255 157.094 54.1422 Q160.173 49.5357 165.983 49.5357 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M186.145 78.8411 L191.029 78.8411 L191.029 84.7207 L186.145 84.7207 L186.145 78.8411 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M211.214 53.2394 Q207.603 53.2394 205.774 56.8042 Q203.969 60.3458 203.969 67.4754 Q203.969 74.5819 205.774 78.1467 Q207.603 81.6883 211.214 81.6883 Q214.848 81.6883 216.654 78.1467 Q218.482 74.5819 218.482 67.4754 Q218.482 60.3458 216.654 56.8042 Q214.848 53.2394 211.214 53.2394 M211.214 49.5357 Q217.024 49.5357 220.08 54.1422 Q223.158 58.7255 223.158 67.4754 Q223.158 76.2022 220.08 80.8087 Q217.024 85.392 211.214 85.392 Q205.404 85.392 202.325 80.8087 Q199.27 76.2022 199.27 67.4754 Q199.27 58.7255 202.325 54.1422 Q205.404 49.5357 211.214 49.5357 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M241.376 53.2394 Q237.765 53.2394 235.936 56.8042 Q234.13 60.3458 234.13 67.4754 Q234.13 74.5819 235.936 78.1467 Q237.765 81.6883 241.376 81.6883 Q245.01 81.6883 246.816 78.1467 Q248.644 74.5819 248.644 67.4754 Q248.644 60.3458 246.816 56.8042 Q245.01 53.2394 241.376 53.2394 M241.376 49.5357 Q247.186 49.5357 250.242 54.1422 Q253.32 58.7255 253.32 67.4754 Q253.32 76.2022 250.242 80.8087 Q247.186 85.392 241.376 85.392 Q235.566 85.392 232.487 80.8087 Q229.431 76.2022 229.431 67.4754 Q229.431 58.7255 232.487 54.1422 Q235.566 49.5357 241.376 49.5357 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M47.5702 425.608 L25.9905 425.608 L25.9905 419.752 L47.3474 419.752 Q52.4082 419.752 54.9545 417.778 Q57.4689 415.805 57.4689 411.858 Q57.4689 407.116 54.4452 404.378 Q51.4215 401.609 46.2016 401.609 L25.9905 401.609 L25.9905 395.753 L61.6384 395.753 L61.6384 401.609 L56.1639 401.609 Q59.4104 403.742 61.0019 406.575 Q62.5615 409.376 62.5615 413.1 Q62.5615 419.242 58.742 422.425 Q54.9226 425.608 47.5702 425.608 M25.1311 410.872 L25.1311 410.872 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip812)" d="M360.068 737.545 L344.068 753.545 L360.068 769.545 L376.068 753.545 L360.068 737.545 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M606.097 737.531 L590.097 753.531 L606.097 769.531 L622.097 753.531 L606.097 737.531 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M852.126 737.536 L836.126 753.536 L852.126 769.536 L868.126 753.536 L852.126 737.536 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M1098.15 583.52 L1082.15 599.52 L1098.15 615.52 L1114.15 599.52 L1098.15 583.52 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M1344.18 209.109 L1328.18 225.109 L1344.18 241.109 L1360.18 225.109 L1344.18 209.109 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M1590.21 98.6801 L1574.21 114.68 L1590.21 130.68 L1606.21 114.68 L1590.21 98.6801 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M1836.24 65.7414 L1820.24 81.7414 L1836.24 97.7414 L1852.24 81.7414 L1836.24 65.7414 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M2082.27 55.8081 L2066.27 71.8081 L2082.27 87.8081 L2098.27 71.8081 L2082.27 55.8081 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M2328.3 52.7746 L2312.3 68.7746 L2328.3 84.7746 L2344.3 68.7746 L2328.3 52.7746 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M2574.33 51.816 L2558.33 67.816 L2574.33 83.816 L2590.33 67.816 L2574.33 51.816 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip812)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="360.068,753.545 606.097,753.545 606.097,753.531 852.126,753.531 852.126,753.536 1098.15,753.536 1098.15,599.52 1344.18,599.52 1344.18,225.109 1590.21,225.109 1590.21,114.68 1836.24,114.68 1836.24,81.7414 2082.27,81.7414 2082.27,71.8081 2328.3,71.8081 2328.3,68.7746 2574.33,68.7746 2574.33,67.816 "></polyline>
<path clip-path="url(#clip810)" d="M371.877 175.153 L628.302 175.153 L628.302 71.4732 L371.877 71.4732  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="371.877,175.153 628.302,175.153 628.302,71.4732 371.877,71.4732 371.877,175.153 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="397.956,123.313 554.431,123.313 "></polyline>
<path clip-path="url(#clip810)" d="M580.51 130.362 L580.51 114.667 L584.769 114.667 L584.769 130.2 Q584.769 133.88 586.204 135.732 Q587.639 137.561 590.51 137.561 Q593.959 137.561 595.95 135.362 Q597.963 133.163 597.963 129.366 L597.963 114.667 L602.223 114.667 L602.223 140.593 L597.963 140.593 L597.963 136.612 Q596.413 138.973 594.352 140.13 Q592.315 141.264 589.607 141.264 Q585.139 141.264 582.825 138.487 Q580.51 135.709 580.51 130.362 M591.227 114.042 L591.227 114.042 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M293.64 1734.12 L2640.76 1734.12 L2640.76 1007.24 L293.64 1007.24  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip813">
    <rect x="293" y="1007" width="2348" height="728"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="360.068,1734.12 360.068,1007.24 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="913.633,1734.12 913.633,1007.24 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1467.2,1734.12 1467.2,1007.24 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2020.76,1734.12 2020.76,1007.24 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2574.33,1734.12 2574.33,1007.24 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,1705.69 2640.76,1705.69 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,1479.73 2640.76,1479.73 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,1253.77 2640.76,1253.77 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,1027.82 2640.76,1027.82 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,1734.12 2640.76,1734.12 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="360.068,1734.12 360.068,1715.22 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="913.633,1734.12 913.633,1715.22 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1467.2,1734.12 1467.2,1715.22 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2020.76,1734.12 2020.76,1715.22 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2574.33,1734.12 2574.33,1715.22 "></polyline>
<path clip-path="url(#clip810)" d="M337.452 1767.34 Q333.841 1767.34 332.013 1770.9 Q330.207 1774.45 330.207 1781.58 Q330.207 1788.68 332.013 1792.25 Q333.841 1795.79 337.452 1795.79 Q341.087 1795.79 342.892 1792.25 Q344.721 1788.68 344.721 1781.58 Q344.721 1774.45 342.892 1770.9 Q341.087 1767.34 337.452 1767.34 M337.452 1763.64 Q343.263 1763.64 346.318 1768.24 Q349.397 1772.83 349.397 1781.58 Q349.397 1790.3 346.318 1794.91 Q343.263 1799.49 337.452 1799.49 Q331.642 1799.49 328.564 1794.91 Q325.508 1790.3 325.508 1781.58 Q325.508 1772.83 328.564 1768.24 Q331.642 1763.64 337.452 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M357.614 1792.94 L362.499 1792.94 L362.499 1798.82 L357.614 1798.82 L357.614 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M382.684 1767.34 Q379.073 1767.34 377.244 1770.9 Q375.438 1774.45 375.438 1781.58 Q375.438 1788.68 377.244 1792.25 Q379.073 1795.79 382.684 1795.79 Q386.318 1795.79 388.123 1792.25 Q389.952 1788.68 389.952 1781.58 Q389.952 1774.45 388.123 1770.9 Q386.318 1767.34 382.684 1767.34 M382.684 1763.64 Q388.494 1763.64 391.549 1768.24 Q394.628 1772.83 394.628 1781.58 Q394.628 1790.3 391.549 1794.91 Q388.494 1799.49 382.684 1799.49 Q376.873 1799.49 373.795 1794.91 Q370.739 1790.3 370.739 1781.58 Q370.739 1772.83 373.795 1768.24 Q376.873 1763.64 382.684 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M885.369 1794.89 L901.689 1794.89 L901.689 1798.82 L879.744 1798.82 L879.744 1794.89 Q882.406 1792.13 886.99 1787.5 Q891.596 1782.85 892.777 1781.51 Q895.022 1778.98 895.902 1777.25 Q896.804 1775.49 896.804 1773.8 Q896.804 1771.04 894.86 1769.31 Q892.939 1767.57 889.837 1767.57 Q887.638 1767.57 885.184 1768.34 Q882.754 1769.1 879.976 1770.65 L879.976 1765.93 Q882.8 1764.79 885.254 1764.21 Q887.707 1763.64 889.744 1763.64 Q895.115 1763.64 898.309 1766.32 Q901.503 1769.01 901.503 1773.5 Q901.503 1775.63 900.693 1777.55 Q899.906 1779.45 897.8 1782.04 Q897.221 1782.71 894.119 1785.93 Q891.017 1789.12 885.369 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M911.503 1792.94 L916.388 1792.94 L916.388 1798.82 L911.503 1798.82 L911.503 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M926.619 1764.26 L944.975 1764.26 L944.975 1768.2 L930.901 1768.2 L930.901 1776.67 Q931.92 1776.32 932.938 1776.16 Q933.957 1775.97 934.975 1775.97 Q940.763 1775.97 944.142 1779.15 Q947.522 1782.32 947.522 1787.73 Q947.522 1793.31 944.05 1796.41 Q940.577 1799.49 934.258 1799.49 Q932.082 1799.49 929.813 1799.12 Q927.568 1798.75 925.161 1798.01 L925.161 1793.31 Q927.244 1794.45 929.466 1795 Q931.688 1795.56 934.165 1795.56 Q938.17 1795.56 940.508 1793.45 Q942.846 1791.34 942.846 1787.73 Q942.846 1784.12 940.508 1782.02 Q938.17 1779.91 934.165 1779.91 Q932.29 1779.91 930.415 1780.33 Q928.563 1780.74 926.619 1781.62 L926.619 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1434.36 1764.26 L1452.72 1764.26 L1452.72 1768.2 L1438.64 1768.2 L1438.64 1776.67 Q1439.66 1776.32 1440.68 1776.16 Q1441.7 1775.97 1442.72 1775.97 Q1448.51 1775.97 1451.89 1779.15 Q1455.27 1782.32 1455.27 1787.73 Q1455.27 1793.31 1451.79 1796.41 Q1448.32 1799.49 1442 1799.49 Q1439.83 1799.49 1437.56 1799.12 Q1435.31 1798.75 1432.9 1798.01 L1432.9 1793.31 Q1434.99 1794.45 1437.21 1795 Q1439.43 1795.56 1441.91 1795.56 Q1445.91 1795.56 1448.25 1793.45 Q1450.59 1791.34 1450.59 1787.73 Q1450.59 1784.12 1448.25 1782.02 Q1445.91 1779.91 1441.91 1779.91 Q1440.03 1779.91 1438.16 1780.33 Q1436.31 1780.74 1434.36 1781.62 L1434.36 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1464.48 1792.94 L1469.36 1792.94 L1469.36 1798.82 L1464.48 1798.82 L1464.48 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1489.55 1767.34 Q1485.94 1767.34 1484.11 1770.9 Q1482.3 1774.45 1482.3 1781.58 Q1482.3 1788.68 1484.11 1792.25 Q1485.94 1795.79 1489.55 1795.79 Q1493.18 1795.79 1494.99 1792.25 Q1496.82 1788.68 1496.82 1781.58 Q1496.82 1774.45 1494.99 1770.9 Q1493.18 1767.34 1489.55 1767.34 M1489.55 1763.64 Q1495.36 1763.64 1498.41 1768.24 Q1501.49 1772.83 1501.49 1781.58 Q1501.49 1790.3 1498.41 1794.91 Q1495.36 1799.49 1489.55 1799.49 Q1483.74 1799.49 1480.66 1794.91 Q1477.6 1790.3 1477.6 1781.58 Q1477.6 1772.83 1480.66 1768.24 Q1483.74 1763.64 1489.55 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1987.08 1764.26 L2009.3 1764.26 L2009.3 1766.25 L1996.76 1798.82 L1991.87 1798.82 L2003.68 1768.2 L1987.08 1768.2 L1987.08 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2018.43 1792.94 L2023.31 1792.94 L2023.31 1798.82 L2018.43 1798.82 L2018.43 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2033.54 1764.26 L2051.9 1764.26 L2051.9 1768.2 L2037.82 1768.2 L2037.82 1776.67 Q2038.84 1776.32 2039.86 1776.16 Q2040.88 1775.97 2041.9 1775.97 Q2047.68 1775.97 2051.06 1779.15 Q2054.44 1782.32 2054.44 1787.73 Q2054.44 1793.31 2050.97 1796.41 Q2047.5 1799.49 2041.18 1799.49 Q2039 1799.49 2036.74 1799.12 Q2034.49 1798.75 2032.08 1798.01 L2032.08 1793.31 Q2034.17 1794.45 2036.39 1795 Q2038.61 1795.56 2041.09 1795.56 Q2045.09 1795.56 2047.43 1793.45 Q2049.77 1791.34 2049.77 1787.73 Q2049.77 1784.12 2047.43 1782.02 Q2045.09 1779.91 2041.09 1779.91 Q2039.21 1779.91 2037.34 1780.33 Q2035.49 1780.74 2033.54 1781.62 L2033.54 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2526.4 1794.89 L2534.04 1794.89 L2534.04 1768.52 L2525.73 1770.19 L2525.73 1765.93 L2533.99 1764.26 L2538.67 1764.26 L2538.67 1794.89 L2546.31 1794.89 L2546.31 1798.82 L2526.4 1798.82 L2526.4 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2565.75 1767.34 Q2562.14 1767.34 2560.31 1770.9 Q2558.51 1774.45 2558.51 1781.58 Q2558.51 1788.68 2560.31 1792.25 Q2562.14 1795.79 2565.75 1795.79 Q2569.39 1795.79 2571.19 1792.25 Q2573.02 1788.68 2573.02 1781.58 Q2573.02 1774.45 2571.19 1770.9 Q2569.39 1767.34 2565.75 1767.34 M2565.75 1763.64 Q2571.56 1763.64 2574.62 1768.24 Q2577.7 1772.83 2577.7 1781.58 Q2577.7 1790.3 2574.62 1794.91 Q2571.56 1799.49 2565.75 1799.49 Q2559.94 1799.49 2556.86 1794.91 Q2553.81 1790.3 2553.81 1781.58 Q2553.81 1772.83 2556.86 1768.24 Q2559.94 1763.64 2565.75 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2585.91 1792.94 L2590.8 1792.94 L2590.8 1798.82 L2585.91 1798.82 L2585.91 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2610.98 1767.34 Q2607.37 1767.34 2605.54 1770.9 Q2603.74 1774.45 2603.74 1781.58 Q2603.74 1788.68 2605.54 1792.25 Q2607.37 1795.79 2610.98 1795.79 Q2614.62 1795.79 2616.42 1792.25 Q2618.25 1788.68 2618.25 1781.58 Q2618.25 1774.45 2616.42 1770.9 Q2614.62 1767.34 2610.98 1767.34 M2610.98 1763.64 Q2616.79 1763.64 2619.85 1768.24 Q2622.93 1772.83 2622.93 1781.58 Q2622.93 1790.3 2619.85 1794.91 Q2616.79 1799.49 2610.98 1799.49 Q2605.17 1799.49 2602.09 1794.91 Q2599.04 1790.3 2599.04 1781.58 Q2599.04 1772.83 2602.09 1768.24 Q2605.17 1763.64 2610.98 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1451.38 1833.78 L1457.27 1833.78 L1457.27 1863.03 L1474.74 1847.65 L1482.22 1847.65 L1463.31 1864.33 L1483.02 1883.3 L1475.38 1883.3 L1457.27 1865.89 L1457.27 1883.3 L1451.38 1883.3 L1451.38 1833.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,1734.12 293.64,1007.24 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,1705.69 312.538,1705.69 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,1479.73 312.538,1479.73 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,1253.77 312.538,1253.77 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,1027.82 312.538,1027.82 "></polyline>
<path clip-path="url(#clip810)" d="M241.376 1691.49 Q237.765 1691.49 235.936 1695.05 Q234.13 1698.59 234.13 1705.72 Q234.13 1712.83 235.936 1716.39 Q237.765 1719.94 241.376 1719.94 Q245.01 1719.94 246.816 1716.39 Q248.644 1712.83 248.644 1705.72 Q248.644 1698.59 246.816 1695.05 Q245.01 1691.49 241.376 1691.49 M241.376 1687.78 Q247.186 1687.78 250.242 1692.39 Q253.32 1696.97 253.32 1705.72 Q253.32 1714.45 250.242 1719.06 Q247.186 1723.64 241.376 1723.64 Q235.566 1723.64 232.487 1719.06 Q229.431 1714.45 229.431 1705.72 Q229.431 1696.97 232.487 1692.39 Q235.566 1687.78 241.376 1687.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M233.413 1493.08 L241.052 1493.08 L241.052 1466.71 L232.742 1468.38 L232.742 1464.12 L241.005 1462.45 L245.681 1462.45 L245.681 1493.08 L253.32 1493.08 L253.32 1497.01 L233.413 1497.01 L233.413 1493.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M237.001 1267.12 L253.32 1267.12 L253.32 1271.05 L231.376 1271.05 L231.376 1267.12 Q234.038 1264.36 238.621 1259.73 Q243.228 1255.08 244.408 1253.74 Q246.654 1251.22 247.533 1249.48 Q248.436 1247.72 248.436 1246.03 Q248.436 1243.28 246.492 1241.54 Q244.57 1239.8 241.468 1239.8 Q239.269 1239.8 236.816 1240.57 Q234.385 1241.33 231.607 1242.88 L231.607 1238.16 Q234.431 1237.03 236.885 1236.45 Q239.339 1235.87 241.376 1235.87 Q246.746 1235.87 249.941 1238.55 Q253.135 1241.24 253.135 1245.73 Q253.135 1247.86 252.325 1249.78 Q251.538 1251.68 249.431 1254.27 Q248.853 1254.94 245.751 1258.16 Q242.649 1261.35 237.001 1267.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M246.191 1026.46 Q249.547 1027.18 251.422 1029.45 Q253.32 1031.72 253.32 1035.05 Q253.32 1040.17 249.802 1042.97 Q246.283 1045.77 239.802 1045.77 Q237.626 1045.77 235.311 1045.33 Q233.019 1044.91 230.566 1044.05 L230.566 1039.54 Q232.51 1040.67 234.825 1041.25 Q237.14 1041.83 239.663 1041.83 Q244.061 1041.83 246.353 1040.1 Q248.667 1038.36 248.667 1035.05 Q248.667 1031.99 246.515 1030.28 Q244.385 1028.55 240.566 1028.55 L236.538 1028.55 L236.538 1024.7 L240.751 1024.7 Q244.2 1024.7 246.029 1023.34 Q247.857 1021.95 247.857 1019.36 Q247.857 1016.69 245.959 1015.28 Q244.084 1013.85 240.566 1013.85 Q238.644 1013.85 236.445 1014.26 Q234.246 1014.68 231.607 1015.56 L231.607 1011.39 Q234.269 1010.65 236.584 1010.28 Q238.922 1009.91 240.982 1009.91 Q246.306 1009.91 249.408 1012.34 Q252.51 1014.75 252.51 1018.87 Q252.51 1021.74 250.866 1023.73 Q249.223 1025.7 246.191 1026.46 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M139.207 1354.07 L156.554 1366.96 L174.855 1353.4 L174.855 1360.3 L160.851 1370.68 L174.855 1381.06 L174.855 1387.96 L156.204 1374.12 L139.207 1386.79 L139.207 1379.88 L151.907 1370.43 L139.207 1360.97 L139.207 1354.07 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip813)" d="M360.068 1463.73 L344.068 1479.73 L360.068 1495.73 L376.068 1479.73 L360.068 1463.73 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M581.494 1421.4 L565.494 1437.4 L581.494 1453.4 L597.494 1437.4 L581.494 1421.4 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M802.92 1488.56 L786.92 1504.56 L802.92 1520.56 L818.92 1504.56 L802.92 1488.56 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1024.35 1598.44 L1008.35 1614.44 L1024.35 1630.44 L1040.35 1614.44 L1024.35 1598.44 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1245.77 1689.69 L1229.77 1705.69 L1245.77 1721.69 L1261.77 1705.69 L1245.77 1689.69 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1467.2 1697.55 L1451.2 1713.55 L1467.2 1729.55 L1483.2 1713.55 L1467.2 1697.55 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1688.62 1694.4 L1672.62 1710.4 L1688.62 1726.4 L1704.62 1710.4 L1688.62 1694.4 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1910.05 1691.9 L1894.05 1707.9 L1910.05 1723.9 L1926.05 1707.9 L1910.05 1691.9 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M2131.48 1690.72 L2115.48 1706.72 L2131.48 1722.72 L2147.48 1706.72 L2131.48 1690.72 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M2352.9 1690.25 L2336.9 1706.25 L2352.9 1722.25 L2368.9 1706.25 L2352.9 1690.25 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M2574.33 1690.09 L2558.33 1706.09 L2574.33 1722.09 L2590.33 1706.09 L2574.33 1690.09 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip813)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="360.068,1479.73 581.494,1479.73 581.494,1437.4 802.92,1437.4 802.92,1504.56 1024.35,1504.56 1024.35,1614.44 1245.77,1614.44 1245.77,1705.69 1467.2,1705.69 1467.2,1713.55 1688.62,1713.55 1688.62,1710.4 1910.05,1710.4 1910.05,1707.9 2131.48,1707.9 2131.48,1706.72 2352.9,1706.72 2352.9,1706.25 2574.33,1706.25 2574.33,1706.09 "></polyline>
<path clip-path="url(#clip813)" d="M360.068 1011.82 L344.068 1027.82 L360.068 1043.82 L376.068 1027.82 L360.068 1011.82 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M581.494 1188.24 L565.494 1204.24 L581.494 1220.24 L597.494 1204.24 L581.494 1188.24 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M802.92 1336.04 L786.92 1352.04 L802.92 1368.04 L818.92 1352.04 L802.92 1336.04 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1024.35 1488.42 L1008.35 1504.42 L1024.35 1520.42 L1040.35 1504.42 L1024.35 1488.42 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1245.77 1617.65 L1229.77 1633.65 L1245.77 1649.65 L1261.77 1633.65 L1245.77 1617.65 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1467.2 1664.65 L1451.2 1680.65 L1467.2 1696.65 L1483.2 1680.65 L1467.2 1664.65 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1688.62 1681.25 L1672.62 1697.25 L1688.62 1713.25 L1704.62 1697.25 L1688.62 1681.25 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1910.05 1687.01 L1894.05 1703.01 L1910.05 1719.01 L1926.05 1703.01 L1910.05 1687.01 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M2131.48 1688.99 L2115.48 1704.99 L2131.48 1720.99 L2147.48 1704.99 L2131.48 1688.99 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M2352.9 1689.69 L2336.9 1705.69 L2352.9 1721.69 L2368.9 1705.69 L2352.9 1689.69 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M2574.33 1689.94 L2558.33 1705.94 L2574.33 1721.94 L2590.33 1705.94 L2574.33 1689.94 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip813)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="360.068,1027.82 581.494,1027.82 581.494,1204.24 802.92,1204.24 802.92,1352.04 1024.35,1352.04 1024.35,1504.42 1245.77,1504.42 1245.77,1633.65 1467.2,1633.65 1467.2,1680.65 1688.62,1680.65 1688.62,1697.25 1910.05,1697.25 1910.05,1703.01 2131.48,1703.01 2131.48,1704.99 2352.9,1704.99 2352.9,1705.69 2574.33,1705.69 2574.33,1705.94 "></polyline>
<path clip-path="url(#clip810)" d="M2284.71 1186.99 L2562.52 1186.99 L2562.52 1031.47 L2284.71 1031.47  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2284.71,1186.99 2562.52,1186.99 2562.52,1031.47 2284.71,1031.47 2284.71,1186.99 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2310.78,1083.31 2467.26,1083.31 "></polyline>
<path clip-path="url(#clip810)" d="M2517.99 1074.67 L2508.62 1087.28 L2518.48 1100.59 L2513.45 1100.59 L2505.91 1090.41 L2498.36 1100.59 L2493.34 1100.59 L2503.41 1087.03 L2494.19 1074.67 L2499.22 1074.67 L2506.09 1083.9 L2512.97 1074.67 L2517.99 1074.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2523.64 1098.05 L2528.36 1098.05 L2528.36 1083.9 L2523.2 1084.85 L2523.2 1082.17 L2528.52 1081.26 L2531.69 1081.26 L2531.69 1098.05 L2536.44 1098.05 L2536.44 1100.59 L2523.64 1100.59 L2523.64 1098.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip810)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2310.78,1135.15 2467.26,1135.15 "></polyline>
<path clip-path="url(#clip810)" d="M2517.99 1126.51 L2508.62 1139.12 L2518.48 1152.43 L2513.45 1152.43 L2505.91 1142.25 L2498.36 1152.43 L2493.34 1152.43 L2503.41 1138.87 L2494.19 1126.51 L2499.22 1126.51 L2506.09 1135.74 L2512.97 1126.51 L2517.99 1126.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2526.23 1149.79 L2536.05 1149.79 L2536.05 1152.43 L2522.2 1152.43 L2522.2 1149.89 Q2522.99 1149.17 2524.45 1147.87 Q2532.41 1140.81 2532.41 1138.64 Q2532.41 1137.11 2531.21 1136.18 Q2530 1135.23 2528.04 1135.23 Q2526.83 1135.23 2525.42 1135.65 Q2524.01 1136.04 2522.34 1136.85 L2522.34 1134.01 Q2524.12 1133.36 2525.65 1133.04 Q2527.2 1132.71 2528.52 1132.71 Q2531.88 1132.71 2533.89 1134.24 Q2535.91 1135.77 2535.91 1138.27 Q2535.91 1141.48 2528.25 1148.06 Q2526.95 1149.17 2526.23 1149.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
</div>
</section>
<section id="adding-the-constraints-on-states" class="level3">
<h3 class="anchored" data-anchor-id="adding-the-constraints-on-states">Adding the constraints on states</h3>
<p>We might feel a little bit uneasy about loosing an immediate access to <span class="math inline">\bar{\bm x}</span>. But the game is not lost. We just need to express <span class="math inline">\bar{\bm x}</span> as a function of <span class="math inline">\bar{\bm u}</span> and <span class="math inline">\mathbf x_0</span> and impose the constraint on the result. But such expression is already available, see (<a href="#eq-x_as_function_of_u_and_x0" class="quarto-xref">Eq.&nbsp;2</a>). Therefore, we can formulate the constraint, say, an upper bound on the state vector <span class="math display">
\bm x_k \leq \mathbf x_\mathrm{max}
</span> as <span class="math display">
\bar{\mathbf x}^\mathrm{min} \leq \widehat{\mathbf C} \bar{\bm u} + \widehat{\mathbf A} \mathbf x_0 \leq \bar{\mathbf x}^\mathrm{max},
</span> where the the bars in <span class="math inline">\bar{\mathbf x}^\mathrm{min}</span> and <span class="math inline">\bar{\mathbf x}^\mathrm{max}</span> obviously indicates that these vectors were obtained by stacking the corresponding vectors for all times <span class="math inline">k=1,\ldots,N</span>.</p>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/hurak\.github\.io\/orr\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./discr_dir_general.html" class="pagination-link" aria-label="General finite-horizon nonlinear optimal control as an NLP">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">General finite-horizon nonlinear optimal control as an NLP</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./discr_dir_mpc.html" class="pagination-link" aria-label="Model predictive control (MPC)">
        <span class="nav-page-text">Model predictive control (MPC)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Zdeněk Hurák</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/hurak/orr/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>