<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Finite-horizon LQR as a QP – B(E)3M35ORR – Optimal and Robust Control</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./discr_dir_mpc.html" rel="next">
<link href="./discr_dir_general.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-50b4abff8b0f30bb501ab99a3cda6e79.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./discr_dir_goals.html">3. Discrete-time optimal control – direct approach</a></li><li class="breadcrumb-item"><a href="./discr_dir_LQR.html">Finite-horizon LQR as a QP</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">B(E)3M35ORR – Optimal and Robust Control</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">0. Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">What is optimal and robust control?</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_outline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course outline</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_rules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rules of the course</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software for the course</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literature for the course</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_similar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Similar courses</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">1. Optimization – theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_goals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning goals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimization problems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_reformulations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Problem reformulations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_unconstrained.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unconstrained optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_constrained.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Constrained optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_modellers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimization modelling languages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_theory_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">2. Optimization – algorithms</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_algo_goals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning goals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_algo_derivatives.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computing the derivatives</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_algo_unconstrained.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unconstrained optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_algo_constrained.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Constrained optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_algo_solvers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical solvers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_algo_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./opt_algo_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">3. Discrete-time optimal control – direct approach</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_goals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning goals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General finite-horizon nonlinear optimal control as an NLP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_LQR.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Finite-horizon LQR as a QP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model predictive control (MPC)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical solvers for MPC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">4. Discrete-time optimal control – indirect approach</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_indir_goals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning goals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_indir_general.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General finite-horizon nonlinear optimal control as a TP-BVP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_indir_LQR_fin_horizon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discrete-time LQR on a finite horizon</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_indir_LQR_inf_horizon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discrete-time LQR on an infinite horizon</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_indir_DARE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discrete-time algebraic Riccati equation (DARE)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_indir_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_indir_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">5. Discrete-time optimal control – dynamic programming (DP)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_programming_goals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Learning goals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DP and discrete-time optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_programming_tabular.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tabular outcomes of DP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_programming_LQR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving LQR via DP</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_programming_DDP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Differential dynamic programming (DDP)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_programming_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic_programming_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">6. More on MPC</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc_stability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stability of MPC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc_recursive_feasibility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Recursive feasibility</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc_economic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Economic MPC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc_explicit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explicit MPC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discr_dir_mpc_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">7. Continuous-time optimal control - indirect approach via calculus of variations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview of continuous-time optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_calculus_of_variations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calculus of variations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_via_calculus_of_variations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Indirect approach to optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_LQR_fin_horizon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Indirect approach to LQR on a finite horizon</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_LQR_inf_horizon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Indirect approach to LQR on an infinite horizon</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_CARE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Continuous-time Riccati equation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_trajectory_stabilization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Trajectory stabilization and neigboring extremals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">8. Continuous-time optimal control - indirect approach via Pontryagin’s maximum principle</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_Pontryagin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pontryagin’s maximum principle</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_constrained.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Constrained optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_time_optimal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Time-optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_references_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_indir_hw_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">9. Numerical methods for continuous-time optimal control - both indirect and direct approaches</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_numerical_indirect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical methods for indirect approach</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_numerical_direct.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical methods for direct approach</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_numerical_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_numerical_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_numerical_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true">
 <span class="menu-text">9.X. Continuous-time optimal control – dynamic programming</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_dp_HJB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dynamic programming for continuous-time optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_dp_LQR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using HJB equation to solve the continuous-time LQR problem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_dp_DDP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Differential dynamic programming (DDP)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_dp_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cont_dp_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true">
 <span class="menu-text">10. Some extensions: LQG, LTR, H2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ext_stochastic_LQR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LQR for stochastic systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ext_LQG.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LQG control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ext_LTR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loop transfer recovery (LTR)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ext_H2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">H2-optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ext_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ext_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ext_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="true">
 <span class="menu-text">11. Uncertainty modelling and robustness analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roban_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Uncertainty (in) modelling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roban_unstructured.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Robustness analysis for unstructured uncertainty</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roban_structured.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Robustness analysis for structured uncertainty</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roban_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roban_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roban_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="true">
 <span class="menu-text">12. Robust control</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rocond_mixed_sensitivity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed sensitivity design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rocond_H_infinity_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hinfinity-optimal control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rocond_mu_synthesis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mu synthesis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rocond_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Software</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rocond_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rocond_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="true">
 <span class="menu-text">13. Limitations of achievable performance</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./limitations_SISO.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Limitations for SISO systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./limitations_MIMO.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Limitations for MIMO systems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./limitations_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./limitations_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="true">
 <span class="menu-text">14. Model and controller order reduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reduction_order_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model order reduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reduction_order_controller.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Controller order reduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reduction_order_benchmarks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Benchmarks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reduction_order_references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reduction_order_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#simultaneous-sparse-formulation" id="toc-simultaneous-sparse-formulation" class="nav-link active" data-scroll-target="#simultaneous-sparse-formulation">Simultaneous (sparse) formulation</a>
  <ul class="collapse">
  <li><a href="#adding-constraints-on-controls-and-states" id="toc-adding-constraints-on-controls-and-states" class="nav-link" data-scroll-target="#adding-constraints-on-controls-and-states">Adding constraints on controls and states</a></li>
  </ul></li>
  <li><a href="#sequential-dense-formulation" id="toc-sequential-dense-formulation" class="nav-link" data-scroll-target="#sequential-dense-formulation">Sequential (dense) formulation</a>
  <ul class="collapse">
  <li><a href="#adding-the-constraints-on-controls" id="toc-adding-the-constraints-on-controls" class="nav-link" data-scroll-target="#adding-the-constraints-on-controls">Adding the constraints on controls</a></li>
  <li><a href="#adding-the-constraints-on-states" id="toc-adding-the-constraints-on-states" class="nav-link" data-scroll-target="#adding-the-constraints-on-states">Adding the constraints on states</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/hurak/orr/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./discr_dir_goals.html">3. Discrete-time optimal control – direct approach</a></li><li class="breadcrumb-item"><a href="./discr_dir_LQR.html">Finite-horizon LQR as a QP</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Finite-horizon LQR as a QP</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/1MHV-L4--lI?si=6Orm_cGxmTAX_myT" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>Here we specialize the general procedure from the previous section to the case of a <strong>L</strong>inear system and a <strong>Q</strong>uadratic cost. We start by considering a simple problem of <strong>R</strong>egulation, wherein the goal is to bring the system either exactly or approximately to zero final state, that is, <span class="math inline">\mathbf x^\text{ref}=\mathbf 0</span> and we want <span class="math inline">\bm x_N=\mathbf x^\text{ref}</span> or <span class="math inline">\bm x_N\approx\mathbf x^\text{ref}</span>, respectively. The problem is known as the <strong>LQR</strong> problem. <span class="math display">
\begin{aligned}
\operatorname*{minimize}_{\bm u_0,\ldots, \bm u_{N-1}, \bm x_{0},\ldots, \bm x_N} &amp;\quad  \frac{1}{2} \bm x_N^\top \mathbf S \bm x_N + \frac{1}{2} \sum_{k=0}^{N-1} \left(\bm x_k^\top \mathbf Q \bm x_k + \bm u_k^\top \mathbf R \bm u_k \right)\\
\text{subject to}   &amp;\quad \bm x_{k+1} = \mathbf A\bm x_k + \mathbf B\bm u_k,\quad k = 0, \ldots, N-1, \\
                    &amp;\quad \bm x_0 = \mathbf x_0,\\
                    &amp;\quad \bm x_N = \mathbf 0\;  (\text{or}\, \bm x_N \approx \mathbf 0).
\end{aligned}
</span></p>
<p>Referring to the two options for the last constraint,</p>
<ul>
<li>if the condition <span class="math inline">\bm x_N=\mathbf 0</span> on the final state is strictly enforced, the terminal state cost (the term <span class="math inline">\frac{1}{2} \bm x_N^\top \mathbf S \bm x_N</span> in the cost function) is redundant and can be removed;</li>
<li>if the final state condition can be relaxed to <span class="math inline">\bm x_N\approx\mathbf 0</span>, it is by increasing the weight <span class="math inline">\mathbf S</span> in the terminal cost function <span class="math inline">\frac{1}{2} \bm x_N^\top \mathbf S \bm x_N</span> that <span class="math inline">\bm x_N</span> can be made arbitrarily close to <span class="math inline">\mathbf 0</span>.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is a standard dilemma in optimization, not only in optimal control, that if we want to satisfy some requirement, we can either strictly enforce it through constraints or we can seemingly relax it and set a cost to be paid for not satysfying it.</p>
</div>
</div>
<section id="simultaneous-sparse-formulation" class="level2">
<h2 class="anchored" data-anchor-id="simultaneous-sparse-formulation">Simultaneous (sparse) formulation</h2>
<p>Below we rewrite the latter problem, that is, <span class="math inline">\bm x_N\approx\mathbf 0</span>, in the “unrolled” form, where we stack the state and control variables into “long” vectors <span class="math inline">\bar{\bm x}</span> and <span class="math inline">\bar{\bm u}</span>. Doing the same for the former is straightforward. <span class="math display">
\begin{aligned}
\operatorname*{minimize}_{\bar{\bm u},\bar{\bm x}} &amp; \frac{1}{2}\left(\begin{bmatrix} \bm x_1^\top &amp; \bm x_2^\top &amp; \ldots &amp; \bm x_N^\top \end{bmatrix}
\underbrace{\begin{bmatrix}\mathbf Q &amp; &amp; &amp; \\ &amp; \mathbf Q &amp; &amp;\\ &amp; &amp;\ddots &amp; \\ &amp; &amp; &amp; \mathbf S \end{bmatrix}}_{\overline{\mathbf Q}}
\underbrace{\begin{bmatrix} \bm x_1 \\ \bm x_2 \\ \vdots \\ \bm x_N \end{bmatrix}}_{\bar{\bm x}}\right.\\
&amp;\qquad +\left.
\begin{bmatrix} \bm u_0^\top &amp; \bm u_1^\top &amp; \ldots &amp; \bm u_{N-1}^\top \end{bmatrix}
\underbrace{\begin{bmatrix}\mathbf R &amp; &amp; &amp; \\ &amp; \mathbf R &amp; &amp;\\ &amp; &amp;\ddots &amp; \\ &amp; &amp; &amp; \mathbf R \end{bmatrix}}_{\overline{\mathbf R}}
\underbrace{\begin{bmatrix} \bm u_0 \\ \bm u_1 \\ \vdots \\ \bm u_{N-1} \end{bmatrix}}_{\bar{\bm u}}\right)
+ \underbrace{\frac{1}{2}\mathbf x_0^\top \mathbf Q \mathbf x_0}_{\mathrm{constant}}
\end{aligned}
</span> subject to <span class="math display">
\begin{bmatrix} \bm x_1 \\ \bm x_2 \\ \bm x_3\\ \vdots \\ \bm x_N \end{bmatrix} = \underbrace{\begin{bmatrix}\mathbf 0 &amp; &amp; &amp; &amp;\\\mathbf A &amp; \mathbf 0 &amp; &amp; &amp;\\ &amp;\mathbf A &amp;\mathbf 0 &amp; &amp; \\ &amp; &amp; &amp;\ddots &amp; \\&amp; &amp; &amp;\mathbf A &amp; \mathbf 0 \end{bmatrix}}_{\overline{\mathbf A}}
\begin{bmatrix} \bm x_1 \\ \bm x_2 \\ \bm x_3\\ \vdots \\ \bm x_N \end{bmatrix} + \underbrace{\begin{bmatrix}\mathbf B &amp; &amp; &amp; &amp; \\ &amp; \mathbf B &amp; &amp; &amp; \\&amp; &amp;\mathbf B &amp; \\ &amp; &amp; &amp;\ddots \\ &amp; &amp; &amp; &amp; \mathbf B \end{bmatrix}}_{\overline{\mathbf B}}\begin{bmatrix} \bm u_0 \\ \bm u_1 \\ \bm u_2\\\vdots \\ \bm u_{N-1} \end{bmatrix} + \underbrace{\begin{bmatrix}\mathbf A\\\mathbf 0\\\mathbf 0\\\vdots\\\mathbf 0\end{bmatrix}}_{\overline{\mathbf A}_0}\mathbf x_0,    
</span></p>
<p>in which we have already substituted the particular <span class="math inline">\mathbf x_0</span> for the variable <span class="math inline">\bm x_0</span>. Consequently, the last term in the cost function can be discarded because it is constant.</p>
<p>The terms with the <span class="math inline">\bar{\bm x}</span> vector can be combined and we get <span id="eq-linear_system_linear_constraints_matrix_format"><span class="math display">
\begin{bmatrix} \mathbf 0 \\ \mathbf 0 \\ \mathbf 0\\ \vdots \\ \mathbf 0 \end{bmatrix} = \underbrace{\begin{bmatrix}-\mathbf I &amp; &amp; &amp; &amp;\\\mathbf A &amp; -\mathbf I &amp; &amp; &amp;\\ &amp;\mathbf A &amp;-\mathbf I &amp; &amp; \\ &amp; &amp; &amp;\ddots &amp; \\&amp; &amp; &amp;\mathbf A &amp; -\mathbf I \end{bmatrix}}_{\overline{\mathbf A} - \mathbf I}
\begin{bmatrix} \mathbf x_1 \\ \mathbf x_2 \\ \mathbf x_3\\ \vdots \\ \mathbf x_N \end{bmatrix} + \underbrace{\begin{bmatrix}\mathbf B &amp; &amp; &amp; &amp; \\ &amp; \mathbf B &amp; &amp; &amp; \\&amp; &amp;\mathbf B &amp; \\ &amp; &amp; &amp;\ddots \\ &amp; &amp; &amp; &amp; \mathbf B \end{bmatrix}}_{\overline{\mathbf B}}\begin{bmatrix} \mathbf u_0 \\ \mathbf u_1 \\ \mathbf u_2\\\vdots \\ \mathbf u_{N-1} \end{bmatrix} + \underbrace{\begin{bmatrix}\mathbf A\\\mathbf 0\\\mathbf 0\\\vdots\\\mathbf 0\end{bmatrix}}_{\overline{\mathbf A}_0}\mathbf x_0.
\tag{1}</span></span></p>
<p>Upon stacking the two “long” vectors into <span class="math inline">\bar{\bm z}</span> we reformulate the optimization problem as <span class="math display">
\operatorname*{minimize}_{\widetilde{\mathbf z}\in\mathbb{R}^{2N}}\quad \frac{1}{2}\underbrace{\begin{bmatrix}\bar{\bm x}^\top &amp;\bar{\bm u}^\top\end{bmatrix}}_{\bar{\bm z}^\top} \underbrace{\begin{bmatrix}\overline{\mathbf Q} &amp; \\ &amp; \overline{\mathbf R} \end{bmatrix}}_{\widetilde{\mathbf Q}}\underbrace{\begin{bmatrix}\bar{\bm x}\\\bar{\bm u}\end{bmatrix}}_{\bar{\bm z}}
</span> subject to <span class="math display">
\mathbf 0 = \underbrace{\begin{bmatrix}(\overline{\mathbf A}-\mathbf I) &amp; \overline{\mathbf B}\end{bmatrix}}_{\widetilde{\mathbf A}}\underbrace{\begin{bmatrix}\bar{\bm x}\\\bar{\bm u}\end{bmatrix}}_{\bar{\bm z}} + \underbrace{\overline{\mathbf A}_0 \mathbf x_0}_{\tilde{\mathbf b}}.
</span></p>
<p>To summarize, we have reformulated the optimal control problem as a linearly constrained quadratic program <span class="math display">
\boxed{
\begin{aligned}
\underset{\bar{\bm z}\in\mathbb{R}^{2N}}{\text{minimize}} &amp;\quad \frac{1}{2}\bar{\bm z}^\top \widetilde{\mathbf Q} \bar{\bm z}\\
\text{subject to} &amp;\quad \widetilde{\mathbf A} \bar{\bm z} + \tilde{\bm b} = \mathbf 0.
\end{aligned}}
</span></p>
<p>This constrained optimization problem can still be solved without invoking a numerical solver for solving quadratic programs (QP). We do it by introducing a vector <span class="math inline">\boldsymbol\lambda</span> of Lagrange multipliers to form the Lagrangian function <span class="math display">
\mathcal{L}(\bar{\bm z}, \boldsymbol \lambda) = \frac{1}{2}\bar{\bm z}^\top \widetilde{\mathbf Q} \bar{\bm z} + \boldsymbol\lambda^\top(\widetilde{\mathbf A} \bar{\bm z} + \tilde{\mathbf b}),
</span> for which the gradients with respect to <span class="math inline">\bar{\bm z}</span> and <span class="math inline">\boldsymbol\lambda</span> are <span class="math display">
\begin{aligned}
\nabla_{\tilde{\bm{z}}} \mathcal{L}(\bar{\bm z}, \boldsymbol\lambda) &amp;= \widetilde{\mathbf Q}\bar{\bm z} + \tilde{\mathbf A}^\top\boldsymbol\lambda,\\
\nabla_{\boldsymbol{\lambda}} \mathcal{L}(\tilde{\bm x}, \boldsymbol\lambda) &amp;=\widetilde{\mathbf A} \bar{\bm z} + \tilde{\mathbf b}.
\end{aligned}
</span></p>
<p>Requiring that the overall gradient vanishes leads to the following KKT set of linear equations <span class="math display">
\begin{bmatrix}
  \widetilde{\mathbf Q} &amp; \widetilde{\mathbf A}^\top\\ \widetilde{\mathbf A} &amp; \mathbf 0
\end{bmatrix}
\begin{bmatrix}
\bar{\bm z}\\\boldsymbol\lambda
\end{bmatrix}
=
\begin{bmatrix}
\mathbf 0\\ -\tilde{\mathbf b}
\end{bmatrix}.
</span></p>
<p>Solving this could be accomplished by using some general solver for linear systems or by using some more tailored solver for symmetric indefinite systems (based on <a href="https://en.wikipedia.org/wiki/Cholesky_decomposition#LDL_decomposition">LDL factorization</a>).</p>
<div id="exm-direct-simultaneous" class="theorem example">
<p><span class="theorem-title"><strong>Example 1 (Reformulating the unconstrained LQR problem as a system of linear equations – simultaneous approach)</strong></span> &nbsp;</p>
<div id="2" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">BlockArrays</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearSolve</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">QDLDL</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">SparseArrays</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">direct_dlqr_simultaneous</span>(A,B,x₀,Q,R,S,N)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">size</span>(A)[<span class="fl">1</span>]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="fu">size</span>(B)[<span class="fl">2</span>]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    Q̄ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,N<span class="op">*</span>n),<span class="fu">repeat</span>([n],N),<span class="fu">repeat</span>([n],N))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        Q̄[<span class="fu">Block</span>(i,i)] <span class="op">=</span> Q</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    Q̄[<span class="fu">Block</span>(N,N)] <span class="op">=</span> S</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    R̄ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>m,N<span class="op">*</span>m),<span class="fu">repeat</span>([m],N),<span class="fu">repeat</span>([m],N))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        R̄[<span class="fu">Block</span>(i,i)] <span class="op">=</span> R</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    Q̃ <span class="op">=</span> <span class="fu">blockdiag</span>(<span class="fu">sparse</span>(Q̄),<span class="fu">sparse</span>(R̄))              <span class="co"># The matrix defining the quadratic cost.</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    B̄ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,N<span class="op">*</span>m),<span class="fu">repeat</span>([n],N),<span class="fu">repeat</span>([m],N))</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        B̄[<span class="fu">Block</span>(i,i)] <span class="op">=</span> B</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    Ā <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">sparse</span>(<span class="op">-</span><span class="fl">1.0</span><span class="op">*</span>I,n<span class="op">*</span>N,n<span class="op">*</span>N),<span class="fu">repeat</span>([n],N),<span class="fu">repeat</span>([n],N))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">2</span><span class="op">:</span>N</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        Ā[<span class="fu">Block</span>(i,(i<span class="op">-</span><span class="fl">1</span>))] <span class="op">=</span> A</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    Ã <span class="op">=</span> <span class="fu">sparse</span>([Ā B̄])                               <span class="co"># The matrix defining the linear (affine) equation.</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    Ā₀ <span class="op">=</span> <span class="fu">spzeros</span>(n<span class="op">*</span>N,n)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    Ā₀[<span class="fl">1</span><span class="op">:</span>n,<span class="fl">1</span><span class="op">:</span>n] <span class="op">=</span> A</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    b̃ <span class="op">=</span> <span class="fu">Ā₀*sparse</span>(x₀)                               <span class="co"># The constant offset for the linear (affine) equation.</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    K <span class="op">=</span> [Q̃ Ã<span class="ch">'; Ã spzeros(size(Ã,1),size(Ã,1))]      # Sparse KKT matrix.</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> [<span class="fu">spzeros</span>(<span class="fu">size</span>(Q̃,<span class="fl">1</span>)); <span class="op">-</span>b̃]                    <span class="co"># Right hand side of the KKT system</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    prob <span class="op">=</span> <span class="fu">LinearProblem</span>(K,k)                       <span class="co"># The KKT system as a linear problem.</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    z̃λ <span class="op">=</span> LinearSolve.<span class="fu">solve</span>(prob)                    <span class="co"># Solving the KKT system. Ready for trying various solvers.</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    xopt <span class="op">=</span> <span class="fu">reshape</span>(z̃λ[<span class="fl">1</span><span class="op">:</span>(n<span class="op">*</span>N)],(n,<span class="op">:</span>))</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    uopt <span class="op">=</span> <span class="fu">reshape</span>(z̃λ[(n<span class="op">*</span>N<span class="op">+</span><span class="fl">1</span>)<span class="op">:</span>(n<span class="op">+</span>m)<span class="op">*</span>N],(m,<span class="op">:</span>))</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    return xopt,uopt</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="fl">2</span>               <span class="co"># Number of state variables.</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1</span>               <span class="co"># Number of (control) input variables. </span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> <span class="fu">rand</span>(n,n)       <span class="co"># State matrix.</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> <span class="fu">rand</span>(n,m)       <span class="co"># Input coupling matrix.</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>x₀ <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">3.0</span>]     <span class="co"># Initial state.</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">10</span>              <span class="co"># Time horizon.</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">2.0</span>]      </span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">2.0</span>]</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> [<span class="fl">1.0</span>]</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>s)     <span class="co"># Matrix defining the terminal state cost.</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>q)     <span class="co"># Matrix defining the running state dost.</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>r)     <span class="co"># Matrix defining the cost of control.</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>xopt,uopt <span class="op">=</span> <span class="fu">direct_dlqr_simultaneous</span>(A,B,x₀,Q,R,S,N)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> <span class="fu">plot</span>(<span class="fl">0</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>),uopt<span class="op">'</span>,marker<span class="op">=:</span>diamond,label<span class="op">=</span><span class="st">"u"</span>,linetype<span class="op">=:</span>steppost)</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel!</span>(<span class="st">"k"</span>)</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel!</span>(<span class="st">"u"</span>)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> <span class="fu">plot</span>(<span class="fl">0</span><span class="op">:</span>N,<span class="fu">hcat</span>(x₀,xopt)<span class="ch">',marker=:diamond,label=["x₁" "x₂"],linetype=:steppost)</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel!</span>(<span class="st">"k"</span>)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel!</span>(<span class="st">"x"</span>)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p1,p2,layout<span class="op">=</span>(<span class="fl">2</span>,<span class="fl">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip750">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip750)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip751">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip750)" d="M263.478 774.117 L2640.76 774.117 L2640.76 47.2441 L263.478 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip752">
    <rect x="263" y="47" width="2378" height="728"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="330.76,774.117 330.76,47.2441 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="829.141,774.117 829.141,47.2441 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1327.52,774.117 1327.52,47.2441 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1825.9,774.117 1825.9,47.2441 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2324.28,774.117 2324.28,47.2441 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,751.403 2640.76,751.403 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,613.603 2640.76,613.603 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,475.803 2640.76,475.803 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,338.003 2640.76,338.003 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,200.203 2640.76,200.203 "></polyline>
<polyline clip-path="url(#clip752)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,62.4034 2640.76,62.4034 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,774.117 2640.76,774.117 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="330.76,774.117 330.76,755.219 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="829.141,774.117 829.141,755.219 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1327.52,774.117 1327.52,755.219 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1825.9,774.117 1825.9,755.219 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2324.28,774.117 2324.28,755.219 "></polyline>
<path clip-path="url(#clip750)" d="M330.76 807.34 Q327.149 807.34 325.32 810.904 Q323.514 814.446 323.514 821.576 Q323.514 828.682 325.32 832.247 Q327.149 835.789 330.76 835.789 Q334.394 835.789 336.2 832.247 Q338.028 828.682 338.028 821.576 Q338.028 814.446 336.2 810.904 Q334.394 807.34 330.76 807.34 M330.76 803.636 Q336.57 803.636 339.625 808.242 Q342.704 812.826 342.704 821.576 Q342.704 830.303 339.625 834.909 Q336.57 839.492 330.76 839.492 Q324.95 839.492 321.871 834.909 Q318.815 830.303 318.815 821.576 Q318.815 812.826 321.871 808.242 Q324.95 803.636 330.76 803.636 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M823.794 834.886 L840.113 834.886 L840.113 838.821 L818.169 838.821 L818.169 834.886 Q820.831 832.131 825.414 827.502 Q830.02 822.849 831.201 821.506 Q833.446 818.983 834.326 817.247 Q835.229 815.488 835.229 813.798 Q835.229 811.043 833.284 809.307 Q831.363 807.571 828.261 807.571 Q826.062 807.571 823.608 808.335 Q821.178 809.099 818.4 810.65 L818.4 805.928 Q821.224 804.793 823.678 804.215 Q826.132 803.636 828.169 803.636 Q833.539 803.636 836.733 806.321 Q839.928 809.006 839.928 813.497 Q839.928 815.627 839.118 817.548 Q838.331 819.446 836.224 822.039 Q835.645 822.71 832.544 825.928 Q829.442 829.122 823.794 834.886 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1330.53 808.335 L1318.73 826.784 L1330.53 826.784 L1330.53 808.335 M1329.3 804.261 L1335.18 804.261 L1335.18 826.784 L1340.11 826.784 L1340.11 830.673 L1335.18 830.673 L1335.18 838.821 L1330.53 838.821 L1330.53 830.673 L1314.93 830.673 L1314.93 826.159 L1329.3 804.261 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1826.31 819.678 Q1823.16 819.678 1821.31 821.83 Q1819.48 823.983 1819.48 827.733 Q1819.48 831.46 1821.31 833.636 Q1823.16 835.789 1826.31 835.789 Q1829.46 835.789 1831.28 833.636 Q1833.14 831.46 1833.14 827.733 Q1833.14 823.983 1831.28 821.83 Q1829.46 819.678 1826.31 819.678 M1835.59 805.025 L1835.59 809.284 Q1833.83 808.451 1832.03 808.011 Q1830.24 807.571 1828.48 807.571 Q1823.85 807.571 1821.4 810.696 Q1818.97 813.821 1818.62 820.141 Q1819.99 818.127 1822.05 817.062 Q1824.11 815.974 1826.59 815.974 Q1831.79 815.974 1834.8 819.145 Q1837.84 822.293 1837.84 827.733 Q1837.84 833.057 1834.69 836.275 Q1831.54 839.492 1826.31 839.492 Q1820.31 839.492 1817.14 834.909 Q1813.97 830.303 1813.97 821.576 Q1813.97 813.381 1817.86 808.52 Q1821.75 803.636 1828.3 803.636 Q1830.06 803.636 1831.84 803.983 Q1833.65 804.33 1835.59 805.025 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2324.28 822.409 Q2320.95 822.409 2319.03 824.191 Q2317.13 825.974 2317.13 829.099 Q2317.13 832.224 2319.03 834.006 Q2320.95 835.789 2324.28 835.789 Q2327.62 835.789 2329.54 834.006 Q2331.46 832.201 2331.46 829.099 Q2331.46 825.974 2329.54 824.191 Q2327.64 822.409 2324.28 822.409 M2319.61 820.418 Q2316.6 819.678 2314.91 817.617 Q2313.24 815.557 2313.24 812.594 Q2313.24 808.451 2316.18 806.043 Q2319.15 803.636 2324.28 803.636 Q2329.45 803.636 2332.39 806.043 Q2335.33 808.451 2335.33 812.594 Q2335.33 815.557 2333.64 817.617 Q2331.97 819.678 2328.98 820.418 Q2332.36 821.205 2334.24 823.497 Q2336.14 825.789 2336.14 829.099 Q2336.14 834.122 2333.06 836.807 Q2330 839.492 2324.28 839.492 Q2318.57 839.492 2315.49 836.807 Q2312.43 834.122 2312.43 829.099 Q2312.43 825.789 2314.33 823.497 Q2316.23 821.205 2319.61 820.418 M2317.9 813.034 Q2317.9 815.719 2319.56 817.224 Q2321.25 818.729 2324.28 818.729 Q2327.29 818.729 2328.98 817.224 Q2330.7 815.719 2330.7 813.034 Q2330.7 810.349 2328.98 808.844 Q2327.29 807.34 2324.28 807.34 Q2321.25 807.34 2319.56 808.844 Q2317.9 810.349 2317.9 813.034 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1436.3 873.776 L1442.19 873.776 L1442.19 903.026 L1459.66 887.653 L1467.14 887.653 L1448.23 904.331 L1467.94 923.301 L1460.3 923.301 L1442.19 905.891 L1442.19 923.301 L1436.3 923.301 L1436.3 873.776 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,774.117 263.478,47.2441 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,751.403 282.376,751.403 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,613.603 282.376,613.603 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,475.803 282.376,475.803 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,338.003 282.376,338.003 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,200.203 282.376,200.203 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,62.4034 282.376,62.4034 "></polyline>
<path clip-path="url(#clip750)" d="M117.21 751.854 L146.886 751.854 L146.886 755.789 L117.21 755.789 L117.21 751.854 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M161.006 764.747 L177.325 764.747 L177.325 768.683 L155.381 768.683 L155.381 764.747 Q158.043 761.993 162.626 757.363 Q167.233 752.71 168.413 751.368 Q170.659 748.845 171.538 747.109 Q172.441 745.349 172.441 743.66 Q172.441 740.905 170.497 739.169 Q168.575 737.433 165.473 737.433 Q163.274 737.433 160.821 738.197 Q158.39 738.96 155.612 740.511 L155.612 735.789 Q158.436 734.655 160.89 734.076 Q163.344 733.498 165.381 733.498 Q170.751 733.498 173.946 736.183 Q177.14 738.868 177.14 743.359 Q177.14 745.488 176.33 747.41 Q175.543 749.308 173.436 751.9 Q172.858 752.572 169.756 755.789 Q166.654 758.984 161.006 764.747 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M187.14 762.803 L192.024 762.803 L192.024 768.683 L187.14 768.683 L187.14 762.803 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M202.256 734.123 L220.612 734.123 L220.612 738.058 L206.538 738.058 L206.538 746.53 Q207.557 746.183 208.575 746.021 Q209.594 745.835 210.612 745.835 Q216.399 745.835 219.779 749.007 Q223.158 752.178 223.158 757.595 Q223.158 763.173 219.686 766.275 Q216.214 769.354 209.894 769.354 Q207.719 769.354 205.45 768.983 Q203.205 768.613 200.797 767.872 L200.797 763.173 Q202.881 764.308 205.103 764.863 Q207.325 765.419 209.802 765.419 Q213.807 765.419 216.144 763.312 Q218.482 761.206 218.482 757.595 Q218.482 753.984 216.144 751.877 Q213.807 749.771 209.802 749.771 Q207.927 749.771 206.052 750.187 Q204.2 750.604 202.256 751.484 L202.256 734.123 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M116.214 614.054 L145.89 614.054 L145.89 617.989 L116.214 617.989 L116.214 614.054 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M160.011 626.948 L176.33 626.948 L176.33 630.883 L154.386 630.883 L154.386 626.948 Q157.048 624.193 161.631 619.563 Q166.237 614.911 167.418 613.568 Q169.663 611.045 170.543 609.309 Q171.446 607.55 171.446 605.86 Q171.446 603.105 169.501 601.369 Q167.58 599.633 164.478 599.633 Q162.279 599.633 159.825 600.397 Q157.395 601.161 154.617 602.712 L154.617 597.989 Q157.441 596.855 159.895 596.276 Q162.348 595.698 164.385 595.698 Q169.756 595.698 172.95 598.383 Q176.145 601.068 176.145 605.559 Q176.145 607.688 175.334 609.61 Q174.547 611.508 172.441 614.1 Q171.862 614.772 168.76 617.989 Q165.659 621.184 160.011 626.948 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M186.145 625.003 L191.029 625.003 L191.029 630.883 L186.145 630.883 L186.145 625.003 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M211.214 599.401 Q207.603 599.401 205.774 602.966 Q203.969 606.508 203.969 613.637 Q203.969 620.744 205.774 624.309 Q207.603 627.85 211.214 627.85 Q214.848 627.85 216.654 624.309 Q218.482 620.744 218.482 613.637 Q218.482 606.508 216.654 602.966 Q214.848 599.401 211.214 599.401 M211.214 595.698 Q217.024 595.698 220.08 600.304 Q223.158 604.887 223.158 613.637 Q223.158 622.364 220.08 626.971 Q217.024 631.554 211.214 631.554 Q205.404 631.554 202.325 626.971 Q199.27 622.364 199.27 613.637 Q199.27 604.887 202.325 600.304 Q205.404 595.698 211.214 595.698 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M117.21 476.254 L146.886 476.254 L146.886 480.189 L117.21 480.189 L117.21 476.254 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M157.788 489.148 L165.427 489.148 L165.427 462.782 L157.117 464.449 L157.117 460.19 L165.381 458.523 L170.057 458.523 L170.057 489.148 L177.696 489.148 L177.696 493.083 L157.788 493.083 L157.788 489.148 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M187.14 487.203 L192.024 487.203 L192.024 493.083 L187.14 493.083 L187.14 487.203 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M202.256 458.523 L220.612 458.523 L220.612 462.458 L206.538 462.458 L206.538 470.93 Q207.557 470.583 208.575 470.421 Q209.594 470.236 210.612 470.236 Q216.399 470.236 219.779 473.407 Q223.158 476.578 223.158 481.995 Q223.158 487.574 219.686 490.675 Q216.214 493.754 209.894 493.754 Q207.719 493.754 205.45 493.384 Q203.205 493.013 200.797 492.273 L200.797 487.574 Q202.881 488.708 205.103 489.263 Q207.325 489.819 209.802 489.819 Q213.807 489.819 216.144 487.713 Q218.482 485.606 218.482 481.995 Q218.482 478.384 216.144 476.277 Q213.807 474.171 209.802 474.171 Q207.927 474.171 206.052 474.588 Q204.2 475.004 202.256 475.884 L202.256 458.523 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M116.214 338.454 L145.89 338.454 L145.89 342.39 L116.214 342.39 L116.214 338.454 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M156.793 351.348 L164.432 351.348 L164.432 324.982 L156.122 326.649 L156.122 322.39 L164.385 320.723 L169.061 320.723 L169.061 351.348 L176.7 351.348 L176.7 355.283 L156.793 355.283 L156.793 351.348 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M186.145 349.403 L191.029 349.403 L191.029 355.283 L186.145 355.283 L186.145 349.403 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M211.214 323.802 Q207.603 323.802 205.774 327.367 Q203.969 330.908 203.969 338.038 Q203.969 345.144 205.774 348.709 Q207.603 352.251 211.214 352.251 Q214.848 352.251 216.654 348.709 Q218.482 345.144 218.482 338.038 Q218.482 330.908 216.654 327.367 Q214.848 323.802 211.214 323.802 M211.214 320.098 Q217.024 320.098 220.08 324.705 Q223.158 329.288 223.158 338.038 Q223.158 346.765 220.08 351.371 Q217.024 355.954 211.214 355.954 Q205.404 355.954 202.325 351.371 Q199.27 346.765 199.27 338.038 Q199.27 329.288 202.325 324.705 Q205.404 320.098 211.214 320.098 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M117.21 200.655 L146.886 200.655 L146.886 204.59 L117.21 204.59 L117.21 200.655 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M166.978 186.002 Q163.367 186.002 161.538 189.567 Q159.733 193.108 159.733 200.238 Q159.733 207.344 161.538 210.909 Q163.367 214.451 166.978 214.451 Q170.612 214.451 172.418 210.909 Q174.247 207.344 174.247 200.238 Q174.247 193.108 172.418 189.567 Q170.612 186.002 166.978 186.002 M166.978 182.298 Q172.788 182.298 175.844 186.905 Q178.922 191.488 178.922 200.238 Q178.922 208.965 175.844 213.571 Q172.788 218.154 166.978 218.154 Q161.168 218.154 158.089 213.571 Q155.034 208.965 155.034 200.238 Q155.034 191.488 158.089 186.905 Q161.168 182.298 166.978 182.298 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M187.14 211.604 L192.024 211.604 L192.024 217.483 L187.14 217.483 L187.14 211.604 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M202.256 182.923 L220.612 182.923 L220.612 186.858 L206.538 186.858 L206.538 195.331 Q207.557 194.983 208.575 194.821 Q209.594 194.636 210.612 194.636 Q216.399 194.636 219.779 197.807 Q223.158 200.979 223.158 206.395 Q223.158 211.974 219.686 215.076 Q216.214 218.154 209.894 218.154 Q207.719 218.154 205.45 217.784 Q203.205 217.414 200.797 216.673 L200.797 211.974 Q202.881 213.108 205.103 213.664 Q207.325 214.219 209.802 214.219 Q213.807 214.219 216.144 212.113 Q218.482 210.006 218.482 206.395 Q218.482 202.784 216.144 200.678 Q213.807 198.571 209.802 198.571 Q207.927 198.571 206.052 198.988 Q204.2 199.405 202.256 200.284 L202.256 182.923 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M165.983 48.2021 Q162.372 48.2021 160.543 51.7669 Q158.737 55.3085 158.737 62.4381 Q158.737 69.5445 160.543 73.1093 Q162.372 76.651 165.983 76.651 Q169.617 76.651 171.422 73.1093 Q173.251 69.5445 173.251 62.4381 Q173.251 55.3085 171.422 51.7669 Q169.617 48.2021 165.983 48.2021 M165.983 44.4984 Q171.793 44.4984 174.848 49.1048 Q177.927 53.6881 177.927 62.4381 Q177.927 71.1649 174.848 75.7714 Q171.793 80.3547 165.983 80.3547 Q160.173 80.3547 157.094 75.7714 Q154.038 71.1649 154.038 62.4381 Q154.038 53.6881 157.094 49.1048 Q160.173 44.4984 165.983 44.4984 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M186.145 73.8038 L191.029 73.8038 L191.029 79.6834 L186.145 79.6834 L186.145 73.8038 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M211.214 48.2021 Q207.603 48.2021 205.774 51.7669 Q203.969 55.3085 203.969 62.4381 Q203.969 69.5445 205.774 73.1093 Q207.603 76.651 211.214 76.651 Q214.848 76.651 216.654 73.1093 Q218.482 69.5445 218.482 62.4381 Q218.482 55.3085 216.654 51.7669 Q214.848 48.2021 211.214 48.2021 M211.214 44.4984 Q217.024 44.4984 220.08 49.1048 Q223.158 53.6881 223.158 62.4381 Q223.158 71.1649 220.08 75.7714 Q217.024 80.3547 211.214 80.3547 Q205.404 80.3547 202.325 75.7714 Q199.27 71.1649 199.27 62.4381 Q199.27 53.6881 202.325 49.1048 Q205.404 44.4984 211.214 44.4984 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M47.5702 425.608 L25.9905 425.608 L25.9905 419.752 L47.3474 419.752 Q52.4082 419.752 54.9545 417.778 Q57.4689 415.805 57.4689 411.858 Q57.4689 407.116 54.4452 404.378 Q51.4215 401.609 46.2016 401.609 L25.9905 401.609 L25.9905 395.753 L61.6384 395.753 L61.6384 401.609 L56.1639 401.609 Q59.4104 403.742 61.0019 406.575 Q62.5615 409.376 62.5615 413.1 Q62.5615 419.242 58.742 422.425 Q54.9226 425.608 47.5702 425.608 M25.1311 410.872 L25.1311 410.872 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip752)" d="M330.76 737.545 L314.76 753.545 L330.76 769.545 L346.76 753.545 L330.76 737.545 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M579.95 486.054 L563.95 502.054 L579.95 518.054 L595.95 502.054 L579.95 486.054 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M829.141 309.952 L813.141 325.952 L829.141 341.952 L845.141 325.952 L829.141 309.952 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M1078.33 205.481 L1062.33 221.481 L1078.33 237.481 L1094.33 221.481 L1078.33 205.481 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M1327.52 142.261 L1311.52 158.261 L1327.52 174.261 L1343.52 158.261 L1327.52 142.261 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M1576.71 104.048 L1560.71 120.048 L1576.71 136.048 L1592.71 120.048 L1576.71 104.048 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M1825.9 80.8602 L1809.9 96.8602 L1825.9 112.86 L1841.9 96.8602 L1825.9 80.8602 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M2075.09 66.6558 L2059.09 82.6558 L2075.09 98.6558 L2091.09 82.6558 L2075.09 66.6558 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M2324.28 57.726 L2308.28 73.726 L2324.28 89.726 L2340.28 73.726 L2324.28 57.726 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip752)" d="M2573.47 51.816 L2557.47 67.816 L2573.47 83.816 L2589.47 67.816 L2573.47 51.816 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip752)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="330.76,753.545 579.95,753.545 579.95,502.054 829.141,502.054 829.141,325.952 1078.33,325.952 1078.33,221.481 1327.52,221.481 1327.52,158.261 1576.71,158.261 1576.71,120.048 1825.9,120.048 1825.9,96.8602 2075.09,96.8602 2075.09,82.6558 2324.28,82.6558 2324.28,73.726 2573.47,73.726 2573.47,67.816 "></polyline>
<path clip-path="url(#clip750)" d="M342.721 175.153 L602.162 175.153 L602.162 71.4732 L342.721 71.4732  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="342.721,175.153 602.162,175.153 602.162,71.4732 342.721,71.4732 342.721,175.153 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="369.135,123.313 527.62,123.313 "></polyline>
<path clip-path="url(#clip750)" d="M554.034 130.362 L554.034 114.667 L558.294 114.667 L558.294 130.2 Q558.294 133.88 559.729 135.732 Q561.164 137.561 564.034 137.561 Q567.483 137.561 569.474 135.362 Q571.488 133.163 571.488 129.366 L571.488 114.667 L575.747 114.667 L575.747 140.593 L571.488 140.593 L571.488 136.612 Q569.937 138.973 567.877 140.13 Q565.84 141.264 563.132 141.264 Q558.664 141.264 556.349 138.487 Q554.034 135.709 554.034 130.362 M564.752 114.042 L564.752 114.042 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M263.478 1734.12 L2640.76 1734.12 L2640.76 1007.24 L263.478 1007.24  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip753">
    <rect x="263" y="1007" width="2378" height="728"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="330.76,1734.12 330.76,1007.24 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="891.438,1734.12 891.438,1007.24 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1452.12,1734.12 1452.12,1007.24 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2012.8,1734.12 2012.8,1007.24 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2573.47,1734.12 2573.47,1007.24 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,1717.04 2640.76,1717.04 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,1487.3 2640.76,1487.3 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,1257.56 2640.76,1257.56 "></polyline>
<polyline clip-path="url(#clip753)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,1027.82 2640.76,1027.82 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1734.12 2640.76,1734.12 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="330.76,1734.12 330.76,1715.22 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="891.438,1734.12 891.438,1715.22 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1452.12,1734.12 1452.12,1715.22 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2012.8,1734.12 2012.8,1715.22 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2573.47,1734.12 2573.47,1715.22 "></polyline>
<path clip-path="url(#clip750)" d="M308.144 1767.34 Q304.533 1767.34 302.704 1770.9 Q300.899 1774.45 300.899 1781.58 Q300.899 1788.68 302.704 1792.25 Q304.533 1795.79 308.144 1795.79 Q311.778 1795.79 313.584 1792.25 Q315.413 1788.68 315.413 1781.58 Q315.413 1774.45 313.584 1770.9 Q311.778 1767.34 308.144 1767.34 M308.144 1763.64 Q313.954 1763.64 317.01 1768.24 Q320.089 1772.83 320.089 1781.58 Q320.089 1790.3 317.01 1794.91 Q313.954 1799.49 308.144 1799.49 Q302.334 1799.49 299.255 1794.91 Q296.2 1790.3 296.2 1781.58 Q296.2 1772.83 299.255 1768.24 Q302.334 1763.64 308.144 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M328.306 1792.94 L333.19 1792.94 L333.19 1798.82 L328.306 1798.82 L328.306 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M353.375 1767.34 Q349.764 1767.34 347.936 1770.9 Q346.13 1774.45 346.13 1781.58 Q346.13 1788.68 347.936 1792.25 Q349.764 1795.79 353.375 1795.79 Q357.01 1795.79 358.815 1792.25 Q360.644 1788.68 360.644 1781.58 Q360.644 1774.45 358.815 1770.9 Q357.01 1767.34 353.375 1767.34 M353.375 1763.64 Q359.186 1763.64 362.241 1768.24 Q365.32 1772.83 365.32 1781.58 Q365.32 1790.3 362.241 1794.91 Q359.186 1799.49 353.375 1799.49 Q347.565 1799.49 344.487 1794.91 Q341.431 1790.3 341.431 1781.58 Q341.431 1772.83 344.487 1768.24 Q347.565 1763.64 353.375 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M863.175 1794.89 L879.494 1794.89 L879.494 1798.82 L857.55 1798.82 L857.55 1794.89 Q860.212 1792.13 864.795 1787.5 Q869.402 1782.85 870.582 1781.51 Q872.827 1778.98 873.707 1777.25 Q874.61 1775.49 874.61 1773.8 Q874.61 1771.04 872.665 1769.31 Q870.744 1767.57 867.642 1767.57 Q865.443 1767.57 862.99 1768.34 Q860.559 1769.1 857.781 1770.65 L857.781 1765.93 Q860.605 1764.79 863.059 1764.21 Q865.513 1763.64 867.55 1763.64 Q872.92 1763.64 876.114 1766.32 Q879.309 1769.01 879.309 1773.5 Q879.309 1775.63 878.499 1777.55 Q877.712 1779.45 875.605 1782.04 Q875.026 1782.71 871.925 1785.93 Q868.823 1789.12 863.175 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M889.309 1792.94 L894.193 1792.94 L894.193 1798.82 L889.309 1798.82 L889.309 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M904.424 1764.26 L922.781 1764.26 L922.781 1768.2 L908.707 1768.2 L908.707 1776.67 Q909.725 1776.32 910.744 1776.16 Q911.762 1775.97 912.781 1775.97 Q918.568 1775.97 921.948 1779.15 Q925.327 1782.32 925.327 1787.73 Q925.327 1793.31 921.855 1796.41 Q918.383 1799.49 912.063 1799.49 Q909.887 1799.49 907.619 1799.12 Q905.374 1798.75 902.966 1798.01 L902.966 1793.31 Q905.049 1794.45 907.272 1795 Q909.494 1795.56 911.971 1795.56 Q915.975 1795.56 918.313 1793.45 Q920.651 1791.34 920.651 1787.73 Q920.651 1784.12 918.313 1782.02 Q915.975 1779.91 911.971 1779.91 Q910.096 1779.91 908.221 1780.33 Q906.369 1780.74 904.424 1781.62 L904.424 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1419.28 1764.26 L1437.64 1764.26 L1437.64 1768.2 L1423.56 1768.2 L1423.56 1776.67 Q1424.58 1776.32 1425.6 1776.16 Q1426.62 1775.97 1427.64 1775.97 Q1433.43 1775.97 1436.8 1779.15 Q1440.18 1782.32 1440.18 1787.73 Q1440.18 1793.31 1436.71 1796.41 Q1433.24 1799.49 1426.92 1799.49 Q1424.74 1799.49 1422.48 1799.12 Q1420.23 1798.75 1417.82 1798.01 L1417.82 1793.31 Q1419.91 1794.45 1422.13 1795 Q1424.35 1795.56 1426.83 1795.56 Q1430.83 1795.56 1433.17 1793.45 Q1435.51 1791.34 1435.51 1787.73 Q1435.51 1784.12 1433.17 1782.02 Q1430.83 1779.91 1426.83 1779.91 Q1424.95 1779.91 1423.08 1780.33 Q1421.23 1780.74 1419.28 1781.62 L1419.28 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1449.4 1792.94 L1454.28 1792.94 L1454.28 1798.82 L1449.4 1798.82 L1449.4 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1474.47 1767.34 Q1470.86 1767.34 1469.03 1770.9 Q1467.22 1774.45 1467.22 1781.58 Q1467.22 1788.68 1469.03 1792.25 Q1470.86 1795.79 1474.47 1795.79 Q1478.1 1795.79 1479.91 1792.25 Q1481.74 1788.68 1481.74 1781.58 Q1481.74 1774.45 1479.91 1770.9 Q1478.1 1767.34 1474.47 1767.34 M1474.47 1763.64 Q1480.28 1763.64 1483.33 1768.24 Q1486.41 1772.83 1486.41 1781.58 Q1486.41 1790.3 1483.33 1794.91 Q1480.28 1799.49 1474.47 1799.49 Q1468.66 1799.49 1465.58 1794.91 Q1462.52 1790.3 1462.52 1781.58 Q1462.52 1772.83 1465.58 1768.24 Q1468.66 1763.64 1474.47 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1979.12 1764.26 L2001.34 1764.26 L2001.34 1766.25 L1988.79 1798.82 L1983.91 1798.82 L1995.71 1768.2 L1979.12 1768.2 L1979.12 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2010.46 1792.94 L2015.34 1792.94 L2015.34 1798.82 L2010.46 1798.82 L2010.46 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2025.57 1764.26 L2043.93 1764.26 L2043.93 1768.2 L2029.86 1768.2 L2029.86 1776.67 Q2030.87 1776.32 2031.89 1776.16 Q2032.91 1775.97 2033.93 1775.97 Q2039.72 1775.97 2043.1 1779.15 Q2046.48 1782.32 2046.48 1787.73 Q2046.48 1793.31 2043 1796.41 Q2039.53 1799.49 2033.21 1799.49 Q2031.04 1799.49 2028.77 1799.12 Q2026.52 1798.75 2024.12 1798.01 L2024.12 1793.31 Q2026.2 1794.45 2028.42 1795 Q2030.64 1795.56 2033.12 1795.56 Q2037.12 1795.56 2039.46 1793.45 Q2041.8 1791.34 2041.8 1787.73 Q2041.8 1784.12 2039.46 1782.02 Q2037.12 1779.91 2033.12 1779.91 Q2031.24 1779.91 2029.37 1780.33 Q2027.52 1780.74 2025.57 1781.62 L2025.57 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2525.55 1794.89 L2533.19 1794.89 L2533.19 1768.52 L2524.88 1770.19 L2524.88 1765.93 L2533.14 1764.26 L2537.81 1764.26 L2537.81 1794.89 L2545.45 1794.89 L2545.45 1798.82 L2525.55 1798.82 L2525.55 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2564.9 1767.34 Q2561.29 1767.34 2559.46 1770.9 Q2557.65 1774.45 2557.65 1781.58 Q2557.65 1788.68 2559.46 1792.25 Q2561.29 1795.79 2564.9 1795.79 Q2568.53 1795.79 2570.34 1792.25 Q2572.17 1788.68 2572.17 1781.58 Q2572.17 1774.45 2570.34 1770.9 Q2568.53 1767.34 2564.9 1767.34 M2564.9 1763.64 Q2570.71 1763.64 2573.76 1768.24 Q2576.84 1772.83 2576.84 1781.58 Q2576.84 1790.3 2573.76 1794.91 Q2570.71 1799.49 2564.9 1799.49 Q2559.09 1799.49 2556.01 1794.91 Q2552.95 1790.3 2552.95 1781.58 Q2552.95 1772.83 2556.01 1768.24 Q2559.09 1763.64 2564.9 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2585.06 1792.94 L2589.94 1792.94 L2589.94 1798.82 L2585.06 1798.82 L2585.06 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2610.13 1767.34 Q2606.52 1767.34 2604.69 1770.9 Q2602.88 1774.45 2602.88 1781.58 Q2602.88 1788.68 2604.69 1792.25 Q2606.52 1795.79 2610.13 1795.79 Q2613.76 1795.79 2615.57 1792.25 Q2617.4 1788.68 2617.4 1781.58 Q2617.4 1774.45 2615.57 1770.9 Q2613.76 1767.34 2610.13 1767.34 M2610.13 1763.64 Q2615.94 1763.64 2619 1768.24 Q2622.07 1772.83 2622.07 1781.58 Q2622.07 1790.3 2619 1794.91 Q2615.94 1799.49 2610.13 1799.49 Q2604.32 1799.49 2601.24 1794.91 Q2598.18 1790.3 2598.18 1781.58 Q2598.18 1772.83 2601.24 1768.24 Q2604.32 1763.64 2610.13 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M1436.3 1833.78 L1442.19 1833.78 L1442.19 1863.03 L1459.66 1847.65 L1467.14 1847.65 L1448.23 1864.33 L1467.94 1883.3 L1460.3 1883.3 L1442.19 1865.89 L1442.19 1883.3 L1436.3 1883.3 L1436.3 1833.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1734.12 263.478,1007.24 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1717.04 282.376,1717.04 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1487.3 282.376,1487.3 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1257.56 282.376,1257.56 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1027.82 282.376,1027.82 "></polyline>
<path clip-path="url(#clip750)" d="M211.214 1702.84 Q207.603 1702.84 205.774 1706.41 Q203.969 1709.95 203.969 1717.08 Q203.969 1724.18 205.774 1727.75 Q207.603 1731.29 211.214 1731.29 Q214.848 1731.29 216.654 1727.75 Q218.482 1724.18 218.482 1717.08 Q218.482 1709.95 216.654 1706.41 Q214.848 1702.84 211.214 1702.84 M211.214 1699.14 Q217.024 1699.14 220.08 1703.74 Q223.158 1708.33 223.158 1717.08 Q223.158 1725.81 220.08 1730.41 Q217.024 1734.99 211.214 1734.99 Q205.404 1734.99 202.325 1730.41 Q199.27 1725.81 199.27 1717.08 Q199.27 1708.33 202.325 1703.74 Q205.404 1699.14 211.214 1699.14 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M203.251 1500.65 L210.89 1500.65 L210.89 1474.28 L202.58 1475.95 L202.58 1471.69 L210.844 1470.02 L215.519 1470.02 L215.519 1500.65 L223.158 1500.65 L223.158 1504.58 L203.251 1504.58 L203.251 1500.65 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M206.839 1270.9 L223.158 1270.9 L223.158 1274.84 L201.214 1274.84 L201.214 1270.9 Q203.876 1268.15 208.459 1263.52 Q213.066 1258.87 214.246 1257.52 Q216.492 1255 217.371 1253.26 Q218.274 1251.51 218.274 1249.82 Q218.274 1247.06 216.33 1245.32 Q214.408 1243.59 211.307 1243.59 Q209.107 1243.59 206.654 1244.35 Q204.223 1245.12 201.445 1246.67 L201.445 1241.95 Q204.27 1240.81 206.723 1240.23 Q209.177 1239.65 211.214 1239.65 Q216.584 1239.65 219.779 1242.34 Q222.973 1245.02 222.973 1249.51 Q222.973 1251.64 222.163 1253.57 Q221.376 1255.46 219.269 1258.06 Q218.691 1258.73 215.589 1261.95 Q212.487 1265.14 206.839 1270.9 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M216.029 1026.46 Q219.385 1027.18 221.26 1029.45 Q223.158 1031.72 223.158 1035.05 Q223.158 1040.17 219.64 1042.97 Q216.121 1045.77 209.64 1045.77 Q207.464 1045.77 205.149 1045.33 Q202.857 1044.91 200.404 1044.05 L200.404 1039.54 Q202.348 1040.67 204.663 1041.25 Q206.978 1041.83 209.501 1041.83 Q213.899 1041.83 216.191 1040.1 Q218.506 1038.36 218.506 1035.05 Q218.506 1031.99 216.353 1030.28 Q214.223 1028.55 210.404 1028.55 L206.376 1028.55 L206.376 1024.7 L210.589 1024.7 Q214.038 1024.7 215.867 1023.34 Q217.695 1021.95 217.695 1019.36 Q217.695 1016.69 215.797 1015.28 Q213.922 1013.85 210.404 1013.85 Q208.482 1013.85 206.283 1014.26 Q204.084 1014.68 201.445 1015.56 L201.445 1011.39 Q204.107 1010.65 206.422 1010.28 Q208.76 1009.91 210.82 1009.91 Q216.144 1009.91 219.246 1012.34 Q222.348 1014.75 222.348 1018.87 Q222.348 1021.74 220.705 1023.73 Q219.061 1025.7 216.029 1026.46 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M109.046 1354.07 L126.392 1366.96 L144.694 1353.4 L144.694 1360.3 L130.689 1370.68 L144.694 1381.06 L144.694 1387.96 L126.042 1374.12 L109.046 1386.79 L109.046 1379.88 L121.745 1370.43 L109.046 1360.97 L109.046 1354.07 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip753)" d="M330.76 1471.3 L314.76 1487.3 L330.76 1503.3 L346.76 1487.3 L330.76 1471.3 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M555.031 1274.91 L539.031 1290.91 L555.031 1306.91 L571.031 1290.91 L555.031 1274.91 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M779.303 1465.35 L763.303 1481.35 L779.303 1497.35 L795.303 1481.35 L779.303 1465.35 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1003.57 1557.2 L987.574 1573.2 L1003.57 1589.2 L1019.57 1573.2 L1003.57 1557.2 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1227.85 1614.32 L1211.85 1630.32 L1227.85 1646.32 L1243.85 1630.32 L1227.85 1614.32 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1452.12 1648.63 L1436.12 1664.63 L1452.12 1680.63 L1468.12 1664.63 L1452.12 1648.63 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1676.39 1669.29 L1660.39 1685.29 L1676.39 1701.29 L1692.39 1685.29 L1676.39 1669.29 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1900.66 1681.67 L1884.66 1697.67 L1900.66 1713.67 L1916.66 1697.67 L1900.66 1681.67 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M2124.93 1689.01 L2108.93 1705.01 L2124.93 1721.01 L2140.93 1705.01 L2124.93 1689.01 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M2349.2 1693.2 L2333.2 1709.2 L2349.2 1725.2 L2365.2 1709.2 L2349.2 1693.2 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M2573.47 1695.36 L2557.47 1711.36 L2573.47 1727.36 L2589.47 1711.36 L2573.47 1695.36 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip753)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="330.76,1487.3 555.031,1487.3 555.031,1290.91 779.303,1290.91 779.303,1481.35 1003.57,1481.35 1003.57,1573.2 1227.85,1573.2 1227.85,1630.32 1452.12,1630.32 1452.12,1664.63 1676.39,1664.63 1676.39,1685.29 1900.66,1685.29 1900.66,1697.67 2124.93,1697.67 2124.93,1705.01 2349.2,1705.01 2349.2,1709.2 2573.47,1709.2 2573.47,1711.36 "></polyline>
<path clip-path="url(#clip753)" d="M330.76 1011.82 L314.76 1027.82 L330.76 1043.82 L346.76 1027.82 L330.76 1011.82 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M555.031 1587.03 L539.031 1603.03 L555.031 1619.03 L571.031 1603.03 L555.031 1587.03 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M779.303 1609.71 L763.303 1625.71 L779.303 1641.71 L795.303 1625.71 L779.303 1609.71 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1003.57 1647.57 L987.574 1663.57 L1003.57 1679.57 L1019.57 1663.57 L1003.57 1647.57 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1227.85 1668.6 L1211.85 1684.6 L1227.85 1700.6 L1243.85 1684.6 L1227.85 1668.6 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1452.12 1681.37 L1436.12 1697.37 L1452.12 1713.37 L1468.12 1697.37 L1452.12 1681.37 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1676.39 1689.01 L1660.39 1705.01 L1676.39 1721.01 L1692.39 1705.01 L1676.39 1689.01 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M1900.66 1693.51 L1884.66 1709.51 L1900.66 1725.51 L1916.66 1709.51 L1900.66 1693.51 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M2124.93 1696.04 L2108.93 1712.04 L2124.93 1728.04 L2140.93 1712.04 L2124.93 1696.04 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M2349.2 1697.27 L2333.2 1713.27 L2349.2 1729.27 L2365.2 1713.27 L2349.2 1697.27 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip753)" d="M2573.47 1697.55 L2557.47 1713.55 L2573.47 1729.55 L2589.47 1713.55 L2573.47 1697.55 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip753)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="330.76,1027.82 555.031,1027.82 555.031,1603.03 779.303,1603.03 779.303,1625.71 1003.57,1625.71 1003.57,1663.57 1227.85,1663.57 1227.85,1684.6 1452.12,1684.6 1452.12,1697.37 1676.39,1697.37 1676.39,1705.01 1900.66,1705.01 1900.66,1709.51 2124.93,1709.51 2124.93,1712.04 2349.2,1712.04 2349.2,1713.27 2573.47,1713.27 2573.47,1713.55 "></polyline>
<path clip-path="url(#clip750)" d="M2280.68 1186.99 L2561.51 1186.99 L2561.51 1031.47 L2280.68 1031.47  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip750)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2280.68,1186.99 2561.51,1186.99 2561.51,1031.47 2280.68,1031.47 2280.68,1186.99 "></polyline>
<polyline clip-path="url(#clip750)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2307.1,1083.31 2465.58,1083.31 "></polyline>
<path clip-path="url(#clip750)" d="M2516.65 1074.67 L2507.28 1087.28 L2517.14 1100.59 L2512.11 1100.59 L2504.57 1090.41 L2497.02 1100.59 L2492 1100.59 L2502.07 1087.03 L2492.85 1074.67 L2497.88 1074.67 L2504.75 1083.9 L2511.63 1074.67 L2516.65 1074.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2522.3 1098.05 L2527.02 1098.05 L2527.02 1083.9 L2521.86 1084.85 L2521.86 1082.17 L2527.18 1081.26 L2530.35 1081.26 L2530.35 1098.05 L2535.1 1098.05 L2535.1 1100.59 L2522.3 1100.59 L2522.3 1098.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip750)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2307.1,1135.15 2465.58,1135.15 "></polyline>
<path clip-path="url(#clip750)" d="M2516.65 1126.51 L2507.28 1139.12 L2517.14 1152.43 L2512.11 1152.43 L2504.57 1142.25 L2497.02 1152.43 L2492 1152.43 L2502.07 1138.87 L2492.85 1126.51 L2497.88 1126.51 L2504.75 1135.74 L2511.63 1126.51 L2516.65 1126.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip750)" d="M2524.89 1149.79 L2534.71 1149.79 L2534.71 1152.43 L2520.86 1152.43 L2520.86 1149.89 Q2521.65 1149.17 2523.11 1147.87 Q2531.07 1140.81 2531.07 1138.64 Q2531.07 1137.11 2529.87 1136.18 Q2528.66 1135.23 2526.7 1135.23 Q2525.49 1135.23 2524.08 1135.65 Q2522.67 1136.04 2521 1136.85 L2521 1134.01 Q2522.78 1133.36 2524.31 1133.04 Q2525.86 1132.71 2527.18 1132.71 Q2530.54 1132.71 2532.55 1134.24 Q2534.57 1135.77 2534.57 1138.27 Q2534.57 1141.48 2526.9 1148.06 Q2525.61 1149.17 2524.89 1149.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
</div>
<section id="adding-constraints-on-controls-and-states" class="level3">
<h3 class="anchored" data-anchor-id="adding-constraints-on-controls-and-states">Adding constraints on controls and states</h3>
<p>When solving a realistic optimal control problem, we may want to impose inequality constraints on <span class="math inline">\bm u_k</span> due to saturation of actuators. We may also want to add constraints on <span class="math inline">\bm x_k</span> as well, which may reflect some performance specifications. In both cases, we would arrive at the full KKT conditions, and rather than trying to solve these, we resort to some finetuned numerical solver for quadratic programming (QP) instead.</p>
</section>
</section>
<section id="sequential-dense-formulation" class="level2">
<h2 class="anchored" data-anchor-id="sequential-dense-formulation">Sequential (dense) formulation</h2>
<p>We can express <span class="math inline">\bar{\bm x}</span> as a function of <span class="math inline">\bar{\bm u}</span> and <span class="math inline">\mathbf x_0</span>. This can be done in a straightforward way using (<a href="#eq-linear_system_linear_constraints_matrix_format" class="quarto-xref">Eq.&nbsp;1</a>), namely, <span class="math display">
\bar{\bm x} = (\mathbf I-\overline{\mathbf A})^{-1}\overline{\mathbf B} \bm u + (\mathbf I-\overline{\mathbf A})^{-1} \overline{\mathbf A}_0 \mathbf x_0.
</span></p>
<p>However, instead of solving the sets of equations, we can do this substitution in a more insightful way. Write down the state equation for several discrete times <span class="math display">
\begin{aligned}
\bm x_1 &amp;= \mathbf A\mathbf x_0 + \mathbf B\bm u_0\\
\bm x_2 &amp;= \mathbf A\mathbf x_0 + \mathbf B\bm u_0\\
     &amp;= \mathbf A(\mathbf A\mathbf x_0 + \mathbf B\bm u_0)+ \mathbf B\bm u_0\\
     &amp;= \mathbf A^2\mathbf x_0 + \mathbf A\mathbf B\bm u_0 + \mathbf B\bm u_0\\
     &amp;\vdots\\
\bm x_k &amp;= \mathbf A^k\mathbf x_0 + \mathbf A^{k-1}\mathbf B\bm u_0 +\mathbf A^{k-2}\mathbf B\bm u_1 +\ldots \mathbf B\bm u_{k-1}.
\end{aligned}
</span></p>
<p>Rewriting into matrix-vector form (and extending the time <span class="math inline">k</span> up to the final time <span class="math inline">N</span>) <span class="math display">
\begin{bmatrix}
\bm x_1\\\bm x_2\\\vdots\\\bm x_N
\end{bmatrix}
=
\underbrace{
\begin{bmatrix}
  \mathbf B &amp; &amp; &amp; \\
  \mathbf A\mathbf B &amp; \mathbf B &amp; &amp; \\
  \vdots &amp; &amp; \ddots &amp;\\
  \mathbf A^{N-1}\mathbf B &amp; \mathbf A^{N-2}\mathbf B &amp; &amp; \mathbf B
\end{bmatrix}}_{\widehat{\mathbf C}}
  \begin{bmatrix}
\bm u_0\\\bm u_1\\\vdots\\\bm u_{N-1}
\end{bmatrix}
+
\underbrace{
  \begin{bmatrix}
\mathbf A\\\mathbf A^2\\\vdots\\\mathbf A^N
\end{bmatrix}}_{\widehat{\mathbf A}}\mathbf x_0.
</span></p>
<p>For convenience, let’s rewrite the compact relation between <span class="math inline">\bar{\bm x}</span> and <span class="math inline">\bar{\bm u}</span> and <span class="math inline">\mathbf x_0</span> <span id="eq-x_as_function_of_u_and_x0"><span class="math display">
\bar{\bm x} = \widehat{\mathbf C} \bar{\bm u} + \widehat{\mathbf A} \mathbf x_0.
\tag{2}</span></span></p>
<p>We can now substitute this into the original cost, which then becomes independent of <span class="math inline">\bar{\bm x}</span>, which we reflect formally by using a new name <span class="math inline">\tilde J</span> <span class="math display">
\begin{aligned}
\tilde J(\bar{\bm u};\mathbf x_0) &amp;= \frac{1}{2}(\widehat{\mathbf C} \bar{\bm u} + \widehat{\mathbf A} \mathbf x_0)^\top\overline{\mathbf Q} (\widehat{\mathbf C} \bar{\bm u} + \widehat{\mathbf A} \mathbf x_0) + \frac{1}{2}\bar{\bm u}^\top\overline{\mathbf R} \bar{\bm u} + \frac{1}{2}\mathbf x_0^\top\mathbf Q\mathbf x_0\\
&amp;= \frac{1}{2}\bar{\bm u}^\top\widehat{\mathbf C}^\top \overline{\mathbf Q} \widehat{\mathbf C} \bar{\bm u} + \mathbf x_0^\top\widehat{\mathbf A}^\top \overline{\mathbf Q} \widehat{\mathbf C} \bar{\bm u} + \frac{1}{2} \mathbf x_0^\top\widehat{\mathbf A}^\top \overline{\mathbf Q} \widehat{\mathbf A} \mathbf x_0 + \frac{1}{2}\bar{\bm u}^\top\overline{\mathbf R} \bar{\bm u} + \frac{1}{2}\mathbf x_0^\top\mathbf Q\mathbf x_0\\
&amp;= \frac{1}{2}\bar{\bm u}^\top(\widehat{\mathbf C}^\top \overline{\mathbf Q} \widehat{\mathbf C} + \overline{\mathbf R})\bar{\bm u} + \mathbf x_0^\top\widehat{\mathbf A}^\top \overline{\mathbf Q} \widehat{\mathbf C} \bar{\bm u} + \frac{1}{2} \mathbf x_0^\top(\widehat{\mathbf A}^\top \overline{\mathbf Q} \widehat{\mathbf A} + \mathbf Q)\mathbf x_0.
\end{aligned}
</span></p>
<p>The last term (the one independent of <span class="math inline">\bar{\bm u}</span>) does not have an impact on the optimal <span class="math inline">\bar{\bm u}</span> and therefore it can be discarded, but such minor modification perhaps does not justify a new name for the cost function. We write it as <span class="math display">
\tilde J(\bar{\bm u};\mathbf x_0) = \frac{1}{2}\bar{\bm u}^\top\underbrace{(\widehat{\mathbf C}^\top \overline{\mathbf Q} \widehat{\mathbf C} + \overline{\mathbf R})}_{\mathbf H}\bar{\bm u} +  \mathbf x_0^\top\underbrace{\widehat{\mathbf A}^\top \overline{\mathbf Q} \widehat{\mathbf C}}_{\mathbf F^\top} \bar{\bm u}.
</span></p>
<p>This cost is a function of <span class="math inline">\bar{\bm u}</span>, the initial state <span class="math inline">\mathbf x_0</span> is regarded as a fixed parameter. Its gradient is <span class="math display">
\nabla \tilde J = \mathbf H\bar{\bm u}+\mathbf F\mathbf x_0.
</span></p>
<p>Setting it to zero leads to the following linear system of equations <span class="math display">
\mathbf H\bar{\bm u}=-\mathbf F\mathbf x_0
</span> that needs to be solved for <span class="math inline">\bar{\bm u}</span>. Formally, we write the solution as <span class="math display">
\bar{\bm u} = -\mathbf H^{-1} \mathbf F \mathbf x_0.
</span></p>
<div id="exm-direct-sequential" class="theorem example">
<p><span class="theorem-title"><strong>Example 2 (Reformulating the unconstrained LQR problem as a system of linear equations – sequential approach)</strong></span> &nbsp;</p>
<div id="4" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">direct_dlqr_sequential</span>(A,B,x₀,Q,R,S,N)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">size</span>(A)[<span class="fl">1</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="fu">size</span>(B)[<span class="fl">2</span>]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    Q̄ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,N<span class="op">*</span>n),<span class="fu">repeat</span>([n],N),<span class="fu">repeat</span>([n],N))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        Q̄[<span class="fu">Block</span>(i,i)] <span class="op">=</span> Q</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    Q̄[<span class="fu">Block</span>(N,N)] <span class="op">=</span> S</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    R̄ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>m,N<span class="op">*</span>m),<span class="fu">repeat</span>([m],N),<span class="fu">repeat</span>([m],N))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        R̄[<span class="fu">Block</span>(i,i)] <span class="op">=</span> R</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    Ĉ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,N<span class="op">*</span>m),<span class="fu">repeat</span>([n],N),<span class="fu">repeat</span>([m],N))</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    Â <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,n),<span class="fu">repeat</span>([n],N),[n])</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>i</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>            Ĉ[<span class="fu">Block</span>(i,j)] <span class="op">=</span> A<span class="op">^</span>(i<span class="op">-</span>j)<span class="op">*</span>B</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>            Â[<span class="fu">Block</span>(i,<span class="fl">1</span>)] <span class="op">=</span> A<span class="op">^</span>i</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> Ĉ<span class="ch">'*Q̄*Ĉ + R̄</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> <span class="fu">Array</span>(H)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> Ĉ<span class="ch">'*Q̄*Â</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> <span class="fu">Array</span>(F)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    uopt <span class="op">=</span> <span class="fu">-H\</span>(F<span class="op">*</span>x₀)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    xopt <span class="op">=</span> Ĉ<span class="op">*</span>uopt <span class="op">+</span> Â<span class="op">*</span>x₀</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    xopt <span class="op">=</span> <span class="fu">reshape</span>(xopt,(<span class="fl">2</span>,<span class="op">:</span>))</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> xopt,uopt</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="fl">2</span>               <span class="co"># Number of state variables.</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1</span>               <span class="co"># Number of (control) input variables. </span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> <span class="fu">rand</span>(n,n)       <span class="co"># State matrix.</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> <span class="fu">rand</span>(n,m)       <span class="co"># Input coupling matrix.</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>x₀ <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">3.0</span>]     <span class="co"># Initial state.</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">10</span>              <span class="co"># Time horizon.</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">2.0</span>]      </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">2.0</span>]</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> [<span class="fl">1.0</span>]</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>s)     <span class="co"># Matrix defining the terminal state cost.</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>q)     <span class="co"># Matrix defining the running state dost.</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>r)     <span class="co"># Matrix defining the cost of control.</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>xopt,uopt <span class="op">=</span> <span class="fu">direct_dlqr_sequential</span>(A,B,x₀,Q,R,S,N)</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> <span class="fu">plot</span>(<span class="fl">0</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>),uopt,marker<span class="op">=:</span>diamond,label<span class="op">=</span><span class="st">"u"</span>,linetype<span class="op">=:</span>steppost)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel!</span>(<span class="st">"k"</span>)</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel!</span>(<span class="st">"u"</span>)</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> <span class="fu">plot</span>(<span class="fl">0</span><span class="op">:</span>N,<span class="fu">hcat</span>(x₀,xopt)<span class="ch">',marker=:diamond,label=["x₁" "x₂"],linetype=:steppost)</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel!</span>(<span class="st">"k"</span>)</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel!</span>(<span class="st">"x"</span>)</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p1,p2,layout<span class="op">=</span>(<span class="fl">2</span>,<span class="fl">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip810">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip810)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip811">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip810)" d="M263.478 774.117 L2640.76 774.117 L2640.76 47.2441 L263.478 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip812">
    <rect x="263" y="47" width="2378" height="728"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="330.76,774.117 330.76,47.2441 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="829.141,774.117 829.141,47.2441 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1327.52,774.117 1327.52,47.2441 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1825.9,774.117 1825.9,47.2441 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2324.28,774.117 2324.28,47.2441 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,618.717 2640.76,618.717 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,434.748 2640.76,434.748 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,250.779 2640.76,250.779 "></polyline>
<polyline clip-path="url(#clip812)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,66.8104 2640.76,66.8104 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,774.117 2640.76,774.117 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="330.76,774.117 330.76,755.219 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="829.141,774.117 829.141,755.219 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1327.52,774.117 1327.52,755.219 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1825.9,774.117 1825.9,755.219 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2324.28,774.117 2324.28,755.219 "></polyline>
<path clip-path="url(#clip810)" d="M330.76 807.34 Q327.149 807.34 325.32 810.904 Q323.514 814.446 323.514 821.576 Q323.514 828.682 325.32 832.247 Q327.149 835.789 330.76 835.789 Q334.394 835.789 336.2 832.247 Q338.028 828.682 338.028 821.576 Q338.028 814.446 336.2 810.904 Q334.394 807.34 330.76 807.34 M330.76 803.636 Q336.57 803.636 339.625 808.242 Q342.704 812.826 342.704 821.576 Q342.704 830.303 339.625 834.909 Q336.57 839.492 330.76 839.492 Q324.95 839.492 321.871 834.909 Q318.815 830.303 318.815 821.576 Q318.815 812.826 321.871 808.242 Q324.95 803.636 330.76 803.636 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M823.794 834.886 L840.113 834.886 L840.113 838.821 L818.169 838.821 L818.169 834.886 Q820.831 832.131 825.414 827.502 Q830.02 822.849 831.201 821.506 Q833.446 818.983 834.326 817.247 Q835.229 815.488 835.229 813.798 Q835.229 811.043 833.284 809.307 Q831.363 807.571 828.261 807.571 Q826.062 807.571 823.608 808.335 Q821.178 809.099 818.4 810.65 L818.4 805.928 Q821.224 804.793 823.678 804.215 Q826.132 803.636 828.169 803.636 Q833.539 803.636 836.733 806.321 Q839.928 809.006 839.928 813.497 Q839.928 815.627 839.118 817.548 Q838.331 819.446 836.224 822.039 Q835.645 822.71 832.544 825.928 Q829.442 829.122 823.794 834.886 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1330.53 808.335 L1318.73 826.784 L1330.53 826.784 L1330.53 808.335 M1329.3 804.261 L1335.18 804.261 L1335.18 826.784 L1340.11 826.784 L1340.11 830.673 L1335.18 830.673 L1335.18 838.821 L1330.53 838.821 L1330.53 830.673 L1314.93 830.673 L1314.93 826.159 L1329.3 804.261 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1826.31 819.678 Q1823.16 819.678 1821.31 821.83 Q1819.48 823.983 1819.48 827.733 Q1819.48 831.46 1821.31 833.636 Q1823.16 835.789 1826.31 835.789 Q1829.46 835.789 1831.28 833.636 Q1833.14 831.46 1833.14 827.733 Q1833.14 823.983 1831.28 821.83 Q1829.46 819.678 1826.31 819.678 M1835.59 805.025 L1835.59 809.284 Q1833.83 808.451 1832.03 808.011 Q1830.24 807.571 1828.48 807.571 Q1823.85 807.571 1821.4 810.696 Q1818.97 813.821 1818.62 820.141 Q1819.99 818.127 1822.05 817.062 Q1824.11 815.974 1826.59 815.974 Q1831.79 815.974 1834.8 819.145 Q1837.84 822.293 1837.84 827.733 Q1837.84 833.057 1834.69 836.275 Q1831.54 839.492 1826.31 839.492 Q1820.31 839.492 1817.14 834.909 Q1813.97 830.303 1813.97 821.576 Q1813.97 813.381 1817.86 808.52 Q1821.75 803.636 1828.3 803.636 Q1830.06 803.636 1831.84 803.983 Q1833.65 804.33 1835.59 805.025 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2324.28 822.409 Q2320.95 822.409 2319.03 824.191 Q2317.13 825.974 2317.13 829.099 Q2317.13 832.224 2319.03 834.006 Q2320.95 835.789 2324.28 835.789 Q2327.62 835.789 2329.54 834.006 Q2331.46 832.201 2331.46 829.099 Q2331.46 825.974 2329.54 824.191 Q2327.64 822.409 2324.28 822.409 M2319.61 820.418 Q2316.6 819.678 2314.91 817.617 Q2313.24 815.557 2313.24 812.594 Q2313.24 808.451 2316.18 806.043 Q2319.15 803.636 2324.28 803.636 Q2329.45 803.636 2332.39 806.043 Q2335.33 808.451 2335.33 812.594 Q2335.33 815.557 2333.64 817.617 Q2331.97 819.678 2328.98 820.418 Q2332.36 821.205 2334.24 823.497 Q2336.14 825.789 2336.14 829.099 Q2336.14 834.122 2333.06 836.807 Q2330 839.492 2324.28 839.492 Q2318.57 839.492 2315.49 836.807 Q2312.43 834.122 2312.43 829.099 Q2312.43 825.789 2314.33 823.497 Q2316.23 821.205 2319.61 820.418 M2317.9 813.034 Q2317.9 815.719 2319.56 817.224 Q2321.25 818.729 2324.28 818.729 Q2327.29 818.729 2328.98 817.224 Q2330.7 815.719 2330.7 813.034 Q2330.7 810.349 2328.98 808.844 Q2327.29 807.34 2324.28 807.34 Q2321.25 807.34 2319.56 808.844 Q2317.9 810.349 2317.9 813.034 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1436.3 873.776 L1442.19 873.776 L1442.19 903.026 L1459.66 887.653 L1467.14 887.653 L1448.23 904.331 L1467.94 923.301 L1460.3 923.301 L1442.19 905.891 L1442.19 923.301 L1436.3 923.301 L1436.3 873.776 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,774.117 263.478,47.2441 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,618.717 282.376,618.717 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,434.748 282.376,434.748 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,250.779 282.376,250.779 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,66.8104 282.376,66.8104 "></polyline>
<path clip-path="url(#clip810)" d="M117.21 619.168 L146.886 619.168 L146.886 623.104 L117.21 623.104 L117.21 619.168 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M157.788 632.062 L165.427 632.062 L165.427 605.696 L157.117 607.363 L157.117 603.104 L165.381 601.437 L170.057 601.437 L170.057 632.062 L177.696 632.062 L177.696 635.997 L157.788 635.997 L157.788 632.062 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M187.14 630.117 L192.024 630.117 L192.024 635.997 L187.14 635.997 L187.14 630.117 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M202.256 601.437 L220.612 601.437 L220.612 605.372 L206.538 605.372 L206.538 613.844 Q207.557 613.497 208.575 613.335 Q209.594 613.15 210.612 613.15 Q216.399 613.15 219.779 616.321 Q223.158 619.493 223.158 624.909 Q223.158 630.488 219.686 633.59 Q216.214 636.668 209.894 636.668 Q207.719 636.668 205.45 636.298 Q203.205 635.928 200.797 635.187 L200.797 630.488 Q202.881 631.622 205.103 632.178 Q207.325 632.733 209.802 632.733 Q213.807 632.733 216.144 630.627 Q218.482 628.52 218.482 624.909 Q218.482 621.298 216.144 619.192 Q213.807 617.085 209.802 617.085 Q207.927 617.085 206.052 617.502 Q204.2 617.918 202.256 618.798 L202.256 601.437 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M116.214 435.2 L145.89 435.2 L145.89 439.135 L116.214 439.135 L116.214 435.2 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M156.793 448.093 L164.432 448.093 L164.432 421.727 L156.122 423.394 L156.122 419.135 L164.385 417.468 L169.061 417.468 L169.061 448.093 L176.7 448.093 L176.7 452.028 L156.793 452.028 L156.793 448.093 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M186.145 446.149 L191.029 446.149 L191.029 452.028 L186.145 452.028 L186.145 446.149 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M211.214 420.547 Q207.603 420.547 205.774 424.112 Q203.969 427.653 203.969 434.783 Q203.969 441.889 205.774 445.454 Q207.603 448.996 211.214 448.996 Q214.848 448.996 216.654 445.454 Q218.482 441.889 218.482 434.783 Q218.482 427.653 216.654 424.112 Q214.848 420.547 211.214 420.547 M211.214 416.843 Q217.024 416.843 220.08 421.45 Q223.158 426.033 223.158 434.783 Q223.158 443.51 220.08 448.116 Q217.024 452.699 211.214 452.699 Q205.404 452.699 202.325 448.116 Q199.27 443.51 199.27 434.783 Q199.27 426.033 202.325 421.45 Q205.404 416.843 211.214 416.843 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M117.21 251.231 L146.886 251.231 L146.886 255.166 L117.21 255.166 L117.21 251.231 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M166.978 236.578 Q163.367 236.578 161.538 240.143 Q159.733 243.684 159.733 250.814 Q159.733 257.92 161.538 261.485 Q163.367 265.027 166.978 265.027 Q170.612 265.027 172.418 261.485 Q174.247 257.92 174.247 250.814 Q174.247 243.684 172.418 240.143 Q170.612 236.578 166.978 236.578 M166.978 232.874 Q172.788 232.874 175.844 237.481 Q178.922 242.064 178.922 250.814 Q178.922 259.541 175.844 264.147 Q172.788 268.731 166.978 268.731 Q161.168 268.731 158.089 264.147 Q155.034 259.541 155.034 250.814 Q155.034 242.064 158.089 237.481 Q161.168 232.874 166.978 232.874 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M187.14 262.18 L192.024 262.18 L192.024 268.059 L187.14 268.059 L187.14 262.18 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M202.256 233.499 L220.612 233.499 L220.612 237.434 L206.538 237.434 L206.538 245.907 Q207.557 245.559 208.575 245.397 Q209.594 245.212 210.612 245.212 Q216.399 245.212 219.779 248.383 Q223.158 251.555 223.158 256.971 Q223.158 262.55 219.686 265.652 Q216.214 268.731 209.894 268.731 Q207.719 268.731 205.45 268.36 Q203.205 267.99 200.797 267.249 L200.797 262.55 Q202.881 263.684 205.103 264.24 Q207.325 264.795 209.802 264.795 Q213.807 264.795 216.144 262.689 Q218.482 260.583 218.482 256.971 Q218.482 253.36 216.144 251.254 Q213.807 249.147 209.802 249.147 Q207.927 249.147 206.052 249.564 Q204.2 249.981 202.256 250.86 L202.256 233.499 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M165.983 52.6091 Q162.372 52.6091 160.543 56.1739 Q158.737 59.7156 158.737 66.8452 Q158.737 73.9516 160.543 77.5164 Q162.372 81.058 165.983 81.058 Q169.617 81.058 171.422 77.5164 Q173.251 73.9516 173.251 66.8452 Q173.251 59.7156 171.422 56.1739 Q169.617 52.6091 165.983 52.6091 M165.983 48.9054 Q171.793 48.9054 174.848 53.5119 Q177.927 58.0952 177.927 66.8452 Q177.927 75.572 174.848 80.1784 Q171.793 84.7617 165.983 84.7617 Q160.173 84.7617 157.094 80.1784 Q154.038 75.572 154.038 66.8452 Q154.038 58.0952 157.094 53.5119 Q160.173 48.9054 165.983 48.9054 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M186.145 78.2108 L191.029 78.2108 L191.029 84.0904 L186.145 84.0904 L186.145 78.2108 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M211.214 52.6091 Q207.603 52.6091 205.774 56.1739 Q203.969 59.7156 203.969 66.8452 Q203.969 73.9516 205.774 77.5164 Q207.603 81.058 211.214 81.058 Q214.848 81.058 216.654 77.5164 Q218.482 73.9516 218.482 66.8452 Q218.482 59.7156 216.654 56.1739 Q214.848 52.6091 211.214 52.6091 M211.214 48.9054 Q217.024 48.9054 220.08 53.5119 Q223.158 58.0952 223.158 66.8452 Q223.158 75.572 220.08 80.1784 Q217.024 84.7617 211.214 84.7617 Q205.404 84.7617 202.325 80.1784 Q199.27 75.572 199.27 66.8452 Q199.27 58.0952 202.325 53.5119 Q205.404 48.9054 211.214 48.9054 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M47.5702 425.608 L25.9905 425.608 L25.9905 419.752 L47.3474 419.752 Q52.4082 419.752 54.9545 417.778 Q57.4689 415.805 57.4689 411.858 Q57.4689 407.116 54.4452 404.378 Q51.4215 401.609 46.2016 401.609 L25.9905 401.609 L25.9905 395.753 L61.6384 395.753 L61.6384 401.609 L56.1639 401.609 Q59.4104 403.742 61.0019 406.575 Q62.5615 409.376 62.5615 413.1 Q62.5615 419.242 58.742 422.425 Q54.9226 425.608 47.5702 425.608 M25.1311 410.872 L25.1311 410.872 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip812)" d="M330.76 737.545 L314.76 753.545 L330.76 769.545 L346.76 753.545 L330.76 737.545 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M579.95 393.239 L563.95 409.239 L579.95 425.239 L595.95 409.239 L579.95 393.239 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M829.141 221.589 L813.141 237.589 L829.141 253.589 L845.141 237.589 L829.141 221.589 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M1078.33 135.98 L1062.33 151.98 L1078.33 167.98 L1094.33 151.98 L1078.33 135.98 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M1327.52 93.2804 L1311.52 109.28 L1327.52 125.28 L1343.52 109.28 L1327.52 93.2804 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M1576.71 71.9775 L1560.71 87.9775 L1576.71 103.977 L1592.71 87.9775 L1576.71 71.9775 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M1825.9 61.3387 L1809.9 77.3387 L1825.9 93.3387 L1841.9 77.3387 L1825.9 61.3387 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M2075.09 56.0042 L2059.09 72.0042 L2075.09 88.0042 L2091.09 72.0042 L2075.09 56.0042 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M2324.28 53.2864 L2308.28 69.2864 L2324.28 85.2864 L2340.28 69.2864 L2324.28 53.2864 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip812)" d="M2573.47 51.816 L2557.47 67.816 L2573.47 83.816 L2589.47 67.816 L2573.47 51.816 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip812)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="330.76,753.545 579.95,753.545 579.95,409.239 829.141,409.239 829.141,237.589 1078.33,237.589 1078.33,151.98 1327.52,151.98 1327.52,109.28 1576.71,109.28 1576.71,87.9775 1825.9,87.9775 1825.9,77.3387 2075.09,77.3387 2075.09,72.0042 2324.28,72.0042 2324.28,69.2864 2573.47,69.2864 2573.47,67.816 "></polyline>
<path clip-path="url(#clip810)" d="M342.721 175.153 L602.162 175.153 L602.162 71.4732 L342.721 71.4732  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="342.721,175.153 602.162,175.153 602.162,71.4732 342.721,71.4732 342.721,175.153 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="369.135,123.313 527.62,123.313 "></polyline>
<path clip-path="url(#clip810)" d="M554.034 130.362 L554.034 114.667 L558.294 114.667 L558.294 130.2 Q558.294 133.88 559.729 135.732 Q561.164 137.561 564.034 137.561 Q567.483 137.561 569.474 135.362 Q571.488 133.163 571.488 129.366 L571.488 114.667 L575.747 114.667 L575.747 140.593 L571.488 140.593 L571.488 136.612 Q569.937 138.973 567.877 140.13 Q565.84 141.264 563.132 141.264 Q558.664 141.264 556.349 138.487 Q554.034 135.709 554.034 130.362 M564.752 114.042 L564.752 114.042 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M263.478 1734.12 L2640.76 1734.12 L2640.76 1007.24 L263.478 1007.24  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip813">
    <rect x="263" y="1007" width="2378" height="728"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="330.76,1734.12 330.76,1007.24 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="891.438,1734.12 891.438,1007.24 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1452.12,1734.12 1452.12,1007.24 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2012.8,1734.12 2012.8,1007.24 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2573.47,1734.12 2573.47,1007.24 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,1714.09 2640.76,1714.09 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,1485.33 2640.76,1485.33 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,1256.58 2640.76,1256.58 "></polyline>
<polyline clip-path="url(#clip813)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.478,1027.82 2640.76,1027.82 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1734.12 2640.76,1734.12 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="330.76,1734.12 330.76,1715.22 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="891.438,1734.12 891.438,1715.22 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1452.12,1734.12 1452.12,1715.22 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2012.8,1734.12 2012.8,1715.22 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2573.47,1734.12 2573.47,1715.22 "></polyline>
<path clip-path="url(#clip810)" d="M308.144 1767.34 Q304.533 1767.34 302.704 1770.9 Q300.899 1774.45 300.899 1781.58 Q300.899 1788.68 302.704 1792.25 Q304.533 1795.79 308.144 1795.79 Q311.778 1795.79 313.584 1792.25 Q315.413 1788.68 315.413 1781.58 Q315.413 1774.45 313.584 1770.9 Q311.778 1767.34 308.144 1767.34 M308.144 1763.64 Q313.954 1763.64 317.01 1768.24 Q320.089 1772.83 320.089 1781.58 Q320.089 1790.3 317.01 1794.91 Q313.954 1799.49 308.144 1799.49 Q302.334 1799.49 299.255 1794.91 Q296.2 1790.3 296.2 1781.58 Q296.2 1772.83 299.255 1768.24 Q302.334 1763.64 308.144 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M328.306 1792.94 L333.19 1792.94 L333.19 1798.82 L328.306 1798.82 L328.306 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M353.375 1767.34 Q349.764 1767.34 347.936 1770.9 Q346.13 1774.45 346.13 1781.58 Q346.13 1788.68 347.936 1792.25 Q349.764 1795.79 353.375 1795.79 Q357.01 1795.79 358.815 1792.25 Q360.644 1788.68 360.644 1781.58 Q360.644 1774.45 358.815 1770.9 Q357.01 1767.34 353.375 1767.34 M353.375 1763.64 Q359.186 1763.64 362.241 1768.24 Q365.32 1772.83 365.32 1781.58 Q365.32 1790.3 362.241 1794.91 Q359.186 1799.49 353.375 1799.49 Q347.565 1799.49 344.487 1794.91 Q341.431 1790.3 341.431 1781.58 Q341.431 1772.83 344.487 1768.24 Q347.565 1763.64 353.375 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M863.175 1794.89 L879.494 1794.89 L879.494 1798.82 L857.55 1798.82 L857.55 1794.89 Q860.212 1792.13 864.795 1787.5 Q869.402 1782.85 870.582 1781.51 Q872.827 1778.98 873.707 1777.25 Q874.61 1775.49 874.61 1773.8 Q874.61 1771.04 872.665 1769.31 Q870.744 1767.57 867.642 1767.57 Q865.443 1767.57 862.99 1768.34 Q860.559 1769.1 857.781 1770.65 L857.781 1765.93 Q860.605 1764.79 863.059 1764.21 Q865.513 1763.64 867.55 1763.64 Q872.92 1763.64 876.114 1766.32 Q879.309 1769.01 879.309 1773.5 Q879.309 1775.63 878.499 1777.55 Q877.712 1779.45 875.605 1782.04 Q875.026 1782.71 871.925 1785.93 Q868.823 1789.12 863.175 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M889.309 1792.94 L894.193 1792.94 L894.193 1798.82 L889.309 1798.82 L889.309 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M904.424 1764.26 L922.781 1764.26 L922.781 1768.2 L908.707 1768.2 L908.707 1776.67 Q909.725 1776.32 910.744 1776.16 Q911.762 1775.97 912.781 1775.97 Q918.568 1775.97 921.948 1779.15 Q925.327 1782.32 925.327 1787.73 Q925.327 1793.31 921.855 1796.41 Q918.383 1799.49 912.063 1799.49 Q909.887 1799.49 907.619 1799.12 Q905.374 1798.75 902.966 1798.01 L902.966 1793.31 Q905.049 1794.45 907.272 1795 Q909.494 1795.56 911.971 1795.56 Q915.975 1795.56 918.313 1793.45 Q920.651 1791.34 920.651 1787.73 Q920.651 1784.12 918.313 1782.02 Q915.975 1779.91 911.971 1779.91 Q910.096 1779.91 908.221 1780.33 Q906.369 1780.74 904.424 1781.62 L904.424 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1419.28 1764.26 L1437.64 1764.26 L1437.64 1768.2 L1423.56 1768.2 L1423.56 1776.67 Q1424.58 1776.32 1425.6 1776.16 Q1426.62 1775.97 1427.64 1775.97 Q1433.43 1775.97 1436.8 1779.15 Q1440.18 1782.32 1440.18 1787.73 Q1440.18 1793.31 1436.71 1796.41 Q1433.24 1799.49 1426.92 1799.49 Q1424.74 1799.49 1422.48 1799.12 Q1420.23 1798.75 1417.82 1798.01 L1417.82 1793.31 Q1419.91 1794.45 1422.13 1795 Q1424.35 1795.56 1426.83 1795.56 Q1430.83 1795.56 1433.17 1793.45 Q1435.51 1791.34 1435.51 1787.73 Q1435.51 1784.12 1433.17 1782.02 Q1430.83 1779.91 1426.83 1779.91 Q1424.95 1779.91 1423.08 1780.33 Q1421.23 1780.74 1419.28 1781.62 L1419.28 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1449.4 1792.94 L1454.28 1792.94 L1454.28 1798.82 L1449.4 1798.82 L1449.4 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1474.47 1767.34 Q1470.86 1767.34 1469.03 1770.9 Q1467.22 1774.45 1467.22 1781.58 Q1467.22 1788.68 1469.03 1792.25 Q1470.86 1795.79 1474.47 1795.79 Q1478.1 1795.79 1479.91 1792.25 Q1481.74 1788.68 1481.74 1781.58 Q1481.74 1774.45 1479.91 1770.9 Q1478.1 1767.34 1474.47 1767.34 M1474.47 1763.64 Q1480.28 1763.64 1483.33 1768.24 Q1486.41 1772.83 1486.41 1781.58 Q1486.41 1790.3 1483.33 1794.91 Q1480.28 1799.49 1474.47 1799.49 Q1468.66 1799.49 1465.58 1794.91 Q1462.52 1790.3 1462.52 1781.58 Q1462.52 1772.83 1465.58 1768.24 Q1468.66 1763.64 1474.47 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1979.12 1764.26 L2001.34 1764.26 L2001.34 1766.25 L1988.79 1798.82 L1983.91 1798.82 L1995.71 1768.2 L1979.12 1768.2 L1979.12 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2010.46 1792.94 L2015.34 1792.94 L2015.34 1798.82 L2010.46 1798.82 L2010.46 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2025.57 1764.26 L2043.93 1764.26 L2043.93 1768.2 L2029.86 1768.2 L2029.86 1776.67 Q2030.87 1776.32 2031.89 1776.16 Q2032.91 1775.97 2033.93 1775.97 Q2039.72 1775.97 2043.1 1779.15 Q2046.48 1782.32 2046.48 1787.73 Q2046.48 1793.31 2043 1796.41 Q2039.53 1799.49 2033.21 1799.49 Q2031.04 1799.49 2028.77 1799.12 Q2026.52 1798.75 2024.12 1798.01 L2024.12 1793.31 Q2026.2 1794.45 2028.42 1795 Q2030.64 1795.56 2033.12 1795.56 Q2037.12 1795.56 2039.46 1793.45 Q2041.8 1791.34 2041.8 1787.73 Q2041.8 1784.12 2039.46 1782.02 Q2037.12 1779.91 2033.12 1779.91 Q2031.24 1779.91 2029.37 1780.33 Q2027.52 1780.74 2025.57 1781.62 L2025.57 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2525.55 1794.89 L2533.19 1794.89 L2533.19 1768.52 L2524.88 1770.19 L2524.88 1765.93 L2533.14 1764.26 L2537.81 1764.26 L2537.81 1794.89 L2545.45 1794.89 L2545.45 1798.82 L2525.55 1798.82 L2525.55 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2564.9 1767.34 Q2561.29 1767.34 2559.46 1770.9 Q2557.65 1774.45 2557.65 1781.58 Q2557.65 1788.68 2559.46 1792.25 Q2561.29 1795.79 2564.9 1795.79 Q2568.53 1795.79 2570.34 1792.25 Q2572.17 1788.68 2572.17 1781.58 Q2572.17 1774.45 2570.34 1770.9 Q2568.53 1767.34 2564.9 1767.34 M2564.9 1763.64 Q2570.71 1763.64 2573.76 1768.24 Q2576.84 1772.83 2576.84 1781.58 Q2576.84 1790.3 2573.76 1794.91 Q2570.71 1799.49 2564.9 1799.49 Q2559.09 1799.49 2556.01 1794.91 Q2552.95 1790.3 2552.95 1781.58 Q2552.95 1772.83 2556.01 1768.24 Q2559.09 1763.64 2564.9 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2585.06 1792.94 L2589.94 1792.94 L2589.94 1798.82 L2585.06 1798.82 L2585.06 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2610.13 1767.34 Q2606.52 1767.34 2604.69 1770.9 Q2602.88 1774.45 2602.88 1781.58 Q2602.88 1788.68 2604.69 1792.25 Q2606.52 1795.79 2610.13 1795.79 Q2613.76 1795.79 2615.57 1792.25 Q2617.4 1788.68 2617.4 1781.58 Q2617.4 1774.45 2615.57 1770.9 Q2613.76 1767.34 2610.13 1767.34 M2610.13 1763.64 Q2615.94 1763.64 2619 1768.24 Q2622.07 1772.83 2622.07 1781.58 Q2622.07 1790.3 2619 1794.91 Q2615.94 1799.49 2610.13 1799.49 Q2604.32 1799.49 2601.24 1794.91 Q2598.18 1790.3 2598.18 1781.58 Q2598.18 1772.83 2601.24 1768.24 Q2604.32 1763.64 2610.13 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M1436.3 1833.78 L1442.19 1833.78 L1442.19 1863.03 L1459.66 1847.65 L1467.14 1847.65 L1448.23 1864.33 L1467.94 1883.3 L1460.3 1883.3 L1442.19 1865.89 L1442.19 1883.3 L1436.3 1883.3 L1436.3 1833.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1734.12 263.478,1007.24 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1714.09 282.376,1714.09 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1485.33 282.376,1485.33 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1256.58 282.376,1256.58 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.478,1027.82 282.376,1027.82 "></polyline>
<path clip-path="url(#clip810)" d="M211.214 1699.89 Q207.603 1699.89 205.774 1703.46 Q203.969 1707 203.969 1714.13 Q203.969 1721.23 205.774 1724.8 Q207.603 1728.34 211.214 1728.34 Q214.848 1728.34 216.654 1724.8 Q218.482 1721.23 218.482 1714.13 Q218.482 1707 216.654 1703.46 Q214.848 1699.89 211.214 1699.89 M211.214 1696.19 Q217.024 1696.19 220.08 1700.8 Q223.158 1705.38 223.158 1714.13 Q223.158 1722.86 220.08 1727.46 Q217.024 1732.05 211.214 1732.05 Q205.404 1732.05 202.325 1727.46 Q199.27 1722.86 199.27 1714.13 Q199.27 1705.38 202.325 1700.8 Q205.404 1696.19 211.214 1696.19 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M203.251 1498.68 L210.89 1498.68 L210.89 1472.31 L202.58 1473.98 L202.58 1469.72 L210.844 1468.05 L215.519 1468.05 L215.519 1498.68 L223.158 1498.68 L223.158 1502.61 L203.251 1502.61 L203.251 1498.68 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M206.839 1269.92 L223.158 1269.92 L223.158 1273.86 L201.214 1273.86 L201.214 1269.92 Q203.876 1267.17 208.459 1262.54 Q213.066 1257.88 214.246 1256.54 Q216.492 1254.02 217.371 1252.28 Q218.274 1250.52 218.274 1248.83 Q218.274 1246.08 216.33 1244.34 Q214.408 1242.61 211.307 1242.61 Q209.107 1242.61 206.654 1243.37 Q204.223 1244.13 201.445 1245.68 L201.445 1240.96 Q204.27 1239.83 206.723 1239.25 Q209.177 1238.67 211.214 1238.67 Q216.584 1238.67 219.779 1241.36 Q222.973 1244.04 222.973 1248.53 Q222.973 1250.66 222.163 1252.58 Q221.376 1254.48 219.269 1257.07 Q218.691 1257.74 215.589 1260.96 Q212.487 1264.16 206.839 1269.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M216.029 1026.46 Q219.385 1027.18 221.26 1029.45 Q223.158 1031.72 223.158 1035.05 Q223.158 1040.17 219.64 1042.97 Q216.121 1045.77 209.64 1045.77 Q207.464 1045.77 205.149 1045.33 Q202.857 1044.91 200.404 1044.05 L200.404 1039.54 Q202.348 1040.67 204.663 1041.25 Q206.978 1041.83 209.501 1041.83 Q213.899 1041.83 216.191 1040.1 Q218.506 1038.36 218.506 1035.05 Q218.506 1031.99 216.353 1030.28 Q214.223 1028.55 210.404 1028.55 L206.376 1028.55 L206.376 1024.7 L210.589 1024.7 Q214.038 1024.7 215.867 1023.34 Q217.695 1021.95 217.695 1019.36 Q217.695 1016.69 215.797 1015.28 Q213.922 1013.85 210.404 1013.85 Q208.482 1013.85 206.283 1014.26 Q204.084 1014.68 201.445 1015.56 L201.445 1011.39 Q204.107 1010.65 206.422 1010.28 Q208.76 1009.91 210.82 1009.91 Q216.144 1009.91 219.246 1012.34 Q222.348 1014.75 222.348 1018.87 Q222.348 1021.74 220.705 1023.73 Q219.061 1025.7 216.029 1026.46 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M109.046 1354.07 L126.392 1366.96 L144.694 1353.4 L144.694 1360.3 L130.689 1370.68 L144.694 1381.06 L144.694 1387.96 L126.042 1374.12 L109.046 1386.79 L109.046 1379.88 L121.745 1370.43 L109.046 1360.97 L109.046 1354.07 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip813)" d="M330.76 1469.33 L314.76 1485.33 L330.76 1501.33 L346.76 1485.33 L330.76 1469.33 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M555.031 1524.27 L539.031 1540.27 L555.031 1556.27 L571.031 1540.27 L555.031 1524.27 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M779.303 1611.47 L763.303 1627.47 L779.303 1643.47 L795.303 1627.47 L779.303 1611.47 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1003.57 1654.89 L987.574 1670.89 L1003.57 1686.89 L1019.57 1670.89 L1003.57 1654.89 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1227.85 1676.54 L1211.85 1692.54 L1227.85 1708.54 L1243.85 1692.54 L1227.85 1676.54 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1452.12 1687.34 L1436.12 1703.34 L1452.12 1719.34 L1468.12 1703.34 L1452.12 1687.34 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1676.39 1692.72 L1660.39 1708.72 L1676.39 1724.72 L1692.39 1708.72 L1676.39 1692.72 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1900.66 1695.39 L1884.66 1711.39 L1900.66 1727.39 L1916.66 1711.39 L1900.66 1695.39 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M2124.93 1696.71 L2108.93 1712.71 L2124.93 1728.71 L2140.93 1712.71 L2124.93 1696.71 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M2349.2 1697.32 L2333.2 1713.32 L2349.2 1729.32 L2365.2 1713.32 L2349.2 1697.32 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M2573.47 1697.55 L2557.47 1713.55 L2573.47 1729.55 L2589.47 1713.55 L2573.47 1697.55 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip813)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="330.76,1485.33 555.031,1485.33 555.031,1540.27 779.303,1540.27 779.303,1627.47 1003.57,1627.47 1003.57,1670.89 1227.85,1670.89 1227.85,1692.54 1452.12,1692.54 1452.12,1703.34 1676.39,1703.34 1676.39,1708.72 1900.66,1708.72 1900.66,1711.39 2124.93,1711.39 2124.93,1712.71 2349.2,1712.71 2349.2,1713.32 2573.47,1713.32 2573.47,1713.55 "></polyline>
<path clip-path="url(#clip813)" d="M330.76 1011.82 L314.76 1027.82 L330.76 1043.82 L346.76 1027.82 L330.76 1011.82 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M555.031 1391.82 L539.031 1407.82 L555.031 1423.82 L571.031 1407.82 L555.031 1391.82 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M779.303 1545.3 L763.303 1561.3 L779.303 1577.3 L795.303 1561.3 L779.303 1545.3 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1003.57 1621.89 L987.574 1637.89 L1003.57 1653.89 L1019.57 1637.89 L1003.57 1621.89 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1227.85 1660.09 L1211.85 1676.09 L1227.85 1692.09 L1243.85 1676.09 L1227.85 1660.09 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1452.12 1679.14 L1436.12 1695.14 L1452.12 1711.14 L1468.12 1695.14 L1452.12 1679.14 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1676.39 1688.64 L1660.39 1704.64 L1676.39 1720.64 L1692.39 1704.64 L1676.39 1688.64 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M1900.66 1693.37 L1884.66 1709.37 L1900.66 1725.37 L1916.66 1709.37 L1900.66 1693.37 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M2124.93 1695.72 L2108.93 1711.72 L2124.93 1727.72 L2140.93 1711.72 L2124.93 1695.72 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M2349.2 1696.89 L2333.2 1712.89 L2349.2 1728.89 L2365.2 1712.89 L2349.2 1696.89 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip813)" d="M2573.47 1697.44 L2557.47 1713.44 L2573.47 1729.44 L2589.47 1713.44 L2573.47 1697.44 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip813)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="330.76,1027.82 555.031,1027.82 555.031,1407.82 779.303,1407.82 779.303,1561.3 1003.57,1561.3 1003.57,1637.89 1227.85,1637.89 1227.85,1676.09 1452.12,1676.09 1452.12,1695.14 1676.39,1695.14 1676.39,1704.64 1900.66,1704.64 1900.66,1709.37 2124.93,1709.37 2124.93,1711.72 2349.2,1711.72 2349.2,1712.89 2573.47,1712.89 2573.47,1713.44 "></polyline>
<path clip-path="url(#clip810)" d="M2280.68 1186.99 L2561.51 1186.99 L2561.51 1031.47 L2280.68 1031.47  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip810)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2280.68,1186.99 2561.51,1186.99 2561.51,1031.47 2280.68,1031.47 2280.68,1186.99 "></polyline>
<polyline clip-path="url(#clip810)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2307.1,1083.31 2465.58,1083.31 "></polyline>
<path clip-path="url(#clip810)" d="M2516.65 1074.67 L2507.28 1087.28 L2517.14 1100.59 L2512.11 1100.59 L2504.57 1090.41 L2497.02 1100.59 L2492 1100.59 L2502.07 1087.03 L2492.85 1074.67 L2497.88 1074.67 L2504.75 1083.9 L2511.63 1074.67 L2516.65 1074.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2522.3 1098.05 L2527.02 1098.05 L2527.02 1083.9 L2521.86 1084.85 L2521.86 1082.17 L2527.18 1081.26 L2530.35 1081.26 L2530.35 1098.05 L2535.1 1098.05 L2535.1 1100.59 L2522.3 1100.59 L2522.3 1098.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip810)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2307.1,1135.15 2465.58,1135.15 "></polyline>
<path clip-path="url(#clip810)" d="M2516.65 1126.51 L2507.28 1139.12 L2517.14 1152.43 L2512.11 1152.43 L2504.57 1142.25 L2497.02 1152.43 L2492 1152.43 L2502.07 1138.87 L2492.85 1126.51 L2497.88 1126.51 L2504.75 1135.74 L2511.63 1126.51 L2516.65 1126.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip810)" d="M2524.89 1149.79 L2534.71 1149.79 L2534.71 1152.43 L2520.86 1152.43 L2520.86 1149.89 Q2521.65 1149.17 2523.11 1147.87 Q2531.07 1140.81 2531.07 1138.64 Q2531.07 1137.11 2529.87 1136.18 Q2528.66 1135.23 2526.7 1135.23 Q2525.49 1135.23 2524.08 1135.65 Q2522.67 1136.04 2521 1136.85 L2521 1134.01 Q2522.78 1133.36 2524.31 1133.04 Q2525.86 1132.71 2527.18 1132.71 Q2530.54 1132.71 2532.55 1134.24 Q2534.57 1135.77 2534.57 1138.27 Q2534.57 1141.48 2526.9 1148.06 Q2525.61 1149.17 2524.89 1149.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
</div>
<section id="adding-the-constraints-on-controls" class="level3">
<h3 class="anchored" data-anchor-id="adding-the-constraints-on-controls">Adding the constraints on controls</h3>
<p>Adding constraints on <span class="math inline">\bar{\bm u}</span> is straightforward. It is just that instead of a linear system we will have a linear system with additional inequality constraints. Let’s get one <span class="math display">
\begin{aligned}
\operatorname*{minimize}_{\bar{\bm u}} &amp; \quad \frac{1}{2}\bar{\bm u}^T \mathbf H \bar{\bm u} + \mathbf x_0^T\mathbf F^T \bar{\bm u}\\
\text{subject to} &amp;\quad \bar{\bm u} \leq \bar{\mathbf u}^\mathrm{max}\\
               &amp;\quad \bar{\bm u} \geq \bar{\mathbf u}^\mathrm{min},
\end{aligned}
</span> which we can rewrite more explicitly (in the matrix-vector format) as <span class="math display">
\begin{aligned}
\operatorname*{minimize}_{\bar{\bm u}} &amp; \quad \frac{1}{2}\bar{\bm u}^T \mathbf H \bar{\bm u} + \mathbf x_0^T\mathbf F^T \bar{\bm u}\\
\text{subject to} &amp; \begin{bmatrix}
                  \mathbf{I}  &amp;    &amp;         &amp;    \\
                    &amp; \mathbf{I}  &amp;         &amp;    \\
                    &amp;    &amp; \ddots  &amp;    \\
                    &amp;    &amp;         &amp;  \mathbf{I} \\
                    -\mathbf{I}   &amp;   &amp;     &amp;    \\
                    &amp; -\mathbf{I} &amp;         &amp;    \\
                    &amp;    &amp; \ddots  &amp;    \\
                    &amp;    &amp;         &amp;  -\mathbf{I}
                 \end{bmatrix}
                 \begin{bmatrix}
                  \bm u_0 \\ \bm u_1 \\ \vdots \\ \bm u_{N-1}
                 \end{bmatrix}
                 \leq
                 \begin{bmatrix}
                  \mathbf u^\mathbf{max} \\ \mathbf u^\mathrm{max} \\ \vdots \\ \mathbf u^\mathrm{max}\\ -\mathbf u^\mathrm{min} \\ -\mathbf u^\mathrm{min} \\ \vdots \\ -\mathbf u^\mathrm{min}
                 \end{bmatrix}.
\end{aligned}
</span></p>
<div id="exm-direct-sequential-constrained-u" class="theorem example">
<p><span class="theorem-title"><strong>Example 3 (Reformulating the LQR problem with constraints on control as a quadratic program – sequential approach)</strong></span> &nbsp;</p>
<div id="6" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LinearAlgebra</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">BlockArrays</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">SparseArrays</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">JuMP</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">OSQP</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">direct_dlqr_sequential</span>(A,B,x₀,Q,R,S,N,(umin,umax))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="fu">size</span>(A)[<span class="fl">1</span>]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="fu">size</span>(B)[<span class="fl">2</span>]</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    Q̄ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,N<span class="op">*</span>n),<span class="fu">repeat</span>([n],N),<span class="fu">repeat</span>([n],N))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        Q̄[<span class="fu">Block</span>(i,i)] <span class="op">=</span> Q</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    Q̄[<span class="fu">Block</span>(N,N)] <span class="op">=</span> S</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    R̄ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>m,N<span class="op">*</span>m),<span class="fu">repeat</span>([m],N),<span class="fu">repeat</span>([m],N))</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        R̄[<span class="fu">Block</span>(i,i)] <span class="op">=</span> R</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    Ĉ <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,N<span class="op">*</span>m),<span class="fu">repeat</span>([n],N),<span class="fu">repeat</span>([m],N))</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    Â <span class="op">=</span> <span class="fu">BlockArray</span>(<span class="fu">spzeros</span>(N<span class="op">*</span>n,n),<span class="fu">repeat</span>([n],N),[n])</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i<span class="op">=</span><span class="fl">1</span><span class="op">:</span>N</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="op">=</span> <span class="fl">1</span><span class="op">:</span>i</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>            Ĉ[<span class="fu">Block</span>(i,j)] <span class="op">=</span> A<span class="op">^</span>(i<span class="op">-</span>j)<span class="op">*</span>B</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>            Â[<span class="fu">Block</span>(i,<span class="fl">1</span>)] <span class="op">=</span> A<span class="op">^</span>i</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> Ĉ<span class="ch">'*Q̄*Ĉ + R̄</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> <span class="fu">Array</span>(H)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> Ĉ<span class="ch">'*Q̄*Â</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> <span class="fu">Array</span>(F)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    prob <span class="op">=</span> <span class="fu">Model</span>()</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@variable</span>(prob, u[<span class="fl">1</span><span class="op">:</span>N<span class="op">*</span>m])</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@objective</span>(prob, Min, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="fu">*dot</span>(u,H,u) <span class="op">+</span> <span class="fu">dot</span>(F<span class="op">*</span>x₀,u))</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@constraint</span>(prob, u <span class="op">.&gt;=</span> umin)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@constraint</span>(prob, u <span class="op">.&lt;=</span> umax)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_silent</span>(prob)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_optimizer</span>(prob, OSQP.Optimizer)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">optimize!</span>(prob)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    uopt <span class="op">=</span> <span class="fu">value</span>.(u)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    xopt <span class="op">=</span> Ĉ<span class="op">*</span>uopt <span class="op">+</span> Â<span class="op">*</span>x₀</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    xopt <span class="op">=</span> <span class="fu">reshape</span>(xopt,(<span class="fl">2</span>,<span class="op">:</span>))</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="co">#=     u = Variable(N*m)</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="co">    problem = minimize(1/2*quadform(u,H) + dot(F*x₀,u))</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="co">    problem.constraints = [u &gt;= umin, u &lt;= umax]</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="co">    Convex.solve!(problem, SCS.Optimizer; silent = true)</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="co">    xopt = Ĉ*u.value + Â*x₀</span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a><span class="co">    xopt = reshape(xopt,(2,:))</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a><span class="co">    uopt = u.value =#</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> xopt,uopt</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="fl">2</span>               <span class="co"># Number of state variables.</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">1</span>               <span class="co"># Number of (control) input variables. </span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> <span class="fu">rand</span>(n,n)       <span class="co"># State matrix.</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> <span class="fu">rand</span>(n,m)       <span class="co"># Input coupling matrix.</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>x₀ <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">3.0</span>]     <span class="co"># Initial state.</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">10</span>              <span class="co"># Time horizon.</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">2.0</span>]      </span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> [<span class="fl">1.0</span>, <span class="fl">2.0</span>]</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> [<span class="fl">1.0</span>]</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>s)     <span class="co"># Matrix defining the terminal state cost.</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>q)     <span class="co"># Matrix defining the running state dost.</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> <span class="fu">diagm</span>(<span class="fl">0</span><span class="op">=&gt;</span>r)     <span class="co"># Matrix defining the cost of control.</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>umin <span class="op">=</span> <span class="op">-</span><span class="fl">1.0</span></span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>umax <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>xopt,uopt <span class="op">=</span> <span class="fu">direct_dlqr_sequential</span>(A,B,x₀,Q,R,S,N,(umin,umax))</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> <span class="fu">plot</span>(<span class="fl">0</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>),uopt,marker<span class="op">=:</span>diamond,label<span class="op">=</span><span class="st">"u"</span>,linetype<span class="op">=:</span>steppost)</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel!</span>(<span class="st">"k"</span>)</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel!</span>(<span class="st">"u"</span>)</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> <span class="fu">plot</span>(<span class="fl">0</span><span class="op">:</span>N,<span class="fu">hcat</span>(x₀,xopt)<span class="ch">',marker=:diamond,label=["x₁" "x₂"],linetype=:steppost)</span></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a><span class="fu">xlabel!</span>(<span class="st">"k"</span>)</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a><span class="fu">ylabel!</span>(<span class="st">"x"</span>)</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p1,p2,layout<span class="op">=</span>(<span class="fl">2</span>,<span class="fl">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip870">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip870)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip871">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip870)" d="M293.64 774.117 L2640.76 774.117 L2640.76 47.2441 L293.64 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip872">
    <rect x="293" y="47" width="2348" height="728"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="360.068,774.117 360.068,47.2441 "></polyline>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="852.126,774.117 852.126,47.2441 "></polyline>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1344.18,774.117 1344.18,47.2441 "></polyline>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1836.24,774.117 1836.24,47.2441 "></polyline>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2328.3,774.117 2328.3,47.2441 "></polyline>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,753.221 2640.76,753.221 "></polyline>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,580.4 2640.76,580.4 "></polyline>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,407.578 2640.76,407.578 "></polyline>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,234.757 2640.76,234.757 "></polyline>
<polyline clip-path="url(#clip872)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,61.9354 2640.76,61.9354 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,774.117 2640.76,774.117 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="360.068,774.117 360.068,755.219 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="852.126,774.117 852.126,755.219 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1344.18,774.117 1344.18,755.219 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1836.24,774.117 1836.24,755.219 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2328.3,774.117 2328.3,755.219 "></polyline>
<path clip-path="url(#clip870)" d="M360.068 807.34 Q356.457 807.34 354.628 810.904 Q352.823 814.446 352.823 821.576 Q352.823 828.682 354.628 832.247 Q356.457 835.789 360.068 835.789 Q363.702 835.789 365.508 832.247 Q367.336 828.682 367.336 821.576 Q367.336 814.446 365.508 810.904 Q363.702 807.34 360.068 807.34 M360.068 803.636 Q365.878 803.636 368.934 808.242 Q372.012 812.826 372.012 821.576 Q372.012 830.303 368.934 834.909 Q365.878 839.492 360.068 839.492 Q354.258 839.492 351.179 834.909 Q348.124 830.303 348.124 821.576 Q348.124 812.826 351.179 808.242 Q354.258 803.636 360.068 803.636 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M846.779 834.886 L863.098 834.886 L863.098 838.821 L841.154 838.821 L841.154 834.886 Q843.816 832.131 848.399 827.502 Q853.005 822.849 854.186 821.506 Q856.431 818.983 857.311 817.247 Q858.214 815.488 858.214 813.798 Q858.214 811.043 856.269 809.307 Q854.348 807.571 851.246 807.571 Q849.047 807.571 846.593 808.335 Q844.163 809.099 841.385 810.65 L841.385 805.928 Q844.209 804.793 846.663 804.215 Q849.117 803.636 851.154 803.636 Q856.524 803.636 859.718 806.321 Q862.913 809.006 862.913 813.497 Q862.913 815.627 862.103 817.548 Q861.316 819.446 859.209 822.039 Q858.63 822.71 855.529 825.928 Q852.427 829.122 846.779 834.886 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M1347.19 808.335 L1335.39 826.784 L1347.19 826.784 L1347.19 808.335 M1345.97 804.261 L1351.85 804.261 L1351.85 826.784 L1356.78 826.784 L1356.78 830.673 L1351.85 830.673 L1351.85 838.821 L1347.19 838.821 L1347.19 830.673 L1331.59 830.673 L1331.59 826.159 L1345.97 804.261 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M1836.65 819.678 Q1833.5 819.678 1831.65 821.83 Q1829.82 823.983 1829.82 827.733 Q1829.82 831.46 1831.65 833.636 Q1833.5 835.789 1836.65 835.789 Q1839.79 835.789 1841.62 833.636 Q1843.48 831.46 1843.48 827.733 Q1843.48 823.983 1841.62 821.83 Q1839.79 819.678 1836.65 819.678 M1845.93 805.025 L1845.93 809.284 Q1844.17 808.451 1842.36 808.011 Q1840.58 807.571 1838.82 807.571 Q1834.19 807.571 1831.74 810.696 Q1829.31 813.821 1828.96 820.141 Q1830.33 818.127 1832.39 817.062 Q1834.45 815.974 1836.92 815.974 Q1842.13 815.974 1845.14 819.145 Q1848.17 822.293 1848.17 827.733 Q1848.17 833.057 1845.03 836.275 Q1841.88 839.492 1836.65 839.492 Q1830.65 839.492 1827.48 834.909 Q1824.31 830.303 1824.31 821.576 Q1824.31 813.381 1828.2 808.52 Q1832.09 803.636 1838.64 803.636 Q1840.4 803.636 1842.18 803.983 Q1843.98 804.33 1845.93 805.025 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M2328.3 822.409 Q2324.97 822.409 2323.04 824.191 Q2321.15 825.974 2321.15 829.099 Q2321.15 832.224 2323.04 834.006 Q2324.97 835.789 2328.3 835.789 Q2331.63 835.789 2333.55 834.006 Q2335.48 832.201 2335.48 829.099 Q2335.48 825.974 2333.55 824.191 Q2331.66 822.409 2328.3 822.409 M2323.62 820.418 Q2320.61 819.678 2318.92 817.617 Q2317.26 815.557 2317.26 812.594 Q2317.26 808.451 2320.2 806.043 Q2323.16 803.636 2328.3 803.636 Q2333.46 803.636 2336.4 806.043 Q2339.34 808.451 2339.34 812.594 Q2339.34 815.557 2337.65 817.617 Q2335.98 819.678 2333 820.418 Q2336.38 821.205 2338.25 823.497 Q2340.15 825.789 2340.15 829.099 Q2340.15 834.122 2337.07 836.807 Q2334.02 839.492 2328.3 839.492 Q2322.58 839.492 2319.5 836.807 Q2316.45 834.122 2316.45 829.099 Q2316.45 825.789 2318.35 823.497 Q2320.24 821.205 2323.62 820.418 M2321.91 813.034 Q2321.91 815.719 2323.58 817.224 Q2325.27 818.729 2328.3 818.729 Q2331.31 818.729 2333 817.224 Q2334.71 815.719 2334.71 813.034 Q2334.71 810.349 2333 808.844 Q2331.31 807.34 2328.3 807.34 Q2325.27 807.34 2323.58 808.844 Q2321.91 810.349 2321.91 813.034 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M1451.38 873.776 L1457.27 873.776 L1457.27 903.026 L1474.74 887.653 L1482.22 887.653 L1463.31 904.331 L1483.02 923.301 L1475.38 923.301 L1457.27 905.891 L1457.27 923.301 L1451.38 923.301 L1451.38 873.776 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,774.117 293.64,47.2441 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,753.221 312.538,753.221 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,580.4 312.538,580.4 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,407.578 312.538,407.578 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,234.757 312.538,234.757 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,61.9354 312.538,61.9354 "></polyline>
<path clip-path="url(#clip870)" d="M116.214 753.673 L145.89 753.673 L145.89 757.608 L116.214 757.608 L116.214 753.673 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M156.793 766.566 L164.432 766.566 L164.432 740.201 L156.122 741.867 L156.122 737.608 L164.385 735.941 L169.061 735.941 L169.061 766.566 L176.7 766.566 L176.7 770.501 L156.793 770.501 L156.793 766.566 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M186.145 764.622 L191.029 764.622 L191.029 770.501 L186.145 770.501 L186.145 764.622 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M211.214 739.02 Q207.603 739.02 205.774 742.585 Q203.969 746.127 203.969 753.256 Q203.969 760.363 205.774 763.927 Q207.603 767.469 211.214 767.469 Q214.848 767.469 216.654 763.927 Q218.482 760.363 218.482 753.256 Q218.482 746.127 216.654 742.585 Q214.848 739.02 211.214 739.02 M211.214 735.316 Q217.024 735.316 220.08 739.923 Q223.158 744.506 223.158 753.256 Q223.158 761.983 220.08 766.589 Q217.024 771.173 211.214 771.173 Q205.404 771.173 202.325 766.589 Q199.27 761.983 199.27 753.256 Q199.27 744.506 202.325 739.923 Q205.404 735.316 211.214 735.316 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M241.376 739.02 Q237.765 739.02 235.936 742.585 Q234.13 746.127 234.13 753.256 Q234.13 760.363 235.936 763.927 Q237.765 767.469 241.376 767.469 Q245.01 767.469 246.816 763.927 Q248.644 760.363 248.644 753.256 Q248.644 746.127 246.816 742.585 Q245.01 739.02 241.376 739.02 M241.376 735.316 Q247.186 735.316 250.242 739.923 Q253.32 744.506 253.32 753.256 Q253.32 761.983 250.242 766.589 Q247.186 771.173 241.376 771.173 Q235.566 771.173 232.487 766.589 Q229.431 761.983 229.431 753.256 Q229.431 744.506 232.487 739.923 Q235.566 735.316 241.376 735.316 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M117.21 580.851 L146.886 580.851 L146.886 584.786 L117.21 584.786 L117.21 580.851 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M166.978 566.199 Q163.367 566.199 161.538 569.763 Q159.733 573.305 159.733 580.435 Q159.733 587.541 161.538 591.106 Q163.367 594.648 166.978 594.648 Q170.612 594.648 172.418 591.106 Q174.247 587.541 174.247 580.435 Q174.247 573.305 172.418 569.763 Q170.612 566.199 166.978 566.199 M166.978 562.495 Q172.788 562.495 175.844 567.101 Q178.922 571.685 178.922 580.435 Q178.922 589.161 175.844 593.768 Q172.788 598.351 166.978 598.351 Q161.168 598.351 158.089 593.768 Q155.034 589.161 155.034 580.435 Q155.034 571.685 158.089 567.101 Q161.168 562.495 166.978 562.495 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M187.14 591.8 L192.024 591.8 L192.024 597.68 L187.14 597.68 L187.14 591.8 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M201.029 563.12 L223.251 563.12 L223.251 565.111 L210.705 597.68 L205.82 597.68 L217.626 567.055 L201.029 567.055 L201.029 563.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M232.418 563.12 L250.774 563.12 L250.774 567.055 L236.7 567.055 L236.7 575.527 Q237.718 575.18 238.737 575.018 Q239.755 574.833 240.774 574.833 Q246.561 574.833 249.941 578.004 Q253.32 581.175 253.32 586.592 Q253.32 592.171 249.848 595.273 Q246.376 598.351 240.056 598.351 Q237.88 598.351 235.612 597.981 Q233.367 597.61 230.959 596.87 L230.959 592.171 Q233.043 593.305 235.265 593.861 Q237.487 594.416 239.964 594.416 Q243.968 594.416 246.306 592.31 Q248.644 590.203 248.644 586.592 Q248.644 582.981 246.306 580.874 Q243.968 578.768 239.964 578.768 Q238.089 578.768 236.214 579.185 Q234.362 579.601 232.418 580.481 L232.418 563.12 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M116.214 408.03 L145.89 408.03 L145.89 411.965 L116.214 411.965 L116.214 408.03 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M165.983 393.377 Q162.372 393.377 160.543 396.942 Q158.737 400.484 158.737 407.613 Q158.737 414.72 160.543 418.284 Q162.372 421.826 165.983 421.826 Q169.617 421.826 171.422 418.284 Q173.251 414.72 173.251 407.613 Q173.251 400.484 171.422 396.942 Q169.617 393.377 165.983 393.377 M165.983 389.673 Q171.793 389.673 174.848 394.28 Q177.927 398.863 177.927 407.613 Q177.927 416.34 174.848 420.946 Q171.793 425.53 165.983 425.53 Q160.173 425.53 157.094 420.946 Q154.038 416.34 154.038 407.613 Q154.038 398.863 157.094 394.28 Q160.173 389.673 165.983 389.673 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M186.145 418.979 L191.029 418.979 L191.029 424.858 L186.145 424.858 L186.145 418.979 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M201.26 390.298 L219.617 390.298 L219.617 394.234 L205.543 394.234 L205.543 402.706 Q206.561 402.359 207.58 402.197 Q208.598 402.011 209.617 402.011 Q215.404 402.011 218.783 405.183 Q222.163 408.354 222.163 413.771 Q222.163 419.349 218.691 422.451 Q215.219 425.53 208.899 425.53 Q206.723 425.53 204.455 425.159 Q202.209 424.789 199.802 424.048 L199.802 419.349 Q201.885 420.483 204.107 421.039 Q206.33 421.595 208.807 421.595 Q212.811 421.595 215.149 419.488 Q217.487 417.382 217.487 413.771 Q217.487 410.159 215.149 408.053 Q212.811 405.946 208.807 405.946 Q206.932 405.946 205.057 406.363 Q203.205 406.78 201.26 407.659 L201.26 390.298 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M241.376 393.377 Q237.765 393.377 235.936 396.942 Q234.13 400.484 234.13 407.613 Q234.13 414.72 235.936 418.284 Q237.765 421.826 241.376 421.826 Q245.01 421.826 246.816 418.284 Q248.644 414.72 248.644 407.613 Q248.644 400.484 246.816 396.942 Q245.01 393.377 241.376 393.377 M241.376 389.673 Q247.186 389.673 250.242 394.28 Q253.32 398.863 253.32 407.613 Q253.32 416.34 250.242 420.946 Q247.186 425.53 241.376 425.53 Q235.566 425.53 232.487 420.946 Q229.431 416.34 229.431 407.613 Q229.431 398.863 232.487 394.28 Q235.566 389.673 241.376 389.673 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M117.21 235.208 L146.886 235.208 L146.886 239.143 L117.21 239.143 L117.21 235.208 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M166.978 220.556 Q163.367 220.556 161.538 224.12 Q159.733 227.662 159.733 234.792 Q159.733 241.898 161.538 245.463 Q163.367 249.005 166.978 249.005 Q170.612 249.005 172.418 245.463 Q174.247 241.898 174.247 234.792 Q174.247 227.662 172.418 224.12 Q170.612 220.556 166.978 220.556 M166.978 216.852 Q172.788 216.852 175.844 221.458 Q178.922 226.042 178.922 234.792 Q178.922 243.518 175.844 248.125 Q172.788 252.708 166.978 252.708 Q161.168 252.708 158.089 248.125 Q155.034 243.518 155.034 234.792 Q155.034 226.042 158.089 221.458 Q161.168 216.852 166.978 216.852 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M187.14 246.157 L192.024 246.157 L192.024 252.037 L187.14 252.037 L187.14 246.157 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M206.237 248.102 L222.556 248.102 L222.556 252.037 L200.612 252.037 L200.612 248.102 Q203.274 245.347 207.857 240.718 Q212.464 236.065 213.644 234.722 Q215.89 232.199 216.769 230.463 Q217.672 228.704 217.672 227.014 Q217.672 224.259 215.728 222.523 Q213.807 220.787 210.705 220.787 Q208.506 220.787 206.052 221.551 Q203.621 222.315 200.844 223.866 L200.844 219.144 Q203.668 218.009 206.121 217.431 Q208.575 216.852 210.612 216.852 Q215.982 216.852 219.177 219.537 Q222.371 222.222 222.371 226.713 Q222.371 228.843 221.561 230.764 Q220.774 232.662 218.668 235.255 Q218.089 235.926 214.987 239.143 Q211.885 242.338 206.237 248.102 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M232.418 217.477 L250.774 217.477 L250.774 221.412 L236.7 221.412 L236.7 229.884 Q237.718 229.537 238.737 229.375 Q239.755 229.19 240.774 229.19 Q246.561 229.19 249.941 232.361 Q253.32 235.532 253.32 240.949 Q253.32 246.528 249.848 249.63 Q246.376 252.708 240.056 252.708 Q237.88 252.708 235.612 252.338 Q233.367 251.967 230.959 251.227 L230.959 246.528 Q233.043 247.662 235.265 248.218 Q237.487 248.773 239.964 248.773 Q243.968 248.773 246.306 246.667 Q248.644 244.56 248.644 240.949 Q248.644 237.338 246.306 235.231 Q243.968 233.125 239.964 233.125 Q238.089 233.125 236.214 233.542 Q234.362 233.958 232.418 234.838 L232.418 217.477 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M165.983 47.7341 Q162.372 47.7341 160.543 51.2989 Q158.737 54.8406 158.737 61.9702 Q158.737 69.0766 160.543 72.6414 Q162.372 76.1831 165.983 76.1831 Q169.617 76.1831 171.422 72.6414 Q173.251 69.0766 173.251 61.9702 Q173.251 54.8406 171.422 51.2989 Q169.617 47.7341 165.983 47.7341 M165.983 44.0304 Q171.793 44.0304 174.848 48.6369 Q177.927 53.2202 177.927 61.9702 Q177.927 70.697 174.848 75.3034 Q171.793 79.8867 165.983 79.8867 Q160.173 79.8867 157.094 75.3034 Q154.038 70.697 154.038 61.9702 Q154.038 53.2202 157.094 48.6369 Q160.173 44.0304 165.983 44.0304 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M186.145 73.3358 L191.029 73.3358 L191.029 79.2154 L186.145 79.2154 L186.145 73.3358 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M211.214 47.7341 Q207.603 47.7341 205.774 51.2989 Q203.969 54.8406 203.969 61.9702 Q203.969 69.0766 205.774 72.6414 Q207.603 76.1831 211.214 76.1831 Q214.848 76.1831 216.654 72.6414 Q218.482 69.0766 218.482 61.9702 Q218.482 54.8406 216.654 51.2989 Q214.848 47.7341 211.214 47.7341 M211.214 44.0304 Q217.024 44.0304 220.08 48.6369 Q223.158 53.2202 223.158 61.9702 Q223.158 70.697 220.08 75.3034 Q217.024 79.8867 211.214 79.8867 Q205.404 79.8867 202.325 75.3034 Q199.27 70.697 199.27 61.9702 Q199.27 53.2202 202.325 48.6369 Q205.404 44.0304 211.214 44.0304 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M241.376 47.7341 Q237.765 47.7341 235.936 51.2989 Q234.13 54.8406 234.13 61.9702 Q234.13 69.0766 235.936 72.6414 Q237.765 76.1831 241.376 76.1831 Q245.01 76.1831 246.816 72.6414 Q248.644 69.0766 248.644 61.9702 Q248.644 54.8406 246.816 51.2989 Q245.01 47.7341 241.376 47.7341 M241.376 44.0304 Q247.186 44.0304 250.242 48.6369 Q253.32 53.2202 253.32 61.9702 Q253.32 70.697 250.242 75.3034 Q247.186 79.8867 241.376 79.8867 Q235.566 79.8867 232.487 75.3034 Q229.431 70.697 229.431 61.9702 Q229.431 53.2202 232.487 48.6369 Q235.566 44.0304 241.376 44.0304 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M47.5702 425.608 L25.9905 425.608 L25.9905 419.752 L47.3474 419.752 Q52.4082 419.752 54.9545 417.778 Q57.4689 415.805 57.4689 411.858 Q57.4689 407.116 54.4452 404.378 Q51.4215 401.609 46.2016 401.609 L25.9905 401.609 L25.9905 395.753 L61.6384 395.753 L61.6384 401.609 L56.1639 401.609 Q59.4104 403.742 61.0019 406.575 Q62.5615 409.376 62.5615 413.1 Q62.5615 419.242 58.742 422.425 Q54.9226 425.608 47.5702 425.608 M25.1311 410.872 L25.1311 410.872 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip872)" d="M360.068 736.874 L344.068 752.874 L360.068 768.874 L376.068 752.874 L360.068 736.874 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip872)" d="M606.097 737.545 L590.097 753.545 L606.097 769.545 L622.097 753.545 L606.097 737.545 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip872)" d="M852.126 661.587 L836.126 677.587 L852.126 693.587 L868.126 677.587 L852.126 661.587 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip872)" d="M1098.15 376.946 L1082.15 392.946 L1098.15 408.946 L1114.15 392.946 L1098.15 376.946 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip872)" d="M1344.18 219.946 L1328.18 235.946 L1344.18 251.946 L1360.18 235.946 L1344.18 219.946 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip872)" d="M1590.21 135.674 L1574.21 151.674 L1590.21 167.674 L1606.21 151.674 L1590.21 135.674 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip872)" d="M1836.24 91.7603 L1820.24 107.76 L1836.24 123.76 L1852.24 107.76 L1836.24 91.7603 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip872)" d="M2082.27 69.364 L2066.27 85.364 L2082.27 101.364 L2098.27 85.364 L2082.27 69.364 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip872)" d="M2328.3 57.9426 L2312.3 73.9426 L2328.3 89.9426 L2344.3 73.9426 L2328.3 57.9426 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip872)" d="M2574.33 51.816 L2558.33 67.816 L2574.33 83.816 L2590.33 67.816 L2574.33 51.816 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip872)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="360.068,752.874 606.097,752.874 606.097,753.545 852.126,753.545 852.126,677.587 1098.15,677.587 1098.15,392.946 1344.18,392.946 1344.18,235.946 1590.21,235.946 1590.21,151.674 1836.24,151.674 1836.24,107.76 2082.27,107.76 2082.27,85.364 2328.3,85.364 2328.3,73.9426 2574.33,73.9426 2574.33,67.816 "></polyline>
<path clip-path="url(#clip870)" d="M371.877 175.153 L628.302 175.153 L628.302 71.4732 L371.877 71.4732  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="371.877,175.153 628.302,175.153 628.302,71.4732 371.877,71.4732 371.877,175.153 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="397.956,123.313 554.431,123.313 "></polyline>
<path clip-path="url(#clip870)" d="M580.51 130.362 L580.51 114.667 L584.769 114.667 L584.769 130.2 Q584.769 133.88 586.204 135.732 Q587.639 137.561 590.51 137.561 Q593.959 137.561 595.95 135.362 Q597.963 133.163 597.963 129.366 L597.963 114.667 L602.223 114.667 L602.223 140.593 L597.963 140.593 L597.963 136.612 Q596.413 138.973 594.352 140.13 Q592.315 141.264 589.607 141.264 Q585.139 141.264 582.825 138.487 Q580.51 135.709 580.51 130.362 M591.227 114.042 L591.227 114.042 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M293.64 1734.12 L2640.76 1734.12 L2640.76 1007.24 L293.64 1007.24  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip873">
    <rect x="293" y="1007" width="2348" height="728"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip873)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="360.068,1734.12 360.068,1007.24 "></polyline>
<polyline clip-path="url(#clip873)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="913.633,1734.12 913.633,1007.24 "></polyline>
<polyline clip-path="url(#clip873)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1467.2,1734.12 1467.2,1007.24 "></polyline>
<polyline clip-path="url(#clip873)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2020.76,1734.12 2020.76,1007.24 "></polyline>
<polyline clip-path="url(#clip873)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2574.33,1734.12 2574.33,1007.24 "></polyline>
<polyline clip-path="url(#clip873)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,1714.32 2640.76,1714.32 "></polyline>
<polyline clip-path="url(#clip873)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,1485.49 2640.76,1485.49 "></polyline>
<polyline clip-path="url(#clip873)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,1256.65 2640.76,1256.65 "></polyline>
<polyline clip-path="url(#clip873)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="293.64,1027.82 2640.76,1027.82 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,1734.12 2640.76,1734.12 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="360.068,1734.12 360.068,1715.22 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="913.633,1734.12 913.633,1715.22 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1467.2,1734.12 1467.2,1715.22 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2020.76,1734.12 2020.76,1715.22 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2574.33,1734.12 2574.33,1715.22 "></polyline>
<path clip-path="url(#clip870)" d="M337.452 1767.34 Q333.841 1767.34 332.013 1770.9 Q330.207 1774.45 330.207 1781.58 Q330.207 1788.68 332.013 1792.25 Q333.841 1795.79 337.452 1795.79 Q341.087 1795.79 342.892 1792.25 Q344.721 1788.68 344.721 1781.58 Q344.721 1774.45 342.892 1770.9 Q341.087 1767.34 337.452 1767.34 M337.452 1763.64 Q343.263 1763.64 346.318 1768.24 Q349.397 1772.83 349.397 1781.58 Q349.397 1790.3 346.318 1794.91 Q343.263 1799.49 337.452 1799.49 Q331.642 1799.49 328.564 1794.91 Q325.508 1790.3 325.508 1781.58 Q325.508 1772.83 328.564 1768.24 Q331.642 1763.64 337.452 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M357.614 1792.94 L362.499 1792.94 L362.499 1798.82 L357.614 1798.82 L357.614 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M382.684 1767.34 Q379.073 1767.34 377.244 1770.9 Q375.438 1774.45 375.438 1781.58 Q375.438 1788.68 377.244 1792.25 Q379.073 1795.79 382.684 1795.79 Q386.318 1795.79 388.123 1792.25 Q389.952 1788.68 389.952 1781.58 Q389.952 1774.45 388.123 1770.9 Q386.318 1767.34 382.684 1767.34 M382.684 1763.64 Q388.494 1763.64 391.549 1768.24 Q394.628 1772.83 394.628 1781.58 Q394.628 1790.3 391.549 1794.91 Q388.494 1799.49 382.684 1799.49 Q376.873 1799.49 373.795 1794.91 Q370.739 1790.3 370.739 1781.58 Q370.739 1772.83 373.795 1768.24 Q376.873 1763.64 382.684 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M885.369 1794.89 L901.689 1794.89 L901.689 1798.82 L879.744 1798.82 L879.744 1794.89 Q882.406 1792.13 886.99 1787.5 Q891.596 1782.85 892.777 1781.51 Q895.022 1778.98 895.902 1777.25 Q896.804 1775.49 896.804 1773.8 Q896.804 1771.04 894.86 1769.31 Q892.939 1767.57 889.837 1767.57 Q887.638 1767.57 885.184 1768.34 Q882.754 1769.1 879.976 1770.65 L879.976 1765.93 Q882.8 1764.79 885.254 1764.21 Q887.707 1763.64 889.744 1763.64 Q895.115 1763.64 898.309 1766.32 Q901.503 1769.01 901.503 1773.5 Q901.503 1775.63 900.693 1777.55 Q899.906 1779.45 897.8 1782.04 Q897.221 1782.71 894.119 1785.93 Q891.017 1789.12 885.369 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M911.503 1792.94 L916.388 1792.94 L916.388 1798.82 L911.503 1798.82 L911.503 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M926.619 1764.26 L944.975 1764.26 L944.975 1768.2 L930.901 1768.2 L930.901 1776.67 Q931.92 1776.32 932.938 1776.16 Q933.957 1775.97 934.975 1775.97 Q940.763 1775.97 944.142 1779.15 Q947.522 1782.32 947.522 1787.73 Q947.522 1793.31 944.05 1796.41 Q940.577 1799.49 934.258 1799.49 Q932.082 1799.49 929.813 1799.12 Q927.568 1798.75 925.161 1798.01 L925.161 1793.31 Q927.244 1794.45 929.466 1795 Q931.688 1795.56 934.165 1795.56 Q938.17 1795.56 940.508 1793.45 Q942.846 1791.34 942.846 1787.73 Q942.846 1784.12 940.508 1782.02 Q938.17 1779.91 934.165 1779.91 Q932.29 1779.91 930.415 1780.33 Q928.563 1780.74 926.619 1781.62 L926.619 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M1434.36 1764.26 L1452.72 1764.26 L1452.72 1768.2 L1438.64 1768.2 L1438.64 1776.67 Q1439.66 1776.32 1440.68 1776.16 Q1441.7 1775.97 1442.72 1775.97 Q1448.51 1775.97 1451.89 1779.15 Q1455.27 1782.32 1455.27 1787.73 Q1455.27 1793.31 1451.79 1796.41 Q1448.32 1799.49 1442 1799.49 Q1439.83 1799.49 1437.56 1799.12 Q1435.31 1798.75 1432.9 1798.01 L1432.9 1793.31 Q1434.99 1794.45 1437.21 1795 Q1439.43 1795.56 1441.91 1795.56 Q1445.91 1795.56 1448.25 1793.45 Q1450.59 1791.34 1450.59 1787.73 Q1450.59 1784.12 1448.25 1782.02 Q1445.91 1779.91 1441.91 1779.91 Q1440.03 1779.91 1438.16 1780.33 Q1436.31 1780.74 1434.36 1781.62 L1434.36 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M1464.48 1792.94 L1469.36 1792.94 L1469.36 1798.82 L1464.48 1798.82 L1464.48 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M1489.55 1767.34 Q1485.94 1767.34 1484.11 1770.9 Q1482.3 1774.45 1482.3 1781.58 Q1482.3 1788.68 1484.11 1792.25 Q1485.94 1795.79 1489.55 1795.79 Q1493.18 1795.79 1494.99 1792.25 Q1496.82 1788.68 1496.82 1781.58 Q1496.82 1774.45 1494.99 1770.9 Q1493.18 1767.34 1489.55 1767.34 M1489.55 1763.64 Q1495.36 1763.64 1498.41 1768.24 Q1501.49 1772.83 1501.49 1781.58 Q1501.49 1790.3 1498.41 1794.91 Q1495.36 1799.49 1489.55 1799.49 Q1483.74 1799.49 1480.66 1794.91 Q1477.6 1790.3 1477.6 1781.58 Q1477.6 1772.83 1480.66 1768.24 Q1483.74 1763.64 1489.55 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M1987.08 1764.26 L2009.3 1764.26 L2009.3 1766.25 L1996.76 1798.82 L1991.87 1798.82 L2003.68 1768.2 L1987.08 1768.2 L1987.08 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M2018.43 1792.94 L2023.31 1792.94 L2023.31 1798.82 L2018.43 1798.82 L2018.43 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M2033.54 1764.26 L2051.9 1764.26 L2051.9 1768.2 L2037.82 1768.2 L2037.82 1776.67 Q2038.84 1776.32 2039.86 1776.16 Q2040.88 1775.97 2041.9 1775.97 Q2047.68 1775.97 2051.06 1779.15 Q2054.44 1782.32 2054.44 1787.73 Q2054.44 1793.31 2050.97 1796.41 Q2047.5 1799.49 2041.18 1799.49 Q2039 1799.49 2036.74 1799.12 Q2034.49 1798.75 2032.08 1798.01 L2032.08 1793.31 Q2034.17 1794.45 2036.39 1795 Q2038.61 1795.56 2041.09 1795.56 Q2045.09 1795.56 2047.43 1793.45 Q2049.77 1791.34 2049.77 1787.73 Q2049.77 1784.12 2047.43 1782.02 Q2045.09 1779.91 2041.09 1779.91 Q2039.21 1779.91 2037.34 1780.33 Q2035.49 1780.74 2033.54 1781.62 L2033.54 1764.26 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M2526.4 1794.89 L2534.04 1794.89 L2534.04 1768.52 L2525.73 1770.19 L2525.73 1765.93 L2533.99 1764.26 L2538.67 1764.26 L2538.67 1794.89 L2546.31 1794.89 L2546.31 1798.82 L2526.4 1798.82 L2526.4 1794.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M2565.75 1767.34 Q2562.14 1767.34 2560.31 1770.9 Q2558.51 1774.45 2558.51 1781.58 Q2558.51 1788.68 2560.31 1792.25 Q2562.14 1795.79 2565.75 1795.79 Q2569.39 1795.79 2571.19 1792.25 Q2573.02 1788.68 2573.02 1781.58 Q2573.02 1774.45 2571.19 1770.9 Q2569.39 1767.34 2565.75 1767.34 M2565.75 1763.64 Q2571.56 1763.64 2574.62 1768.24 Q2577.7 1772.83 2577.7 1781.58 Q2577.7 1790.3 2574.62 1794.91 Q2571.56 1799.49 2565.75 1799.49 Q2559.94 1799.49 2556.86 1794.91 Q2553.81 1790.3 2553.81 1781.58 Q2553.81 1772.83 2556.86 1768.24 Q2559.94 1763.64 2565.75 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M2585.91 1792.94 L2590.8 1792.94 L2590.8 1798.82 L2585.91 1798.82 L2585.91 1792.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M2610.98 1767.34 Q2607.37 1767.34 2605.54 1770.9 Q2603.74 1774.45 2603.74 1781.58 Q2603.74 1788.68 2605.54 1792.25 Q2607.37 1795.79 2610.98 1795.79 Q2614.62 1795.79 2616.42 1792.25 Q2618.25 1788.68 2618.25 1781.58 Q2618.25 1774.45 2616.42 1770.9 Q2614.62 1767.34 2610.98 1767.34 M2610.98 1763.64 Q2616.79 1763.64 2619.85 1768.24 Q2622.93 1772.83 2622.93 1781.58 Q2622.93 1790.3 2619.85 1794.91 Q2616.79 1799.49 2610.98 1799.49 Q2605.17 1799.49 2602.09 1794.91 Q2599.04 1790.3 2599.04 1781.58 Q2599.04 1772.83 2602.09 1768.24 Q2605.17 1763.64 2610.98 1763.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M1451.38 1833.78 L1457.27 1833.78 L1457.27 1863.03 L1474.74 1847.65 L1482.22 1847.65 L1463.31 1864.33 L1483.02 1883.3 L1475.38 1883.3 L1457.27 1865.89 L1457.27 1883.3 L1451.38 1883.3 L1451.38 1833.78 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,1734.12 293.64,1007.24 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,1714.32 312.538,1714.32 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,1485.49 312.538,1485.49 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,1256.65 312.538,1256.65 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="293.64,1027.82 312.538,1027.82 "></polyline>
<path clip-path="url(#clip870)" d="M241.376 1700.12 Q237.765 1700.12 235.936 1703.68 Q234.13 1707.23 234.13 1714.36 Q234.13 1721.46 235.936 1725.03 Q237.765 1728.57 241.376 1728.57 Q245.01 1728.57 246.816 1725.03 Q248.644 1721.46 248.644 1714.36 Q248.644 1707.23 246.816 1703.68 Q245.01 1700.12 241.376 1700.12 M241.376 1696.42 Q247.186 1696.42 250.242 1701.02 Q253.32 1705.61 253.32 1714.36 Q253.32 1723.08 250.242 1727.69 Q247.186 1732.27 241.376 1732.27 Q235.566 1732.27 232.487 1727.69 Q229.431 1723.08 229.431 1714.36 Q229.431 1705.61 232.487 1701.02 Q235.566 1696.42 241.376 1696.42 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M233.413 1498.83 L241.052 1498.83 L241.052 1472.47 L232.742 1474.13 L232.742 1469.87 L241.005 1468.21 L245.681 1468.21 L245.681 1498.83 L253.32 1498.83 L253.32 1502.77 L233.413 1502.77 L233.413 1498.83 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M237.001 1270 L253.32 1270 L253.32 1273.93 L231.376 1273.93 L231.376 1270 Q234.038 1267.24 238.621 1262.61 Q243.228 1257.96 244.408 1256.62 Q246.654 1254.09 247.533 1252.36 Q248.436 1250.6 248.436 1248.91 Q248.436 1246.15 246.492 1244.42 Q244.57 1242.68 241.468 1242.68 Q239.269 1242.68 236.816 1243.44 Q234.385 1244.21 231.607 1245.76 L231.607 1241.04 Q234.431 1239.9 236.885 1239.32 Q239.339 1238.75 241.376 1238.75 Q246.746 1238.75 249.941 1241.43 Q253.135 1244.12 253.135 1248.61 Q253.135 1250.74 252.325 1252.66 Q251.538 1254.56 249.431 1257.15 Q248.853 1257.82 245.751 1261.04 Q242.649 1264.23 237.001 1270 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M246.191 1026.46 Q249.547 1027.18 251.422 1029.45 Q253.32 1031.72 253.32 1035.05 Q253.32 1040.17 249.802 1042.97 Q246.283 1045.77 239.802 1045.77 Q237.626 1045.77 235.311 1045.33 Q233.019 1044.91 230.566 1044.05 L230.566 1039.54 Q232.51 1040.67 234.825 1041.25 Q237.14 1041.83 239.663 1041.83 Q244.061 1041.83 246.353 1040.1 Q248.667 1038.36 248.667 1035.05 Q248.667 1031.99 246.515 1030.28 Q244.385 1028.55 240.566 1028.55 L236.538 1028.55 L236.538 1024.7 L240.751 1024.7 Q244.2 1024.7 246.029 1023.34 Q247.857 1021.95 247.857 1019.36 Q247.857 1016.69 245.959 1015.28 Q244.084 1013.85 240.566 1013.85 Q238.644 1013.85 236.445 1014.26 Q234.246 1014.68 231.607 1015.56 L231.607 1011.39 Q234.269 1010.65 236.584 1010.28 Q238.922 1009.91 240.982 1009.91 Q246.306 1009.91 249.408 1012.34 Q252.51 1014.75 252.51 1018.87 Q252.51 1021.74 250.866 1023.73 Q249.223 1025.7 246.191 1026.46 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M139.207 1354.07 L156.554 1366.96 L174.855 1353.4 L174.855 1360.3 L160.851 1370.68 L174.855 1381.06 L174.855 1387.96 L156.204 1374.12 L139.207 1386.79 L139.207 1379.88 L151.907 1370.43 L139.207 1360.97 L139.207 1354.07 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip873)" d="M360.068 1469.49 L344.068 1485.49 L360.068 1501.49 L376.068 1485.49 L360.068 1469.49 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M581.494 1425.43 L565.494 1441.43 L581.494 1457.43 L597.494 1441.43 L581.494 1425.43 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M802.92 1504.64 L786.92 1520.64 L802.92 1536.64 L818.92 1520.64 L802.92 1504.64 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M1024.35 1584.92 L1008.35 1600.92 L1024.35 1616.92 L1040.35 1600.92 L1024.35 1584.92 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M1245.77 1638.66 L1229.77 1654.66 L1245.77 1670.66 L1261.77 1654.66 L1245.77 1638.66 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M1467.2 1667.38 L1451.2 1683.38 L1467.2 1699.38 L1483.2 1683.38 L1467.2 1667.38 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M1688.62 1682.34 L1672.62 1698.34 L1688.62 1714.34 L1704.62 1698.34 L1688.62 1682.34 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M1910.05 1690 L1894.05 1706 L1910.05 1722 L1926.05 1706 L1910.05 1690 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M2131.48 1693.91 L2115.48 1709.91 L2131.48 1725.91 L2147.48 1709.91 L2131.48 1693.91 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M2352.9 1695.89 L2336.9 1711.89 L2352.9 1727.89 L2368.9 1711.89 L2352.9 1695.89 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M2574.33 1696.86 L2558.33 1712.86 L2574.33 1728.86 L2590.33 1712.86 L2574.33 1696.86 Z" fill="#6b9e32" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip873)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="360.068,1485.49 581.494,1485.49 581.494,1441.43 802.92,1441.43 802.92,1520.64 1024.35,1520.64 1024.35,1600.92 1245.77,1600.92 1245.77,1654.66 1467.2,1654.66 1467.2,1683.38 1688.62,1683.38 1688.62,1698.34 1910.05,1698.34 1910.05,1706 2131.48,1706 2131.48,1709.91 2352.9,1709.91 2352.9,1711.89 2574.33,1711.89 2574.33,1712.86 "></polyline>
<path clip-path="url(#clip873)" d="M360.068 1011.82 L344.068 1027.82 L360.068 1043.82 L376.068 1027.82 L360.068 1011.82 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M581.494 1469 L565.494 1485 L581.494 1501 L597.494 1485 L581.494 1469 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M802.92 1577.76 L786.92 1593.76 L802.92 1609.76 L818.92 1593.76 L802.92 1577.76 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M1024.35 1667.83 L1008.35 1683.83 L1024.35 1699.83 L1040.35 1683.83 L1024.35 1667.83 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M1245.77 1684.15 L1229.77 1700.15 L1245.77 1716.15 L1261.77 1700.15 L1245.77 1684.15 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M1467.2 1691.45 L1451.2 1707.45 L1467.2 1723.45 L1483.2 1707.45 L1467.2 1691.45 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M1688.62 1694.75 L1672.62 1710.75 L1688.62 1726.75 L1704.62 1710.75 L1688.62 1694.75 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M1910.05 1696.3 L1894.05 1712.3 L1910.05 1728.3 L1926.05 1712.3 L1910.05 1696.3 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M2131.48 1697.07 L2115.48 1713.07 L2131.48 1729.07 L2147.48 1713.07 L2131.48 1697.07 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M2352.9 1697.46 L2336.9 1713.46 L2352.9 1729.46 L2368.9 1713.46 L2352.9 1697.46 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<path clip-path="url(#clip873)" d="M2574.33 1697.55 L2558.33 1713.55 L2574.33 1729.55 L2590.33 1713.55 L2574.33 1697.55 Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.84"></path>
<polyline clip-path="url(#clip873)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="360.068,1027.82 581.494,1027.82 581.494,1485 802.92,1485 802.92,1593.76 1024.35,1593.76 1024.35,1683.83 1245.77,1683.83 1245.77,1700.15 1467.2,1700.15 1467.2,1707.45 1688.62,1707.45 1688.62,1710.75 1910.05,1710.75 1910.05,1712.3 2131.48,1712.3 2131.48,1713.07 2352.9,1713.07 2352.9,1713.46 2574.33,1713.46 2574.33,1713.55 "></polyline>
<path clip-path="url(#clip870)" d="M2284.71 1186.99 L2562.52 1186.99 L2562.52 1031.47 L2284.71 1031.47  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip870)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2284.71,1186.99 2562.52,1186.99 2562.52,1031.47 2284.71,1031.47 2284.71,1186.99 "></polyline>
<polyline clip-path="url(#clip870)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2310.78,1083.31 2467.26,1083.31 "></polyline>
<path clip-path="url(#clip870)" d="M2517.99 1074.67 L2508.62 1087.28 L2518.48 1100.59 L2513.45 1100.59 L2505.91 1090.41 L2498.36 1100.59 L2493.34 1100.59 L2503.41 1087.03 L2494.19 1074.67 L2499.22 1074.67 L2506.09 1083.9 L2512.97 1074.67 L2517.99 1074.67 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M2523.64 1098.05 L2528.36 1098.05 L2528.36 1083.9 L2523.2 1084.85 L2523.2 1082.17 L2528.52 1081.26 L2531.69 1081.26 L2531.69 1098.05 L2536.44 1098.05 L2536.44 1100.59 L2523.64 1100.59 L2523.64 1098.05 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip870)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2310.78,1135.15 2467.26,1135.15 "></polyline>
<path clip-path="url(#clip870)" d="M2517.99 1126.51 L2508.62 1139.12 L2518.48 1152.43 L2513.45 1152.43 L2505.91 1142.25 L2498.36 1152.43 L2493.34 1152.43 L2503.41 1138.87 L2494.19 1126.51 L2499.22 1126.51 L2506.09 1135.74 L2512.97 1126.51 L2517.99 1126.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip870)" d="M2526.23 1149.79 L2536.05 1149.79 L2536.05 1152.43 L2522.2 1152.43 L2522.2 1149.89 Q2522.99 1149.17 2524.45 1147.87 Q2532.41 1140.81 2532.41 1138.64 Q2532.41 1137.11 2531.21 1136.18 Q2530 1135.23 2528.04 1135.23 Q2526.83 1135.23 2525.42 1135.65 Q2524.01 1136.04 2522.34 1136.85 L2522.34 1134.01 Q2524.12 1133.36 2525.65 1133.04 Q2527.2 1132.71 2528.52 1132.71 Q2531.88 1132.71 2533.89 1134.24 Q2535.91 1135.77 2535.91 1138.27 Q2535.91 1141.48 2528.25 1148.06 Q2526.95 1149.17 2526.23 1149.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
</div>
</section>
<section id="adding-the-constraints-on-states" class="level3">
<h3 class="anchored" data-anchor-id="adding-the-constraints-on-states">Adding the constraints on states</h3>
<p>We might feel a little bit uneasy about loosing an immediate access to <span class="math inline">\bar{\bm x}</span>. But the game is not lost. We just need to express <span class="math inline">\bar{\bm x}</span> as a function of <span class="math inline">\bar{\bm u}</span> and <span class="math inline">\mathbf x_0</span> and impose the constraint on the result. But such expression is already available, see (<a href="#eq-x_as_function_of_u_and_x0" class="quarto-xref">Eq.&nbsp;2</a>). Therefore, we can formulate the constraint, say, an upper bound on the state vector <span class="math display">
\bm x_k \leq \mathbf x_\mathrm{max}
</span> as <span class="math display">
\bar{\mathbf x}^\mathrm{min} \leq \widehat{\mathbf C} \bar{\bm u} + \widehat{\mathbf A} \mathbf x_0 \leq \bar{\mathbf x}^\mathrm{max},
</span> where the the bars in <span class="math inline">\bar{\mathbf x}^\mathrm{min}</span> and <span class="math inline">\bar{\mathbf x}^\mathrm{max}</span> obviously indicates that these vectors were obtained by stacking the corresponding vectors for all times <span class="math inline">k=1,\ldots,N</span>.</p>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/hurak\.github\.io\/orr\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./discr_dir_general.html" class="pagination-link" aria-label="General finite-horizon nonlinear optimal control as an NLP">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">General finite-horizon nonlinear optimal control as an NLP</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./discr_dir_mpc.html" class="pagination-link" aria-label="Model predictive control (MPC)">
        <span class="nav-page-text">Model predictive control (MPC)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2025, Zdeněk Hurák</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/hurak/orr/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>